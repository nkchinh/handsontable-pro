/*!
 * Copyright (c) Handsoncode sp. z o.o.
 * 
 * This Handsontable Pro is a commercial software distributed by Handsoncode sp. z o. o., a limited liability
 * company registered under the laws of Poland, with its registered office in Gdynia, Poland, at 96/98 Aleja ZwycieÌ¨stwa,
 * postal code 81-451, entered into the Entrepreneurs Register of the National Court Register under number 0000538651,
 * share capital: PLN 62,800.00., hereinafter referred to as "HANDSONCODE".
 * 
 * By installing, copying, or otherwise using this software, you agree to be bound by the terms
 * of its General Software License Terms ("Terms") outlined in a file "handsontable-pro-general-terms.pdf"
 * available in the main directory of the software repository.
 * This software is copyrighted and protected by copyright laws and international treaties.
 * 
 * You shall obtain a commercial license for this software at handsontable.com.
 * 
 * YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
 * IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
 * EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
 * RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
 * UNINTERRUPTED OR ERROR FREE.
 * 
 * Version: undefined
 * Release date: undefined (built at undefined)
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):"function"==typeof define&&define.amd?define("Handsontable",["moment","pikaday","numbro","hot-formula-parser"],e):"object"==typeof exports?exports.Handsontable=e(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):t.Handsontable=e(t.moment,t.Pikaday,t.numbro,t.formulaParser)}("undefined"!=typeof self?self:this,function(t,e,n,o){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=243)}([function(t,e,n){"use strict";function o(t){for(var e=0,n=t.length;e<n;)t[e]=[t[e]],e++}function r(t,e){for(var n=0,o=e.length;n<o;)t.push(e[n]),n++}function i(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,o=t[0].length,r=0;r<n;r++)for(var i=0;i<o;i++)e[i]||(e[i]=[]),e[i][r]=t[r][i];return e}function a(t,e,n,o){var r=-1,i=t;Array.isArray(t)||(i=Array.from(t));var a=i.length;for(o&&a&&(n=i[++r]);++r<a;)n=e(n,i[r],r,i);return n}function s(t,e){var n=-1,o=t;Array.isArray(t)||(o=Array.from(t));for(var r=o.length,i=[],a=-1;++n<r;){var s=o[n];e(s,n,o)&&(i[++a]=s)}return i}function l(t,e){var n=-1,o=t;Array.isArray(t)||(o=Array.from(t));for(var r=o.length,i=[],a=-1;++n<r;){var s=o[n];i[++a]=e(s,n,o)}return i}function u(t,e){var n=-1,o=t;Array.isArray(t)||(o=Array.from(t));for(var r=o.length;++n<r&&!1!==e(o[n],n,o););return t}function c(t){return a(t,function(t,e){return t+e},0)}function h(t){return a(t,function(t,e){return t>e?t:e},Array.isArray(t)?t[0]:void 0)}function f(t){return a(t,function(t,e){return t<e?t:e},Array.isArray(t)?t[0]:void 0)}function d(t){return t.length?c(t)/t.length:0}function p(t){return a(t,function(t,e){return t.concat(Array.isArray(e)?p(e):e)},[])}function v(t){var e=[];return u(t,function(t){-1===e.indexOf(t)&&e.push(t)}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.to2dArray=o,e.extendArray=r,e.pivot=i,e.arrayReduce=a,e.arrayFilter=s,e.arrayMap=l,e.arrayEach=u,e.arraySum=c,e.arrayMax=h,e.arrayMin=f,e.arrayAvg=d,e.arrayFlatten=p,e.arrayUnique=v},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e;return Array.isArray(t)?e=[]:(e={},p(t,function(t,n){"__children"!==n&&(e[n]=t&&"object"===(void 0===t?"undefined":w(t))&&!Array.isArray(t)?r(t):Array.isArray(t)?t.length&&"object"===w(t[0])&&!Array.isArray(t[0])?[r(t[0])]:[]:null)})),e}function i(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function a(t,e){return p(e,function(e,n){t[n]=e}),t}function s(t,e){p(e,function(n,o){e[o]&&"object"===w(e[o])?(t[o]||(t[o]=Array.isArray(e[o])?[]:"[object Date]"===Object.prototype.toString.call(e[o])?e[o]:{}),s(t[o],e[o])):t[o]=e[o]})}function l(t){return"object"===(void 0===t?"undefined":w(t))?JSON.parse(JSON.stringify(t)):t}function u(t){var e={};return p(t,function(t,n){e[n]=t}),e}function c(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(b.arrayEach)(n,function(e){t.MIXINS.push(e.MIXIN_NAME),p(e,function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '"+n+"' already exist and cannot be overwritten.");"function"==typeof e?t.prototype[n]=e:Object.defineProperty(t.prototype,n,{get:function(t,e){t="_"+t;var n=function(t){return(Array.isArray(t)||f(t))&&(t=l(t)),t};return function(){return void 0===this[t]&&(this[t]=n(e)),this[t]}}(n,e),set:function(t){return t="_"+t,function(e){this[t]=e}}(n),configurable:!0})})}),t}function h(t,e){return JSON.stringify(t)===JSON.stringify(e)}function f(t){return"[object Object]"==Object.prototype.toString.call(t)}function d(t,e,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(t,e,o)}function p(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function v(t,e){var n=e.split("."),o=t;return p(n,function(t){if(void 0===(o=o[t]))return o=void 0,!1}),o}function g(t){return f(t)?function t(e){var n=0;return f(e)?p(e,function(e){n+=t(e)}):n++,n}(t):0}function y(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_"+n,i=(e={_touched:!1},o(e,r,t),o(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),i}function m(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.duckSchema=r,e.inherit=i,e.extend=a,e.deepExtend=s,e.deepClone=l,e.clone=u,e.mixin=c,e.isObjectEquals=h,e.isObject=f,e.defineGetter=d,e.objectEach=p,e.getProperty=v,e.deepObjectSize=g,e.createObjectPropListener=y,e.hasOwnProperty=m;var b=n(0),w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}},function(t,e,n){"use strict";function o(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null;null!=t;){if(n===e){o=t;break}t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t=t.host:(n++,t=t.parentNode)}return o}function r(t,e,n){for(;null!=t&&t!==n;){if(t.nodeType===Node.ELEMENT_NODE&&(e.indexOf(t.nodeName)>-1||e.indexOf(t)>-1))return t;t=t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode}return null}function i(t,e,n){for(var o=[];t&&(t=r(t,e,n))&&(!n||n.contains(t));)o.push(t),t=t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode;var i=o.length;return i?o[i-1]:null}function a(t,e){var n=t.parentNode,o=[];for("string"==typeof e?o=Array.prototype.slice.call(document.querySelectorAll(e),0):o.push(e);null!=n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function s(t){function e(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName===o.toUpperCase()}var n,o="hot-table",r=!1;for(n=l(t);null!=n;){if(e(n)){r=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r=e(n.host))break;n=n.host}n=n.parentNode}return r}function l(t){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(t):t}function u(t){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(t):t}function c(t){var e=0;if(t.previousSibling)for(;t=t.previousSibling;)++e;return e}function h(t,e){var n=document.querySelector(".ht_clone_"+t);return n?n.contains(e):null}function f(t){var e=0,n=[];if(!t||!t.length)return n;for(;t[e];)n.push(t[e]),e++;return n}function d(t,e){return q(t,e)}function p(t,e){return J(t,e)}function v(t,e){return $(t,e)}function g(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var n=t.childNodes,o=n.length-1;o>=0;o--)g(n[o],t)}function y(t){for(var e;e=t.lastChild;)t.removeChild(e)}function m(t,e){ot.test(e)?t.innerHTML=e:b(t,e)}function b(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?rt?n.textContent=e:n.data=e:(y(t),t.appendChild(document.createTextNode(e)))}function w(t){for(var e=t;u(e)!==document.documentElement;){if(null===e)return!1;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(e.host){if(e.host.impl)return w(e.host.impl);if(e.host)return w(e.host);throw new Error("Lost in Web Components world")}return!1}if("none"===e.style.display)return!1;e=e.parentNode}return!0}function O(t){var e,n,o,r,i;if(r=document.documentElement,Object(Z.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return i=t.getBoundingClientRect(),{top:i.top+(window.pageYOffset||r.scrollTop)-(r.clientTop||0),left:i.left+(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(e=t.offsetLeft,n=t.offsetTop,o=t;(t=t.offsetParent)&&t!==document.body;)e+=t.offsetLeft,n+=t.offsetTop,o=t;return o&&"fixed"===o.style.position&&(e+=window.pageXOffset||r.scrollLeft,n+=window.pageYOffset||r.scrollTop),{left:e,top:n}}function C(){var t=window.scrollY;return void 0===t&&(t=document.documentElement.scrollTop),t}function E(){var t=window.scrollX;return void 0===t&&(t=document.documentElement.scrollLeft),t}function S(t){return t===window?C():t.scrollTop}function k(t){return t===window?E():t.scrollLeft}function T(t){for(var e,n,o,r=t.parentNode,i=["auto","scroll"],a="",s="",l="",u="";r&&r.style&&document.body!==r;){if(e=r.style.overflow,n=r.style.overflowX,o=r.style.overflowY,"scroll"==e||"scroll"==n||"scroll"==o)return r;if(window.getComputedStyle&&(a=window.getComputedStyle(r),s=a.getPropertyValue("overflow"),l=a.getPropertyValue("overflow-y"),u=a.getPropertyValue("overflow-x"),"scroll"===s||"scroll"===u||"scroll"===l))return r;if(r.clientHeight<=r.scrollHeight+1&&(-1!==i.indexOf(o)||-1!==i.indexOf(e)||-1!==i.indexOf(s)||-1!==i.indexOf(l)))return r;if(r.clientWidth<=r.scrollWidth+1&&(-1!==i.indexOf(n)||-1!==i.indexOf(e)||-1!==i.indexOf(s)||-1!==i.indexOf(u)))return r;r=r.parentNode}return window}function R(t){for(var e=t.parentNode;e&&e.style&&document.body!==e;){if("visible"!==e.style.overflow&&""!==e.style.overflow)return e;if(window.getComputedStyle){var n=window.getComputedStyle(e);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return e}e=e.parentNode}return window}function _(t,e){if(t){if(t!==window){var n,o=t.style[e];return""!==o&&void 0!==o?o:(n=j(t),""!==n[e]&&void 0!==n[e]?n[e]:void 0)}if("width"===e)return window.innerWidth+"px";if("height"===e)return window.innerHeight+"px"}}function j(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}function A(t){return t.offsetWidth}function M(t){return Object(Z.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function H(t){return t.clientHeight||t.innerHeight}function P(t){return t.clientWidth||t.innerWidth}function N(t,e,n){window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function L(t,e,n){window.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)}function D(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var n=t.createTextRange(),o=n.duplicate();return n.moveToBookmark(e.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function x(t){if(t.selectionEnd)return t.selectionEnd;if(document.selection){var e=document.selection.createRange();return null==e?0:t.createTextRange().text.indexOf(e.text)+e.text.length}return 0}function I(){var t="";return window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(t=document.selection.createRange().text),t}function F(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){var o=t.parentNode,r=o.style.display;o.style.display="block",t.setSelectionRange(e,n),o.style.display=r}}else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",e),i.select()}}function B(){var t=document.createElement("div");t.style.height="200px",t.style.width="100%";var e=document.createElement("div");e.style.boxSizing="content-box",e.style.height="150px",e.style.left="0px",e.style.overflow="hidden",e.style.position="absolute",e.style.top="0px",e.style.width="200px",e.style.visibility="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var o=t.offsetWidth;return n==o&&(o=e.clientWidth),(document.body||document.documentElement).removeChild(e),n-o}function W(){return void 0===nt&&(nt=B()),nt}function V(t){return t.offsetWidth!==t.clientWidth}function U(t){return t.offsetHeight!==t.clientHeight}function z(t,e,n){Object(Q.isIE8)()||Object(Q.isIE9)()?(t.style.top=n,t.style.left=e):Object(Q.isSafari)()?t.style["-webkit-transform"]="translate3d("+e+","+n+",0)":t.style.transform="translate3d("+e+","+n+",0)"}function G(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1}function X(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function Y(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function K(t){return Y(t)&&-1==t.className.indexOf("handsontableInput")&&-1==t.className.indexOf("copyPaste")}Object.defineProperty(e,"__esModule",{value:!0}),e.getParent=o,e.closest=r,e.closestDown=i,e.isChildOf=a,e.isChildOfWebComponentTable=s,e.polymerWrap=l,e.polymerUnwrap=u,e.index=c,e.overlayContainsElement=h,e.hasClass=d,e.addClass=p,e.removeClass=v,e.removeTextNodes=g,e.empty=y,n.d(e,"HTML_CHARACTERS",function(){return ot}),e.fastInnerHTML=m,e.fastInnerText=b,e.isVisible=w,e.offset=O,e.getWindowScrollTop=C,e.getWindowScrollLeft=E,e.getScrollTop=S,e.getScrollLeft=k,e.getScrollableElement=T,e.getTrimmingContainer=R,e.getStyle=_,e.getComputedStyle=j,e.outerWidth=A,e.outerHeight=M,e.innerHeight=H,e.innerWidth=P,e.addEvent=N,e.removeEvent=L,e.getCaretPosition=D,e.getSelectionEndPosition=x,e.getSelectionText=I,e.setCaretPosition=F,e.getScrollbarWidth=W,e.hasVerticalScrollbar=V,e.hasHorizontalScrollbar=U,e.setOverlayPosition=z,e.getCssTransform=G,e.resetCssTransform=X,e.isInput=Y,e.isOutsideInput=K;var q,J,$,Q=n(33),Z=n(42);if(!document.documentElement.classList){var tt=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)")};q=function(t,e){return void 0!==t.className&&tt(e).test(t.className)},J=function(t,e){var n=0,o=t.className;if("string"==typeof e&&(e=e.split(" ")),""===o)o=e.join(" ");else for(;e&&e[n];)tt(e[n]).test(o)||(o+=" "+e[n]),n++;t.className=o},$=function(t,e){var n=0,o=t.className;for("string"==typeof e&&(e=e.split(" "));e&&e[n];)o=o.replace(tt(e[n])," ").trim(),n++;t.className!==o&&(t.className=o)}}else{var et=function(){var t=document.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")}();q=function(t,e){return void 0!==t.classList&&""!==e&&t.classList.contains(e)},J=function(t,e){var n=0;if("string"==typeof e&&(e=e.split(" ")),e=f(e),et)t.classList.add.apply(t.classList,e);else for(;e&&e[n];)t.classList.add(e[n]),n++},$=function(t,e){var n=0;if("string"==typeof e&&(e=e.split(" ")),e=f(e),et)t.classList.remove.apply(t.classList,e);else for(;e&&e[n];)t.classList.remove(e[n]),n++}}var nt,ot=/(<(.*)>|&(.*);)/,rt=!!document.createTextNode("test").textContent},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",function(){return o}),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",function(){return r}),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",function(){return i}),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",function(){return a}),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",function(){return s}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",function(){return l}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",function(){return u}),n.d(e,"CONTEXTMENU_ITEMS_UNDO",function(){return c}),n.d(e,"CONTEXTMENU_ITEMS_REDO",function(){return h}),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",function(){return f}),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",function(){return d}),n.d(e,"CONTEXTMENU_ITEMS_COPY",function(){return p}),n.d(e,"CONTEXTMENU_ITEMS_CUT",function(){return v}),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",function(){return g}),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",function(){return y}),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",function(){return m}),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",function(){return b}),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",function(){return w}),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",function(){return O}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",function(){return C}),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",function(){return E}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",function(){return S}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",function(){return k}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",function(){return T}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",function(){return R}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",function(){return _}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",function(){return j}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",function(){return A}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",function(){return M}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",function(){return H}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",function(){return P}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",function(){return N}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",function(){return L}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",function(){return D}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",function(){return x}),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",function(){return I}),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",function(){return F}),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",function(){return B}),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",function(){return W}),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",function(){return V}),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",function(){return U}),n.d(e,"FILTERS_NAMESPACE",function(){return z}),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",function(){return G}),n.d(e,"FILTERS_CONDITIONS_NONE",function(){return X}),n.d(e,"FILTERS_CONDITIONS_EMPTY",function(){return Y}),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",function(){return K}),n.d(e,"FILTERS_CONDITIONS_EQUAL",function(){return q}),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",function(){return J}),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",function(){return $}),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",function(){return Q}),n.d(e,"FILTERS_CONDITIONS_CONTAINS",function(){return Z}),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",function(){return tt}),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",function(){return et}),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",function(){return nt}),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",function(){return ot}),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",function(){return rt}),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",function(){return it}),n.d(e,"FILTERS_CONDITIONS_BETWEEN",function(){return at}),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",function(){return st}),n.d(e,"FILTERS_CONDITIONS_AFTER",function(){return lt}),n.d(e,"FILTERS_CONDITIONS_BEFORE",function(){return ut}),n.d(e,"FILTERS_CONDITIONS_TODAY",function(){return ct}),n.d(e,"FILTERS_CONDITIONS_TOMORROW",function(){return ht}),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",function(){return ft}),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",function(){return dt}),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",function(){return pt}),n.d(e,"FILTERS_LABELS_CONJUNCTION",function(){return vt}),n.d(e,"FILTERS_LABELS_DISJUNCTION",function(){return gt}),n.d(e,"FILTERS_VALUES_BLANK_CELLS",function(){return yt}),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",function(){return mt}),n.d(e,"FILTERS_BUTTONS_CLEAR",function(){return bt}),n.d(e,"FILTERS_BUTTONS_OK",function(){return wt}),n.d(e,"FILTERS_BUTTONS_CANCEL",function(){return Ot}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",function(){return Ct}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",function(){return Et}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",function(){return St});var o="ContextMenu:items",r=o+".insertRowAbove",i=o+".insertRowBelow",a=o+".insertColumnOnTheLeft",s=o+".insertColumnOnTheRight",l=o+".removeRow",u=o+".removeColumn",c=o+".undo",h=o+".redo",f=o+".readOnly",d=o+".clearColumn",p=o+".copy",v=o+".cut",g=o+".freezeColumn",y=o+".unfreezeColumn",m=o+".mergeCells",b=o+".unmergeCells",w=o+".addComment",O=o+".editComment",C=o+".removeComment",E=o+".readOnlyComment",S=o+".align",k=o+".align.left",T=o+".align.center",R=o+".align.right",_=o+".align.justify",j=o+".align.top",A=o+".align.middle",M=o+".align.bottom",H=o+".borders",P=o+".borders.top",N=o+".borders.right",L=o+".borders.bottom",D=o+".borders.left",x=o+".borders.remove",I=o+".nestedHeaders.insertChildRow",F=o+".nestedHeaders.detachFromParent",B=o+".hideColumn",W=o+".showColumn",V=o+".hideRow",U=o+".showRow",z="Filters:",G=z+"conditions",X=G+".none",Y=G+".isEmpty",K=G+".isNotEmpty",q=G+".isEqualTo",J=G+".isNotEqualTo",$=G+".beginsWith",Q=G+".endsWith",Z=G+".contains",tt=G+".doesNotContain",et=G+".byValue",nt=G+".greaterThan",ot=G+".greaterThanOrEqualTo",rt=G+".lessThan",it=G+".lessThanOrEqualTo",at=G+".isBetween",st=G+".isNotBetween",lt=G+".after",ut=G+".before",ct=G+".today",ht=G+".tomorrow",ft=G+".yesterday",dt=z+"labels.filterByCondition",pt=z+"labels.filterByValue",vt=z+"labels.conjunction",gt=z+"labels.disjunction",yt=z+"values.blankCells",mt=z+"buttons.selectAll",bt=z+"buttons.clear",wt=z+"buttons.ok",Ot=z+"buttons.cancel",Ct=z+"buttons.placeholder.search",Et=z+"buttons.placeholder.value",St=z+"buttons.placeholder.secondValue"},function(t,e,n){"use strict";function o(t){var e=void 0===t?"undefined":s(t);return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function r(t,e,n){var o=-1;for("function"==typeof e?(n=e,e=t):o=t-1;++o<=e&&!1!==n(o););}function i(t,e,n){var o=t+1;for("function"==typeof e&&(n=e,e=0);--o>=e&&!1!==n(o););}function a(t,e){return e=parseInt(e.toString().replace("%",""),10),e=parseInt(t*e/100,10)}Object.defineProperty(e,"__esModule",{value:!0}),e.isNumeric=o,e.rangeEach=r,e.rangeEachReverse=i,e.valueAccordingPercent=a;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}},function(t,e,n){var o=n(17),r=n(49),i=n(38),a=n(37),s=n(39),l=function t(e,n,l){var u,c,h,f,d=e&t.F,p=e&t.G,v=e&t.S,g=e&t.P,y=e&t.B,m=p?o:v?o[n]||(o[n]={}):(o[n]||{}).prototype,b=p?r:r[n]||(r[n]={}),w=b.prototype||(b.prototype={});p&&(l=n);for(u in l)c=!d&&m&&void 0!==m[u],h=(c?m:l)[u],f=y&&c?s(h,o):g&&"function"==typeof h?s(Function.call,h):h,m&&a(m,u,h,e&t.U),b[u]!=h&&i(b,u,f),g&&w[u]!=h&&(w[u]=h)};o.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){"use strict";function o(t,e){t=Object(u.toUpperCaseFirst)(t),s.a.getSingleton().add("construct",function(){var n=void 0;c.has(this)||c.set(this,{}),n=c.get(this),n[t]||(n[t]=new e(this))}),s.a.getSingleton().add("afterDestroy",function(){if(c.has(this)){var t=c.get(this);Object(l.objectEach)(t,function(t){return t.destroy()}),c.delete(this)}})}function r(t,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var n=Object(u.toUpperCaseFirst)(e);if(c.has(t)&&c.get(t)[n])return c.get(t)[n]}function i(t){return c.has(t)?Object.keys(c.get(t)):[]}function a(t,e){var n=null;return c.has(t)&&Object(l.objectEach)(c.get(t),function(t,o){t===e&&(n=o)}),n}n.d(e,"d",function(){return o}),n.d(e,"a",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"b",function(){return a});var s=n(13),l=n(1),u=n(30),c=new WeakMap},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(0),a=n(53),s=n(6),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=new WeakMap,c=null;e.a=function(){function t(e){var n=this;o(this,t),Object(r.defineGetter)(this,"hot",e,{writable:!1}),Object(r.defineGetter)(this,"t",Object(a.a)(e),{writable:!1}),u.set(this,{hooks:{}}),c=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return n.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return n.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return n.init()})}return l(t,[{key:"init",value:function(){this.pluginName=Object(s.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),c||(c=Object(s.c)(this.hot)),c.indexOf(this.pluginName)>=0&&c.splice(c.indexOf(this.pluginName),1),c.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){u.get(this).hooks[t]=u.get(this).hooks[t]||[];var n=u.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),u.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;Object(i.arrayEach)(u.get(this).hooks[t]||[],function(n){e.hot.removeHook(t,n)})}},{key:"clearHooks",value:function(){var t=this,e=u.get(this).hooks;Object(r.objectEach)(e,function(e,n){return t.removeHooks(n)}),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){Object(i.arrayEach)(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(r.objectEach)(this,function(e,n){"hot"!==n&&"t"!==n&&(t[n]=null)}),delete this.t,delete this.hot}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var n=void 0,o=void 0,r=void 0,i=void 0,c=void 0,h=void 0;if(e.isTargetWebComponent=!1,e.realTarget=e.target,h=e.stopImmediatePropagation,e.stopImmediatePropagation=function(){h.apply(this),Object(u.stopImmediatePropagation)(this)},!f.isHotTableEnv)return e;for(e=Object(a.polymerWrap)(e),c=e.path?e.path.length:0;c--;){if("HOT-TABLE"===e.path[c].nodeName)n=!0;else if(n&&e.path[c].shadowRoot){i=e.path[c];break}0!==c||i||(i=e.path[c])}return i||(i=e.target),e.isTargetWebComponent=!0,Object(l.isWebComponentSupportedNatively)()?e.realTarget=e.srcElement||e.toElement:(Object(s.hasOwnProperty)(t,"hot")||t.isHotTableEnv||t.wtTable)&&(Object(s.hasOwnProperty)(t,"hot")?o=t.hot?t.hot.view.wt.wtTable.TABLE:null:t.isHotTableEnv?o=t.view.activeWt.wtTable.TABLE.parentNode.parentNode:t.wtTable&&(o=t.wtTable.TABLE.parentNode.parentNode),r=Object(a.closest)(e.target,["HOT-TABLE"],o),e.realTarget=r?o.querySelector("HOT-TABLE")||e.target:e.target),Object.defineProperty(e,"target",{get:function(){return Object(a.polymerWrap)(i)},enumerable:!0,configurable:!0}),e}function i(){return h}e.b=i;var a=n(2),s=n(1),l=n(42),u=n(11),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=0,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return c(t,[{key:"addEventListener",value:function(t,e,n){function o(t){t=r(a,t),n.call(this,t)}var i=this,a=this.context;return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:o}),window.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o),h++,function(){i.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){for(var o=this.context.eventListeners.length,r=void 0;o--;)if(r=this.context.eventListeners[o],r.event==e&&r.element==t){if(n&&n!=r.callback)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),h--}}},{key:"clearEvents",value:function(){if(this.context)for(var t=this.context.eventListeners.length;t--;){var e=this.context.eventListeners[t];e&&this.removeEventListener(e.element,e.event,e.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(t,e){var n,o={bubbles:!0,cancelable:"mousemove"!==e,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||document.body.parentNode)):n=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent("on"+e,n)}}]),t}();e.a=f},function(t,e,n){"use strict";var o=n(85),r=(n.n(o),n(94)),i=(n.n(r),n(95)),a=(n.n(i),n(96)),s=(n.n(a),n(97)),l=(n.n(s),n(99)),u=(n.n(l),n(101)),c=(n.n(u),n(102)),h=(n.n(c),n(103)),f=(n.n(h),n(104)),d=(n.n(f),n(105)),p=(n.n(d),n(106)),v=(n.n(p),n(107)),g=(n.n(v),n(108)),y=(n.n(g),n(109)),m=(n.n(y),n(110)),b=(n.n(m),n(111)),w=(n.n(b),n(112)),O=(n.n(w),n(113)),C=(n.n(O),n(114)),E=(n.n(C),n(115)),S=(n.n(E),n(116)),k=(n.n(S),n(117)),T=(n.n(k),n(118)),R=(n.n(T),n(119)),_=(n.n(R),n(122)),j=(n.n(_),n(123)),A=(n.n(j),n(124)),M=(n.n(A),n(125)),H=(n.n(M),n(126)),P=(n.n(H),n(127)),N=(n.n(P),n(128)),L=(n.n(N),n(129)),D=(n.n(L),n(131)),x=(n.n(D),n(132)),I=(n.n(x),n(133)),F=(n.n(I),n(134)),B=(n.n(F),n(135)),W=(n.n(B),n(80)),V=(n.n(W),n(136)),U=(n.n(V),n(137)),z=(n.n(U),n(138)),G=(n.n(z),n(139)),X=(n.n(G),n(140)),Y=(n.n(X),n(141)),K=(n.n(Y),n(142)),q=(n.n(K),n(143)),J=(n.n(q),n(144)),$=(n.n(J),n(145)),Q=(n.n($),n(146)),Z=(n.n(Q),n(147)),tt=(n.n(Z),n(148)),et=(n.n(tt),n(149)),nt=(n.n(et),n(150)),ot=(n.n(nt),n(187)),rt=(n(188),n(60)),it=n(151),at=(n(189),n(190),n(266),n(267),n(268),n(269),n(199),n(191)),st=(n(192),n(193),n(194),n(270));n(195),n(196),n(197),n(198),n.d(e,"d",function(){return ot.a}),n.d(e,"a",function(){return rt.a}),n.d(e,"b",function(){return it.a}),n.d(e,"e",function(){return at.a}),n.d(e,"c",function(){return st.a})},function(t,e,n){"use strict";function o(t,e){if(!a[t])throw Error('Filter condition "'+t+'" does not exist.');var n=a[t],o=n.condition,r=n.descriptor;return r.inputValuesDecorator&&(e=r.inputValuesDecorator(e)),function(t){return o.apply(t.meta.instance,[].concat([t],[e]))}}function r(t){if(!a[t])throw Error('Filter condition "'+t+'" does not exist.');return a[t].descriptor}function i(t,e,n){n.key=t,a[t]={condition:e,descriptor:n}}e.a=o,e.b=r,e.c=i;var a={}},function(t,e,n){"use strict";function o(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function r(t){return!1===t.isImmediatePropagationEnabled}function i(t){"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function a(t){return t.pageX?t.pageX:t.clientX+Object(c.getWindowScrollLeft)()}function s(t){return t.pageY?t.pageY:t.clientY+Object(c.getWindowScrollTop)()}function l(t){return 2===t.button}function u(t){return 0===t.button}Object.defineProperty(e,"__esModule",{value:!0}),e.stopImmediatePropagation=o,e.isImmediatePropagationStopped=r,e.stopPropagation=i,e.pageX=a,e.pageY=s,e.isRightClick=l,e.isLeftClick=u;var c=n(2)},function(t,e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){return"object"===(void 0===t?"undefined":n(t))?null!==t:"function"==typeof t}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten"],l=function(){function t(){o(this,t),this.globalBucket=this.createEmptyBucket()}return a(t,null,[{key:"getSingleton",value:function(){return u}}]),a(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return Object(r.arrayEach)(s,function(e){return t[e]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Object(r.arrayEach)(e,function(e){return n.add(t,e,o)});else{var i=this.getBucket(o);if(void 0===i[t]&&(this.register(t),i[t]=[]),e.skip=!1,-1===i[t].indexOf(e)){var a=!1;e.initialHook&&Object(r.arrayEach)(i[t],function(n,o){if(n.initialHook)return i[t][o]=e,a=!0,!1}),a||i[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Object(r.arrayEach)(e,function(e){return n.once(t,e,o)}):(e.runOnce=!0,this.add(t,e,o))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this.getBucket(n);return void 0!==o[t]&&o[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,o,r,i,a,s){var l=this.globalBucket[e],u=-1,c=l?l.length:0;if(c)for(;++u<c;)if(l[u]&&!l[u].skip){var h=l[u].call(t,n,o,r,i,a,s);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(e,l[u])}var f=this.getBucket(t)[e],d=-1,p=f?f.length:0;if(p)for(;++d<p;)if(f[d]&&!f[d].skip){var v=f[d].call(t,n,o,r,i,a,s);void 0!==v&&(n=v),f[d]&&f[d].runOnce&&this.remove(e,f[d],t)}return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(i.objectEach)(this.getBucket(t),function(t,e,n){return n[e].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||s.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&s.splice(s.indexOf(t),1)}},{key:"isRegistered",value:function(t){return s.indexOf(t)>=0}},{key:"getRegistered",value:function(){return s}}]),t}(),u=new l;e.a=l},function(t,e,n){"use strict";function o(t){var e=void 0;switch(void 0===t?"undefined":d(t)){case"string":case"number":e=""+t;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function r(t){return void 0!==t}function i(t){return void 0===t}function a(t){return null===t||""===t||i(t)}function s(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function l(t,e){t=w(t||"");var n="",o=!0,r=u(t),i=C(),s=a(t)||"trial"===t;if(s||r)if(r){var l=Math.floor(h()(void 0,"DD/MM/YYYY").toDate().getTime()/864e5),c=O(t);(c>45e3||c!==parseInt(c,10))&&(n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly."),n||(l>c+1&&(n=Object(f.a)(p)),o=l>c+15)}else n="Evaluation version of Handsontable Pro. Not licensed for use in a production environment.";else n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.";if(i&&(n=!1,o=!1),n&&!E&&(console[s?"info":"warn"](n),E=!0),o&&e.parentNode){var d=document.createElement("div");d.id="hot-display-license-info",d.appendChild(document.createTextNode("Evaluation version of Handsontable Pro.")),d.appendChild(document.createElement("br")),d.appendChild(document.createTextNode("Not licensed for production use.")),e.parentNode.insertBefore(d,e.nextSibling)}}function u(t){var e=[][v],n=e;if(t[v]!==b("Z"))return!1;for(var o="",r="B<H4P+".split(""),i=b(r.shift());i;i=b(r.shift()||"A"))--i<""[v]?n|=(y(""+y(g(o)+(g(m(t,Math.abs(i),2))+[]).padStart(2,"0")))%97||2)>>1:o=m(t,i,i?1===r[v]?9:8:6);return n===e}Object.defineProperty(e,"__esModule",{value:!0}),e.stringify=o,e.isDefined=r,e.isUndefined=i,e.isEmpty=a,e.isRegExp=s,e._injectProductInfo=l;var c=n(31),h=n.n(c),f=n(61),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n          Your license key of Handsontable Pro has expired.ââââ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],["\n          Your license key of Handsontable Pro has expired.ââââ\\x20\n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "]),v="length",g=function(t){return parseInt(t,16)},y=function(t){return parseInt(t,10)},m=function(t,e,n){return t.substr(e,n)},b=function(t){return t.codePointAt(0)-65},w=function(t){return(""+t).replace(/\-/g,"")},O=function(t){return g(m(w(t),g("12"),b("F")))/(g(m(w(t),b("B"),~~![][v]))||9)},C=function(){return!0},E=!1},function(t,e,n){"use strict";function o(t){if("function"==typeof t)return t;if(!v(t))throw Error('No registered renderer found under "'+t+'" name');return p(t)}n.d(e,"c",function(){return d}),n.d(e,"b",function(){return o}),n.d(e,"a",function(){return g});var r=n(47),i=n(281),a=n(282),s=n(283),l=n(284),u=n(285),c=n(287),h=n(288),f=Object(r.a)("renderers"),d=f.register,p=f.getItem,v=f.hasItem,g=f.getNames;d("base",i.a),d("autocomplete",a.a),d("checkbox",s.a),d("html",l.a),d("numeric",u.a),d("password",c.a),d("text",h.a)},function(t,e,n){var o=n(91)("wks"),r=n(55),i=n(17).Symbol,a="function"==typeof i;(t.exports=function(t){return o[t]||(o[t]=a&&i[t]||(a?i:r)("Symbol."+t))}).store=o},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";function o(t){return 32==t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function r(t){return-1!==[u.ARROW_DOWN,u.ARROW_UP,u.ARROW_LEFT,u.ARROW_RIGHT,u.HOME,u.END,u.DELETE,u.BACKSPACE,u.F1,u.F2,u.F3,u.F4,u.F5,u.F6,u.F7,u.F8,u.F9,u.F10,u.F11,u.F12,u.TAB,u.PAGE_DOWN,u.PAGE_UP,u.ENTER,u.ESCAPE,u.SHIFT,u.CAPS_LOCK,u.ALT].indexOf(t)}function i(t){var e=[];return window.navigator.platform.includes("Mac")?e.push(u.COMMAND_LEFT,u.COMMAND_RIGHT,u.COMMAND_FIREFOX):e.push(u.CONTROL),e.includes(t)}function a(t){return[u.CONTROL,u.COMMAND_LEFT,u.COMMAND_RIGHT,u.COMMAND_FIREFOX].includes(t)}function s(t,e){var n=e.split("|"),o=!1;return Object(l.arrayEach)(n,function(e){if(t===u[e])return o=!0,!1}),o}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"KEY_CODES",function(){return u}),e.isPrintableChar=o,e.isMetaKey=r,e.isCtrlKey=i,e.isCtrlMetaKey=a,e.isKey=s;var l=n(0),u={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(t,e,n){"use strict";function o(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},l.a.getSingleton().add("afterDestroy",function(){e={}})}function r(t,e){var n=void 0;if("function"==typeof t)w.get(t)||a(null,t),n=w.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=E(t)}if(!n)throw Error('No editor registered under name "'+t+'"');return n.getInstance(e)}function i(t){if(!S(t))throw Error('No registered editor found under "'+t+'" name');return E(t).getConstructor()}function a(t,e){var n=new o(e);"string"==typeof t&&C(t,n),w.set(e,n)}n.d(e,"d",function(){return a}),n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return k});var s=n(47),l=n(13),u=n(52),c=n(200),h=n(272),f=n(273),d=n(276),p=n(201),v=n(277),g=n(278),y=n(279),m=n(280),b=n(62),w=new WeakMap,O=Object(s.a)("editors"),C=O.register,E=O.getItem,S=O.hasItem,k=O.getNames;a("base",u.b),a("autocomplete",c.a),a("checkbox",h.a),a("date",f.a),a("dropdown",d.a),a("handsontable",p.a),a("mobile",v.a),a("numeric",g.a),a("password",y.a),a("select",m.a),a("text",b.a)},function(t,e,n){var o=n(12);t.exports=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var o=n(0),r=n(1),i={_localHooks:Object.create(null),addLocalHook:function(t,e){this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e)},runLocalHooks:function(t){for(var e=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._localHooks[t]&&Object(o.arrayEach)(this._localHooks[t],function(t){return t.apply(e,r)})},clearLocalHooks:function(){this._localHooks={}}};Object(r.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.a=i},function(t,e,n){var o=n(20),r=n(162),i=n(87),a=Object.defineProperty;e.f=n(24)?Object.defineProperty:function(t,e,n){if(o(t),e=i(e,!0),o(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";function o(t){return Object(O.arrayMap)(t,function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}})}function r(t){return Object(C.hasClass)(t,"htSeparator")}function i(t){return Object(C.hasClass)(t,"htSubmenu")}function a(t){return Object(C.hasClass)(t,"htDisabled")}function s(t){return Object(C.hasClass)(t,"htSelectionDisabled")}function l(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function u(t,e){return-1!=t.indexOf(e)?t:(t=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),t+=" "+e)}function c(t,e){return-1!=t.indexOf(e)?t:(t=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),t+=" "+e)}function h(t,e){var n={};return Object(O.arrayEach)(t,function(t){for(var o=t.from,r=t.to,i=o.row;i<=r.row;i++)for(var a=o.col;a<=r.col;a++)n[i]||(n[i]=[]),n[i][a]=e(i,a)}),n}function f(t,e,n,o,r){Object(O.arrayEach)(t,function(t){var i=t.from,a=t.to;if(i.row==a.row&&i.col==a.col)d(i.row,i.col,e,n,o,r);else for(var s=i.row;s<=a.row;s++)for(var l=i.col;l<=a.col;l++)d(s,l,e,n,o,r)})}function d(t,e,n,o,r,i){var a=r(t,e),s=o;a.className&&(s="vertical"===n?u(a.className,o):c(a.className,o)),i(t,e,"className",s)}function p(t,e){var n=!1;return Array.isArray(t)&&Object(O.arrayEach)(t,function(t){return t.forAll(function(t,o){if(e(t,o))return n=!0,!1}),n}),n}function v(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t}function g(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}function y(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}function m(t,e){var n=t.slice(0);return n.reverse(),n=y(n,e),n.reverse(),n}function b(t){var e=[];return Object(O.arrayEach)(t,function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.a,n=t.slice(0);return n=y(n,e),n=m(n,e),n=b(n)}e.l=o,e.j=r,e.f=i,e.g=a,e.i=s,e.e=l,e.d=h,e.a=f,e.b=p,e.k=v,e.h=g,e.c=w;var O=n(0),C=(n(4),n(2)),E=n(83)},function(t,e,n){t.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var o=n(89),r=n(46);t.exports=function(t){return o(r(t))}},function(t,e,n){var o=n(68),r=Math.min;t.exports=function(t){return t>0?r(o(t),9007199254740991):0}},function(t,e,n){var o=n(5),r=n(49),i=n(25);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),o(o.S+o.F*i(function(){n(1)}),"Object",a)}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(1),a=n(0),s=n(8),l=n(191),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c={};e.a=function(){function t(e){o(this,t),Object(i.defineGetter)(this,"wot",e,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return u(t,null,[{key:"registerOverlay",value:function(e,n){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error("Unsupported overlay ("+e+").");c[e]=n}},{key:"createOverlay",value:function(t,e){return new c[t](e)}},{key:"hasOverlay",value:function(t){return void 0!==c[t]}},{key:"isOverlayTypeOf",value:function(t,e){return!(!t||!c[e])&&t instanceof c[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[t.CLONE_TOP,t.CLONE_BOTTOM,t.CLONE_LEFT,t.CLONE_TOP_LEFT_CORNER,t.CLONE_BOTTOM_LEFT_CORNER,t.CLONE_DEBUG]}}]),u(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=Object(r.getScrollableElement)(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(e){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error('Clone type "'+e+'" is not supported.');var n=document.createElement("DIV"),o=document.createElement("TABLE");n.className="ht_clone_"+e+" handsontable",n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.overflow="hidden",o.className=this.wot.wtTable.TABLE.className,n.appendChild(o),this.type=e,this.wot.wtTable.wtRootElement.parentNode.appendChild(n);var i=this.wot.getSetting("preventOverflow");return this.mainTableScrollableElement=!0===i||"horizontal"===i&&this.type===t.CLONE_TOP||"vertical"===i&&this.type===t.CLONE_LEFT?window:Object(r.getScrollableElement)(this.wot.wtTable.TABLE),new l.a({cloneSource:this.wot,cloneOverlay:this,table:o})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,o=e.style,r=t.parentNode.style;Object(a.arrayEach)([n,o,r],function(t){t.width="",t.height=""})}}},{key:"destroy",value:function(){new s.a(this.clone).destroy()}}]),t}()},function(t,e,n){"use strict";function o(t){return t[0].toUpperCase()+t.substr(1)}function r(){for(var t=[],e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];for(var r=n.length;r--;){var i=Object(u.stringify)(n[r]).toLowerCase();-1===t.indexOf(i)&&t.push(i)}return 1===t.length}function i(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function a(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(""+t).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]})}function l(t){return t+="",t.replace(c,"")}Object.defineProperty(e,"__esModule",{value:!0}),e.toUpperCaseFirst=o,e.equalsIgnoreCase=r,e.randomString=i,e.isPercentValue=a,e.substitute=s,e.stripTags=l;var u=n(14),c=(n(4),/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi)},function(e,n){e.exports=t},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";function o(){return l}function r(){return u}function i(){return c}function a(){return h}function s(t){return t||(t=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.isIE8=o,e.isIE9=r,e.isSafari=i,e.isChrome=a,e.isMobileBrowser=s;var l=!document.createTextNode("test").textContent,u=!!document.documentMode,c=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),h=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(t,e,n){"use strict";function o(t){return"function"==typeof t}function r(t){function e(){var e=this,a=arguments,s=Date.now(),l=!1;r.lastCallThrottled=!0,o||(o=s,l=!0);var u=n-(s-o);return l?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(function(){r.lastCallThrottled=!1,t.apply(e,a),o=0,i=void 0},u)),r}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0,r={lastCallThrottled:!0},i=null;return e}function i(t){function e(){s=i}function n(){return s?(s--,t.apply(this,arguments)):a.apply(this,arguments)}var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=r(t,o),s=i;return n.clearHits=e,n}function a(t){function e(){var e=this,i=arguments;return o&&clearTimeout(o),o=setTimeout(function(){r=t.apply(e,i)},n),r}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null,r=void 0;return e}function s(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],r=e.slice(1);return function(){return Object(h.arrayReduce)(r,function(t,e){return e(t)},o.apply(this,arguments))}}function l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return function(){for(var e=arguments.length,o=Array(e),r=0;r<e;r++)o[r]=arguments[r];return t.apply(this,n.concat(o))}}function u(t){function e(o){return function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=o.concat(i);return s.length>=n?t.apply(this,s):e(s)}}var n=t.length;return e([])}function c(t){function e(o){return function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=o.concat(i.reverse());return s.length>=n?t.apply(this,s):e(s)}}var n=t.length;return e([])}Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=o,e.throttle=r,e.throttleAfterHits=i,e.debounce=a,e.pipe=s,e.partial=l,e.curry=u,e.curryRight=c;var h=n(0)},function(t,e,n){"use strict";function o(t){if("function"==typeof t)return t;if(!f(t))throw Error('No registered validator found under "'+t+'" name');return h(t)}n.d(e,"c",function(){return c}),n.d(e,"b",function(){return o}),n.d(e,"a",function(){return d});var r=n(47),i=n(289),a=n(290),s=n(291),l=n(292),u=Object(r.a)("validators"),c=u.register,h=u.getItem,f=u.hasItem,d=u.getNames;c("autocomplete",i.a),c("date",a.a),c("numeric",s.a),c("time",l.a)},function(t,e,n){"use strict";function o(t){return"string"==typeof t&&t.length>=2&&"="===t.charAt(0)}function r(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function i(t){return r(t)?t.substr(1):t}function a(t){var e=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=t.match(e)||[],o=-1;return t.toUpperCase().replace(e,function(){return++o,n[o]})}function s(t,e){return function(n){return{row:"row"===t?e:n.row,column:"column"===t?e:n.column}}}e.b=o,e.c=r,e.e=i,e.d=a,e.a=s},function(t,e,n){var o=n(17),r=n(38),i=n(32),a=n(55)("src"),s=Function.toString,l=(""+s).split("toString");n(49).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(i(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(i(n,a)||r(n,a,t[e]?""+t[e]:l.join(String(e)))),t===o?t[e]=n:s?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var o=n(22),r=n(56);t.exports=n(24)?function(t,e,n){return o.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var o=n(71);t.exports=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,r){return t.call(e,n,o,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var o=n(46);t.exports=function(t){return Object(o(t))}},function(t,e,n){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(55)("meta"),i=n(12),a=n(32),s=n(22).f,l=0,u=Object.isExtensible||function(){return!0},c=!n(25)(function(){return u(Object.preventExtensions({}))}),h=function(t){s(t,r,{value:{i:"O"+ ++l,w:{}}})},f=function(t,e){if(!i(t))return"symbol"==(void 0===t?"undefined":o(t))?t:("string"==typeof t?"S":"P")+t;if(!a(t,r)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[r].i},d=function(t,e){if(!a(t,r)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[r].w},p=function(t){return c&&v.NEED&&u(t)&&!a(t,r)&&h(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}},function(t,e,n){"use strict";function o(t){return d.call(window,t)}function r(t){p.call(window,t)}function i(){return"ontouchstart"in window}function a(){var t=document.createElement("div");return!(!t.createShadowRoot||!t.createShadowRoot.toString().match(/\[native code\]/))}function s(){var t=document.createElement("TABLE");t.style.borderSpacing=0,t.style.borderWidth=0,t.style.padding=0;var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,t.insertBefore(n,e),document.body.appendChild(t),g=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function l(){return void 0===g&&s(),g}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y||(y="object"===("undefined"==typeof Intl?"undefined":c(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return(""+t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1})}Object.defineProperty(e,"__esModule",{value:!0}),e.requestAnimationFrame=o,e.cancelAnimationFrame=r,e.isTouchSupported=i,e.isWebComponentSupportedNatively=a,e.hasCaptionProblem=l,e.getComparisonFunction=u;for(var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=0,f=["ms","moz","webkit","o"],d=window.requestAnimationFrame,p=window.cancelAnimationFrame,v=0;v<f.length&&!d;++v)d=window[f[v]+"RequestAnimationFrame"],p=window[f[v]+"CancelAnimationFrame"]||window[f[v]+"CancelRequestAnimationFrame"];d||(d=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-h)),o=window.setTimeout(function(){t(e+n)},n);return h=e+n,o}),p||(p=function(t){clearTimeout(t)});var g,y=void 0},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(){var t={};return Object(i.objectEach)(w,function(e,n){t[n]=e()}),t}n.d(e,"e",function(){return b}),e.n=r;var i=n(1),a=n(213),s=n(214),l=n(215),u=n(216),c=n(217),h=n(218),f=n(219),d=n(221),p=n(222),v=n(223),g=n(83),y=n(224);n.d(e,"a",function(){return a.a}),n.d(e,"b",function(){return s.a}),n.d(e,"c",function(){return l.a}),n.d(e,"d",function(){return u.a}),n.d(e,"f",function(){return c.a}),n.d(e,"g",function(){return h.a}),n.d(e,"h",function(){return f.a}),n.d(e,"i",function(){return d.a}),n.d(e,"j",function(){return p.a}),n.d(e,"k",function(){return v.a}),n.d(e,"l",function(){return g.a}),n.d(e,"m",function(){return y.a});var m,b=[p.a,v.a,l.a,u.a,s.a,d.a,f.a,y.a,h.a,c.a,a.a,g.a],w=(m={},o(m,g.a,g.b),o(m,p.a,p.b),o(m,v.a,v.b),o(m,l.a,l.b),o(m,u.a,u.b),o(m,s.a,s.b),o(m,d.a,d.b),o(m,f.a,f.b),o(m,y.a,y.b),o(m,h.a,h.b),o(m,c.a,c.b),o(m,a.a,a.b),m)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(66),s=(n.n(a),n(0)),l=n(239),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=[1,2,3];e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.precedents=[],i.value=null,i.error=null,i.state=e.STATE_UP_TO_DATE,i}return i(e,t),u(e,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),u(e,[{key:"setValue",value:function(t){this.value=t}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(t){this.error=t}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(t){if(-1===c.indexOf(t))throw Error("Unrecognized state: "+t);this.state=t}},{key:"isState",value:function(t){return this.state===t}},{key:"addPrecedent",value:function(t){if(this.isEqual(t))throw Error(a.ERROR_REF);this.hasPrecedent(t)||this.precedents.push(t)}},{key:"removePrecedent",value:function(t){if(this.isEqual(t))throw Error(a.ERROR_REF);this.precedents=Object(s.arrayFilter)(this.precedents,function(e){return!e.isEqual(t)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(t){return Object(s.arrayFilter)(this.precedents,function(e){return e.isEqual(t)}).length>0}}]),e}(l.a)},function(t,e,n){var o=n(163),r=n(92);t.exports=Object.keys||function(t){return o(t,r)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(){function t(t,e){l.set(t,e)}function e(t){return l.get(t)}function n(t){return l.has(t)}function r(){return[].concat(o(l.keys()))}function a(){return[].concat(o(l.values()))}var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(s)||i.set(s,new Map);var l=i.get(s);return{register:t,getItem:e,hasItem:n,getNames:r,getValues:a}}e.a=r;var i=new Map},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},function(t,e,n){var o=n(12);t.exports=function(t,e){if(!o(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var o=n(16)("unscopables"),r=Array.prototype;void 0==r[o]&&n(38)(r,o,{}),t.exports=function(t){r[o][t]=!0}},function(t,e,n){"use strict";function o(t){this.instance=t,this.state=a.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}n.d(e,"a",function(){return a});var r=n(9),i=n(14),a={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};o.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},o.prototype.init=function(){},o.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},o.prototype.setValue=function(t){throw Error("Editor setValue() method unimplemented")},o.prototype.open=function(){throw Error("Editor open() method unimplemented")},o.prototype.close=function(){throw Error("Editor close() method unimplemented")},o.prototype.prepare=function(t,e,n,o,r,i){this.TD=o,this.row=t,this.col=e,this.prop=n,this.originalValue=r,this.cellProperties=i,this.state=a.VIRGIN},o.prototype.extend=function(){function t(){e.apply(this,arguments)}var e=this.constructor;return function(t,e){function n(){}return n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t}(t,e)},o.prototype.saveValue=function(t,e){var n=void 0,o=void 0;e?(n=this.instance.getSelectedLast(),n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")},o.prototype.beginEditing=function(t,e){this.state===a.VIRGIN&&(this.instance.view.scrollViewport(new r.a(this.row,this.col)),this.instance.view.render(),this.state=a.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(Object(i.stringify)(t)),this.open(e),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},o.prototype.finishEditing=function(t,e,n){var o,r=this;if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t),r.instance.view.render()}}if(!this.isWaiting()){if(this.state==a.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));if(this.state==a.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();var s=this.getValue();o=this.instance.getSettings().trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=a.WAITING,this.saveValue(o,e),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){r.state=a.FINISHED,r.discardEditor(t)}):(this.state=a.FINISHED,this.discardEditor(!0))}}},o.prototype.cancelChanges=function(){this.state=a.FINISHED,this.discardEditor()},o.prototype.discardEditor=function(t){this.state===a.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=a.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=a.VIRGIN,this._fireCallbacks(!0)))},o.prototype.enableFullEditMode=function(){this._fullEditMode=!0},o.prototype.isInFullEditMode=function(){return this._fullEditMode},o.prototype.isOpened=function(){return this._opened},o.prototype.isWaiting=function(){return this.state===a.WAITING},o.prototype.checkEditorSection=function(){var t=this.instance.countRows(),e="";return this.row<this.instance.getSettings().fixedRowsTop?e=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?e=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(e="left"),e},e.b=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){var e=void 0;if(!(t instanceof i.a)){if(!u.has(t))throw Error("Record translator was not registered for this object identity");t=u.get(t)}return c.has(t)?e=c.get(t):(e=new l(t),c.set(t,e)),e}e.a=r;var i=n(153),a=n(1),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(){function t(e){o(this,t),this.hot=e}return s(t,[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,e){return Object(a.isObject)(t)?{row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:[this.toVisualRow(t),this.toVisualColumn(e)]}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,e){return Object(a.isObject)(t)?{row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:[this.toPhysicalRow(t),this.toPhysicalColumn(e)]}}]),t}(),u=new WeakMap,c=new WeakMap},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var r=n(0),i=n(1),a=n(4),s={_arrayMap:[],getValueByIndex:function(t){var e=this._arrayMap.length,n=null;return t<e&&(n=this._arrayMap[t]),n},getIndexByValue:function(t){var e=void 0;return-1===(e=this._arrayMap.indexOf(t))?null:e},insertItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Object(r.arrayMax)(this._arrayMap)+1,i=[];return Object(a.rangeEach)(n-1,function(n){i.push(e._arrayMap.splice(t+n,0,o+n))}),i},removeItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[];if(Array.isArray(t)){var i=[].concat(this._arrayMap);t.sort(function(t,e){return e-t}),o=Object(r.arrayReduce)(t,function(t,n){return e._arrayMap.splice(n,1),t.concat(i.slice(n,n+1))},[])}else o=this._arrayMap.splice(t,n);return o},unshiftItems:function(t){function e(t){return Object(r.arrayReduce)(o,function(e,n){return t>n&&e++,e},0)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=this.removeItems(t,n);this._arrayMap=Object(r.arrayMap)(this._arrayMap,function(t,n){var o=e(t);return o&&(t-=o),t})},shiftItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._arrayMap=Object(r.arrayMap)(this._arrayMap,function(e){return e>=t&&(e+=n),e}),Object(a.rangeEach)(n-1,function(n){e._arrayMap.splice(t+n,0,t+n)})},swapIndexes:function(t,e){var n;(n=this._arrayMap).splice.apply(n,[e,0].concat(o(this._arrayMap.splice(t,1))))},clearMap:function(){this._arrayMap.length=0}};Object(i.defineGetter)(s,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1}),e.a=s},function(t,e){var n=0,o=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+o).toString(36))}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},function(t,e,n){var o=n(22).f,r=n(32),i=n(16)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,i)&&o(t,i,{configurable:!0,value:e})}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),void 0!==e&&void 0!==n?(this.row=e,this.col=n):(this.row=null,this.col=null)}return r(t,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}()},function(t,e,n){"use strict";function o(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayReduce)(t,function(t,e,o){return t+e.replace(/(?:\r?\n\s+)/g,"")+(n[o]?n[o]:"")},"").trim()}e.a=o;var r=n(0)},function(t,e,n){"use strict";var o=n(2),r=n(271),i=n.n(r),a=n(52),s=n(8),l=n(18),u=n(11),c=a.b.prototype.extend();c.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new s.a(this),this.bindEvents(),this.autoResize=i()(),this.instance.addHook("afterDestroy",function(){t.destroy()})},c.prototype.getValue=function(){return this.TEXTAREA.value},c.prototype.setValue=function(t){this.TEXTAREA.value=t};var h=function(t){var e,n=this,r=n.getActiveEditor();if(e=(t.ctrlKey||t.metaKey)&&!t.altKey,t.target===r.TEXTAREA&&!Object(u.isImmediatePropagationStopped)(t)){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void Object(u.stopImmediatePropagation)(t);switch(t.keyCode){case l.KEY_CODES.ARROW_RIGHT:case l.KEY_CODES.ARROW_LEFT:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(t.keyCode))&&Object(u.stopImmediatePropagation)(t);break;case l.KEY_CODES.ARROW_UP:case l.KEY_CODES.ARROW_DOWN:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(t.keyCode))&&Object(u.stopImmediatePropagation)(t);break;case l.KEY_CODES.ENTER:var i=this.selection.isMultiple();if(e&&!i||t.altKey){if(r.isOpened()){var a=Object(o.getCaretPosition)(r.TEXTAREA),s=r.getValue();r.setValue(s.slice(0,a)+"\n"+s.slice(a)),Object(o.setCaretPosition)(r.TEXTAREA,a+1)}else r.beginEditing(r.originalValue+"\n");Object(u.stopImmediatePropagation)(t)}t.preventDefault();break;case l.KEY_CODES.A:case l.KEY_CODES.X:case l.KEY_CODES.C:case l.KEY_CODES.V:e&&Object(u.stopImmediatePropagation)(t);break;case l.KEY_CODES.BACKSPACE:case l.KEY_CODES.DELETE:case l.KEY_CODES.HOME:case l.KEY_CODES.END:Object(u.stopImmediatePropagation)(t)}-1===[l.KEY_CODES.ARROW_UP,l.KEY_CODES.ARROW_RIGHT,l.KEY_CODES.ARROW_DOWN,l.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&r.autoResize.resize(String.fromCharCode(t.keyCode))}};c.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",h)},c.prototype.close=function(t){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",h)},c.prototype.focus=function(){this.TEXTAREA.focus(),Object(o.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},c.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),Object(o.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),Object(o.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},c.prototype.getEditedCell=function(){var t;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":t=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":t=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=t&&-2!=t?t:void 0},c.prototype.refreshValue=function(){var t=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()},c.prototype.refreshDimensions=function(){if(this.state===a.a.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close(!0);var t,e=Object(o.offset)(this.TD),n=Object(o.offset)(this.instance.rootElement),r=Object(o.getScrollableElement)(this.TD),i=this.instance.countRows(),s=e.top===n.top?0:1,l=e.top-n.top-s-(r.scrollTop||0),u=e.left-n.left-1-(r.scrollLeft||0),c=this.instance.getSettings(),h=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),f=this.checkEditorSection(),d=this.TD.style.backgroundColor;switch(f){case"top":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(h&&0===this.instance.getSelectedLast()[0]||c.fixedRowsBottom&&this.instance.getSelectedLast()[0]===i-c.fixedRowsBottom)&&(l+=1),0===this.instance.getSelectedLast()[1]&&(u+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:Object(o.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top=l+"px",this.textareaParentStyle.left=u+"px";var p=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,v=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,g=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),y=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),m=Object(o.getScrollbarWidth)(),b=this.TD.offsetTop+p-y,w=this.TD.offsetLeft+v-g,O=Object(o.innerWidth)(this.TD)-8,C=Object(o.hasVerticalScrollbar)(r)?m:0,E=Object(o.hasHorizontalScrollbar)(r)?m:0,S=this.instance.view.maximumVisibleElementWidth(w)-9-C,k=this.TD.scrollHeight+1,T=Math.max(this.instance.view.maximumVisibleElementHeight(b)-E,23),R=Object(o.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=R.fontSize,this.TEXTAREA.style.fontFamily=R.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=d||Object(o.getComputedStyle)(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(k,T),maxHeight:T,minWidth:Math.min(O,S),maxWidth:S},!0),this.textareaParentStyle.display="block"}},c.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){Object(u.stopPropagation)(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){Object(u.stopPropagation)(t)}),this.instance.addHook("afterScrollHorizontally",function(){t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.destroy()})},c.prototype.destroy=function(){this.eventManager.destroy()},e.a=c},function(t,e,n){"use strict";function o(t,e){return""===t&&(t="("+e+")"),t}function r(t){return c&&(t=new Set(t)),function(e){return c?t.has(e):!!~t.indexOf(e)}}function i(t){return null==t?"":t}function a(t){return t=h?Array.from(new Set(t)):Object(u.arrayUnique)(t),t=t.sort(function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1})}function s(t,e,n,i){var a=[],s=t===e,l=void 0;return s||(l=r(e)),Object(u.arrayEach)(t,function(t){var e=!1;(s||l(t))&&(e=!0);var r={checked:e,value:t,visualValue:o(t,n)};i&&i(r),a.push(r)}),a}e.a=r,e.c=i,e.d=a,e.b=s;var l=n(42),u=n(0),c=(Object(l.getComparisonFunction)(),new Set([1]).has(1)),h=c&&"function"==typeof Array.from},function(t,e,n){"use strict";function o(t){if(!a[t])throw Error('Operation with id "'+t+'" does not exist.');var e=a[t].func;return function(t,n){return e(t,n)}}function r(t){return a[t].name}function i(t,e,n){a[t]={name:e,func:n}}n.d(e,"c",function(){return a}),e.a=o,e.b=r,e.d=i;var a={}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(21),a=n(8),s=n(2),l=n(0),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=["click","input","keydown","keypress","keyup","focus","blur","change"],h=function(){function t(e,n){o(this,t),this.hot=e,this.eventManager=new a.a(this),this.options=Object(r.extend)(t.DEFAULTS,n),this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}return u(t,null,[{key:"DEFAULTS",get:function(){return Object(r.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),u(t,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return"built"===this.buildState}},{key:"build",value:function(){var t=this,e=function(e,n){t.eventManager.addEventListener(e,n,function(e){return t.runLocalHooks(n,e,t)})};if(this.buildState||(this.buildState="building"),this.options.className&&Object(s.addClass)(this._element,this.options.className),this.options.children.length)Object(l.arrayEach)(this.options.children,function(e){return t._element.appendChild(e.element)});else if(this.options.wrapIt){var n=document.createElement(this.options.tagName);Object(r.objectEach)(this.options,function(t,e){void 0!==n[e]&&"className"!==e&&"tagName"!==e&&"children"!==e&&(n[e]=t)}),this._element.appendChild(n),Object(l.arrayEach)(c,function(t){return e(n,t)})}else Object(l.arrayEach)(c,function(n){return e(t._element,n)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return"building"===this.buildState?this._element:"built"===this.buildState?(this.update(),this._element):(this.buildState="building",this.build(),this.buildState="built",this._element)}}]),t}();Object(r.mixin)(h,i.a),e.a=h},function(t,e){t.exports=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(66),i=(n.n(r),n(0)),a=n(1),s=n(21),l=n(36),u=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=/^\$?[A-Z]+\$?\d+$/,f=/\$?[A-Z]+\$?\d+/,d=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,p=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,v=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,g=function(){function t(e){o(this,t),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof e&&this.setExpression(e)}return c(t,[{key:"setExpression",value:function(t){return this.cells.length=0,this.expression=Object(l.d)(t),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(t){this.customModifier=t}},{key:"translate",value:function(t){var e=this,n=t.row,o=t.column,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i.arrayEach)(this.cells,function(t){null!=n&&e._translateCell(t,"row",n,r.row),null!=o&&e._translateCell(t,"column",o,r.column)}),this}},{key:"toString",value:function(){var t=this,e=this.expression.replace(v,function(e,n,o){var i=-1===e.indexOf(":"),a=e,s=e,l=null;i&&(s=h.test(n)?n:o);var u=t._searchCell(s);return u&&(l=u.refError?Object(r.error)(r.ERROR_REF):u.toLabel(),a=i?e.replace(s,l):l),a});return e.startsWith("=")||(e="="+e),e}},{key:"_translateCell",value:function(t,e,n,o){var r=t.start,i=t.end,a=r[e].index,s=i[e].index,l=n,c=n,h=!1;if(this.customModifier){var f=this.customModifier(t,e,n,o),d=u(f,3);l=d[0],c=d[1],h=d[2]}else r[e].isAbsolute&&(l=0),i[e].isAbsolute&&(c=0);l&&!h&&(a+l<0&&(h=!0),r[e].index=Math.max(a+l,0)),c&&!h&&(s+c<0&&(h=!0),i[e].index=Math.max(s+c,0)),h&&(t.refError=!0)}},{key:"_extractCells",value:function(){var t=this,e=this.expression.match(d);e&&Object(i.arrayEach)(e,function(e){if(e=e.match(f)){var n=Object(r.extractLabel)(e[0]),o=u(n,2),i=o[0],a=o[1];t.cells.push(t._createCell({row:i,column:a},{row:i,column:a},e[0]))}})}},{key:"_extractCellsRange",value:function(){var t=this,e=this.expression.match(p);e&&Object(i.arrayEach)(e,function(e){var n=e.split(":"),o=u(n,2),i=o[0],a=o[1],s=Object(r.extractLabel)(i),l=u(s,2),c=l[0],h=l[1],f=Object(r.extractLabel)(a),d=u(f,2);t.cells.push(t._createCell({row:c,column:h},{row:d[0],column:d[1]},e))})}},{key:"_searchCell",value:function(t){var e=Object(i.arrayFilter)(this.cells,function(e){return e.origLabel===t});return u(e,1)[0]||null}},{key:"_createCell",value:function(t,e,n){return{start:t,end:e,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var t=Object(r.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(t+=":"+Object(r.toLabel)(this.end.row,this.end.column)),t}}}}]),t}();Object(a.mixin)(g,s.a),e.a=g},function(t,e){var n=Math.ceil,o=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?o:n)(t)}},function(t,e,n){var o=n(68),r=Math.max,i=Math.min;t.exports=function(t,e){return t=o(t),t<0?r(t+e,0):i(t,e)}},function(t,e,n){var o=n(37);t.exports=function(t,e,n){for(var r in e)o(t,r,e[r],n);return t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var o=n(39),r=n(166),i=n(167),a=n(20),s=n(27),l=n(168),u={},c={},e=t.exports=function(t,e,n,h,f){var d,p,v,g,y=f?function(){return t}:l(t),m=o(n,h,e?2:1),b=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(i(y)){for(d=s(t.length);d>b;b++)if((g=e?m(a(p=t[b])[0],p[1]):m(t[b]))===u||g===c)return g}else for(v=y.call(t);!(p=v.next()).done;)if((g=r(v,m,p.value,e))===u||g===c)return g};e.BREAK=u,e.RETURN=c},function(t,e){t.exports=!1},function(t,e,n){"use strict";var o=n(17),r=n(5),i=n(37),a=n(70),s=n(41),l=n(73),u=n(72),c=n(12),h=n(25),f=n(93),d=n(58),p=n(246);t.exports=function(t,e,n,v,g,y){var m=o[t],b=m,w=g?"set":"add",O=b&&b.prototype,C={},E=function(t){var e=O[t];i(O,t,"delete"==t?function(t){return!(y&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(y||O.forEach&&!h(function(){(new b).entries().next()}))){var S=new b,k=S[w](y?{}:-0,1)!=S,T=h(function(){S.has(1)}),R=f(function(t){new b(t)}),_=!y&&h(function(){for(var t=new b,e=5;e--;)t[w](e,e);return!t.has(-0)});R||(b=e(function(e,n){u(e,b,t);var o=p(new m,e,b);return void 0!=n&&l(n,g,o[w],o),o}),b.prototype=O,O.constructor=b),(T||_)&&(E("delete"),E("has"),g&&E("get")),(_||k)&&E(w),y&&O.clear&&delete O.clear}else b=v.getConstructor(e,t,g,w),a(b.prototype,n),s.NEED=!0;return d(b,t),C[t]=b,r(r.G+r.W+r.F*(b!=m),C),y||v.setStrong(b,t,g),b}},function(t,e,n){var o=n(59),r=n(56),i=n(26),a=n(87),s=n(32),l=n(162),u=Object.getOwnPropertyDescriptor;e.f=n(24)?u:function(t,e){if(t=i(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return r(!o.f.call(t,e),t[e])}},function(t,e,n){var o=n(39),r=n(89),i=n(40),a=n(27),s=n(247);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var v,g,y=i(e),m=r(y),b=o(s,p,3),w=a(m.length),O=0,C=n?d(e,w):l?d(e,0):void 0;w>O;O++)if((f||O in m)&&(v=m[O],g=b(v,O,y),t))if(n)C[O]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return O;case 2:C.push(v)}else if(c)return!1;return h?-1:u||c?c:C}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var o=n(38),r=n(37),i=n(25),a=n(46),s=n(16);t.exports=function(t,e,n){var l=s(t),u=n(a,l,""[t]),c=u[0],h=u[1];i(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,c),o(RegExp.prototype,l,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,n){"use strict";var o=n(51),r=n(172),i=n(57),a=n(26);t.exports=n(170)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";function o(t){for(var e=t+1,n="",o=void 0;e>0;)o=(e-1)%d,n=String.fromCharCode(65+o)+n,e=parseInt((e-o)/d,10);return n}function r(t){var e=0;if(t)for(var n=0,o=t.length-1;n<t.length;n+=1,o-=1)e+=Math.pow(d,o)*(f.indexOf(t[n])+1);return--e}function i(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=[];for(t=0;t<n;t++){var a=[];for(e=0;e<r;e++)a.push(o(e)+(t+1));i.push(a)}return i}function a(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=[];for(t=0;t<n;t++){var a={};for(e=0;e<r;e++)a["prop"+e]=o(e)+(t+1);i.push(a)}return i}function s(t,e){for(var n=[],o=void 0,r=0;r<t;r++){o=[];for(var i=0;i<e;i++)o.push("");n.push(o)}return n}function l(t){var e,n,o,r,i=[],a=0;for(e=0,n=t.length;e<n;e++)for(o=0,r=t[e].length;o<r;o++)o==a&&(i.push([]),a++),i[o].push(t[e][o]);return i}function u(t,e){return e=void 0===e||e,function(n,o){return function n(o){if(o){if(Object(h.hasOwnProperty)(o,t)&&void 0!==o[t])return o[t];if(Object(h.hasOwnProperty)(o,"type")&&o.type){var r;if("string"!=typeof o.type)throw new Error("Cell type must be a string ");if(r=Object(c.a)(o.type),Object(h.hasOwnProperty)(r,t))return r[t];if(e)return}return n(Object.getPrototypeOf(o))}}("number"==typeof n?this.getCellMeta(n,o):n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.spreadsheetColumnLabel=o,e.spreadsheetColumnIndex=r,e.createSpreadsheetData=i,e.createSpreadsheetObjectData=a,e.createEmptySpreadsheetData=s,e.translateRowsToColumns=l,e.cellMethodLookupFactory=u;var c=n(152),h=n(1),f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",d=f.length},function(t,e,n){"use strict";function o(t,e){var n=t;return Object(l.isObject)(t)&&(e=t,n=e.languageCode),a(n,e),p(n,Object(l.deepClone)(e)),Object(l.deepClone)(e)}function r(t){return i(t)?Object(l.deepClone)(v(t)):null}function i(t){return g(t)}function a(t,e){t!==f&&Object(u.b)(e,v(f))}function s(){return y()}n.d(e,"e",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"d",function(){return i}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return f});var l=n(1),u=n(207),c=n(47),h=n(308),f=h.a.languageCode,d=Object(c.a)("languagesDictionaries"),p=d.register,v=d.getItem,g=d.hasItem,y=d.getValues;o(h.a)},function(t,e,n){"use strict";function o(){return{name:r}}n.d(e,"a",function(){return r}),e.b=o;var r="---------"},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(1),a=n(21),s=n(395),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(){function t(e){o(this,t),this.hot=e,this.elements=[],this.hidden=!1}return l(t,[{key:"reset",value:function(){Object(r.arrayEach)(this.elements,function(t){return t.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),Object(r.arrayEach)(this.elements,function(t){return t.destroy()}),this.elements=null,this.hot=null}}]),t}();Object(i.mixin)(u,a.a),Object(i.mixin)(u,s.a),e.a=u},function(t,e,n){"use strict";var o=n(161),r=n(50);t.exports=n(75)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=o.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return o.def(r(this,"Map"),0===t?0:t,e)}},o,!0)},function(t,e,n){var o=n(12),r=n(17).document,i=o(r)&&o(r.createElement);t.exports=function(t){return i?r.createElement(t):{}}},function(t,e,n){var o=n(12);t.exports=function(t,e){if(!o(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!o(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!o(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!o(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var o=n(20),r=n(244),i=n(92),a=n(90)("IE_PROTO"),s=function(){},l=function(){var t,e=n(86)("iframe"),o=i.length;for(e.style.display="none",n(165).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;o--;)delete l.prototype[i[o]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=o(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var o=n(48);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==o(t)?t.split(""):Object(t)}},function(t,e,n){var o=n(91)("keys"),r=n(55);t.exports=function(t){return o[t]||(o[t]=r(t))}},function(t,e,n){var o=n(17),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var o=n(16)("iterator"),r=!1;try{var i=[7][o]();i.return=function(){r=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var i=[7],a=i[o]();a.next=function(){return{done:n=!0}},i[o]=function(){return a},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var o=n(161),r=n(50);t.exports=n(75)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(r(this,"Set"),t=0===t?0:t,t)}},o)},function(t,e,n){"use strict";var o,r=n(77)(0),i=n(37),a=n(41),s=n(176),l=n(177),u=n(12),c=n(25),h=n(50),f=a.getWeak,d=Object.isExtensible,p=l.ufstore,v={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(t){if(u(t)){var e=f(t);return!0===e?p(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},m=t.exports=n(75)("WeakMap",g,y,l,!0,!0);c(function(){return 7!=(new m).set((Object.freeze||Object)(v),7).get(v)})&&(o=l.getConstructor(g,"WeakMap"),s(o.prototype,y),a.NEED=!0,r(["delete","has","get","set"],function(t){var e=m.prototype,n=e[t];i(e,t,function(e,r){if(u(e)&&!d(e)){this._f||(this._f=new o);var i=this._f[t](e,r);return"set"==t?this:i}return n.call(this,e,r)})}))},function(t,e,n){"use strict";var o=n(177),r=n(50);n(75)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(r(this,"WeakSet"),t,!0)}},o,!1,!0)},function(t,e,n){"use strict";var o,r,i,a,s=n(74),l=n(17),u=n(39),c=n(169),h=n(5),f=n(12),d=n(71),p=n(72),v=n(73),g=n(249),y=n(98).set,m=n(251)(),b=n(178),w=n(252),O=n(253),C=l.TypeError,E=l.process,S=l.Promise,k="process"==c(E),T=function(){},R=r=b.f,_=!!function(){try{var t=S.resolve(1),e=(t.constructor={})[n(16)("species")]=function(t){t(T,T)};return(k||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e}catch(t){}}(),j=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},A=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var o=t._v,r=1==t._s,i=0;n.length>i;)!function(e){var n,i,a=r?e.ok:e.fail,s=e.resolve,l=e.reject,u=e.domain;try{a?(r||(2==t._h&&P(t),t._h=1),!0===a?n=o:(u&&u.enter(),n=a(o),u&&u.exit()),n===e.promise?l(C("Promise-chain cycle")):(i=j(n))?i.call(n,s,l):s(n)):l(o)}catch(t){l(t)}}(n[i++]);t._c=[],t._n=!1,e&&!t._h&&M(t)})}},M=function(t){y.call(l,function(){var e,n,o,r=t._v,i=H(t);if(i&&(e=w(function(){k?E.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(o=l.console)&&o.error&&o.error("Unhandled promise rejection",r)}),t._h=k||H(t)?2:1),t._a=void 0,i&&e.e)throw e.v})},H=function(t){return 1!==t._h&&0===(t._a||t._c).length},P=function(t){y.call(l,function(){var e;k?E.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},N=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},L=function t(e){var n,o=this;if(!o._d){o._d=!0,o=o._w||o;try{if(o===e)throw C("Promise can't be resolved itself");(n=j(e))?m(function(){var r={_w:o,_d:!1};try{n.call(e,u(t,r,1),u(N,r,1))}catch(t){N.call(r,t)}}):(o._v=e,o._s=1,A(o,!1))}catch(t){N.call({_w:o,_d:!1},t)}}};_||(S=function(t){p(this,S,"Promise","_h"),d(t),o.call(this);try{t(u(L,this,1),u(N,this,1))}catch(t){N.call(this,t)}},o=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},o.prototype=n(70)(S.prototype,{then:function(t,e){var n=R(g(this,S));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=k?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&A(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new o;this.promise=t,this.resolve=u(L,t,1),this.reject=u(N,t,1)},b.f=R=function(t){return t===S||t===a?new i(t):r(t)}),h(h.G+h.W+h.F*!_,{Promise:S}),n(58)(S,"Promise"),n(173)("Promise"),a=n(49).Promise,h(h.S+h.F*!_,"Promise",{reject:function(t){var e=R(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!_),"Promise",{resolve:function(t){return O(s&&this===a?S:this,t)}}),h(h.S+h.F*!(_&&n(93)(function(t){S.all(t).catch(T)})),"Promise",{all:function(t){var e=this,n=R(e),o=n.resolve,r=n.reject,i=w(function(){var n=[],i=0,a=1;v(t,!1,function(t){var s=i++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||o(n))},r)}),--a||o(n)});return i.e&&r(i.v),n.promise},race:function(t){var e=this,n=R(e),o=n.reject,r=w(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return r.e&&o(r.v),n.promise}})},function(t,e,n){var o,r,i,a=n(39),s=n(250),l=n(165),u=n(86),c=n(17),h=c.process,f=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,v=c.Dispatch,g=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},b=function(t){m.call(t.data)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++g]=function(){s("function"==typeof t?t:Function(t),e)},o(g),g},d=function(t){delete y[t]},"process"==n(48)(h)?o=function(t){h.nextTick(a(m,t,1))}:v&&v.now?o=function(t){v.now(a(m,t,1))}:p?(r=new p,i=r.port2,r.port1.onmessage=b,o=a(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(o=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):o="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:f,clear:d}},function(t,e,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(17),i=n(32),a=n(24),s=n(5),l=n(37),u=n(41).KEY,c=n(25),h=n(91),f=n(58),d=n(55),p=n(16),v=n(179),g=n(254),y=n(255),m=n(175),b=n(20),w=n(12),O=n(26),C=n(87),E=n(56),S=n(88),k=n(180),T=n(76),R=n(22),_=n(45),j=T.f,A=R.f,M=k.f,H=r.Symbol,P=r.JSON,N=P&&P.stringify,L=p("_hidden"),D=p("toPrimitive"),x={}.propertyIsEnumerable,I=h("symbol-registry"),F=h("symbols"),B=h("op-symbols"),W=Object.prototype,V="function"==typeof H,U=r.QObject,z=!U||!U.prototype||!U.prototype.findChild,G=a&&c(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,e,n){var o=j(W,e);o&&delete W[e],A(t,e,n),o&&t!==W&&A(W,e,o)}:A,X=function(t){var e=F[t]=S(H.prototype);return e._k=t,e},Y=V&&"symbol"==o(H.iterator)?function(t){return"symbol"==(void 0===t?"undefined":o(t))}:function(t){return t instanceof H},K=function(t,e,n){return t===W&&K(B,e,n),b(t),e=C(e,!0),b(n),i(F,e)?(n.enumerable?(i(t,L)&&t[L][e]&&(t[L][e]=!1),n=S(n,{enumerable:E(0,!1)})):(i(t,L)||A(t,L,E(1,{})),t[L][e]=!0),G(t,e,n)):A(t,e,n)},q=function(t,e){b(t);for(var n,o=y(e=O(e)),r=0,i=o.length;i>r;)K(t,n=o[r++],e[n]);return t},J=function(t,e){return void 0===e?S(t):q(S(t),e)},$=function(t){var e=x.call(this,t=C(t,!0));return!(this===W&&i(F,t)&&!i(B,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,L)&&this[L][t])||e)},Q=function(t,e){if(t=O(t),e=C(e,!0),t!==W||!i(F,e)||i(B,e)){var n=j(t,e);return!n||!i(F,e)||i(t,L)&&t[L][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=M(O(t)),o=[],r=0;n.length>r;)i(F,e=n[r++])||e==L||e==u||o.push(e);return o},tt=function(t){for(var e,n=t===W,o=M(n?B:O(t)),r=[],a=0;o.length>a;)!i(F,e=o[a++])||n&&!i(W,e)||r.push(F[e]);return r};V||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function e(n){this===W&&e.call(B,n),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),G(this,t,E(1,n))};return a&&z&&G(W,t,{configurable:!0,set:e}),X(t)},l(H.prototype,"toString",function(){return this._k}),T.f=Q,R.f=K,n(100).f=k.f=Z,n(59).f=$,n(78).f=tt,a&&!n(74)&&l(W,"propertyIsEnumerable",$,!0),v.f=function(t){return X(p(t))}),s(s.G+s.W+s.F*!V,{Symbol:H});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)p(et[nt++]);for(var ot=_(p.store),rt=0;ot.length>rt;)g(ot[rt++]);s(s.S+s.F*!V,"Symbol",{for:function(t){return i(I,t+="")?I[t]:I[t]=H(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in I)if(I[e]===t)return e},useSetter:function(){z=!0},useSimple:function(){z=!1}}),s(s.S+s.F*!V,"Object",{create:J,defineProperty:K,defineProperties:q,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),P&&s(s.S+s.F*(!V||c(function(){var t=H();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){for(var e,n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e=o[1],(w(e)||void 0!==t)&&!Y(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Y(e))return e}),o[1]=e,N.apply(P,o)}}),H.prototype[D]||n(38)(H.prototype,D,H.prototype.valueOf),f(H,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(t,e,n){var o=n(163),r=n(92).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,r)}},function(t,e,n){var o=n(12),r=n(41).onFreeze;n(28)("freeze",function(t){return function(e){return t&&o(e)?t(r(e)):e}})},function(t,e,n){var o=n(12),r=n(41).onFreeze;n(28)("seal",function(t){return function(e){return t&&o(e)?t(r(e)):e}})},function(t,e,n){var o=n(12),r=n(41).onFreeze;n(28)("preventExtensions",function(t){return function(e){return t&&o(e)?t(r(e)):e}})},function(t,e,n){var o=n(12);n(28)("isFrozen",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(12);n(28)("isSealed",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(12);n(28)("isExtensible",function(t){return function(e){return!!o(e)&&(!t||t(e))}})},function(t,e,n){var o=n(26),r=n(76).f;n(28)("getOwnPropertyDescriptor",function(){return function(t,e){return r(o(t),e)}})},function(t,e,n){var o=n(40),r=n(171);n(28)("getPrototypeOf",function(){return function(t){return r(o(t))}})},function(t,e,n){var o=n(40),r=n(45);n(28)("keys",function(){return function(t){return r(o(t))}})},function(t,e,n){n(28)("getOwnPropertyNames",function(){return n(180).f})},function(t,e,n){var o=n(5);o(o.S+o.F,"Object",{assign:n(176)})},function(t,e,n){var o=n(5);o(o.S,"Object",{is:n(256)})},function(t,e,n){var o=n(5);o(o.S,"Object",{setPrototypeOf:n(174).set})},function(t,e,n){var o=n(22).f,r=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in r||n(24)&&o(r,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},function(t,e,n){var o=n(5),r=n(26),i=n(27);o(o.S,"String",{raw:function(t){for(var e=r(t.raw),n=i(e.length),o=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<o&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){var o=n(5),r=n(69),i=String.fromCharCode,a=String.fromCodePoint;o(o.S+o.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],o=arguments.length,a=0;o>a;){if(e=+arguments[a++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?i(e):i(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){"use strict";var o=n(5),r=n(257)(!1);o(o.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){var o=n(5);o(o.P,"String",{repeat:n(181)})},function(t,e,n){"use strict";var o=n(5),r=n(27),i=n(120),a="".startsWith;o(o.P+o.F*n(121)("startsWith"),"String",{startsWith:function(t){var e=i(this,t,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),o=String(t);return a?a.call(e,o,n):e.slice(n,n+o.length)===o}})},function(t,e,n){var o=n(182),r=n(46);t.exports=function(t,e,n){if(o(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},function(t,e,n){var o=n(16)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[o]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){"use strict";var o=n(5),r=n(27),i=n(120),a="".endsWith;o(o.P+o.F*n(121)("endsWith"),"String",{endsWith:function(t){var e=i(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,o=r(e.length),s=void 0===n?o:Math.min(r(n),o),l=String(t);return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,n){"use strict";var o=n(5),r=n(120);o(o.P+o.F*n(121)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){n(24)&&"g"!=/./g.flags&&n(22).f(RegExp.prototype,"flags",{configurable:!0,get:n(258)})},function(t,e,n){n(79)("match",1,function(t,e,n){return[function(n){"use strict";var o=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,o):new RegExp(n)[e](String(o))},n]})},function(t,e,n){n(79)("replace",2,function(t,e,n){return[function(o,r){"use strict";var i=t(this),a=void 0==o?void 0:o[e];return void 0!==a?a.call(o,i,r):n.call(String(i),o,r)},n]})},function(t,e,n){n(79)("split",2,function(t,e,o){"use strict";var r=n(182),i=o,a=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var l=void 0===/()??/.exec("")[1];o=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!r(t))return i.call(n,t,e);var o,u,c,h,f,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=void 0===e?4294967295:e>>>0,y=new RegExp(t.source,p+"g");for(l||(o=new RegExp("^"+y.source+"$(?!\\s)",p));(u=y.exec(n))&&!((c=u.index+u[0][s])>v&&(d.push(n.slice(v,u.index)),!l&&u[s]>1&&u[0].replace(o,function(){for(f=1;f<arguments[s]-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u[s]>1&&u.index<n[s]&&a.apply(d,u.slice(1)),h=u[0][s],v=c,d[s]>=g));)y.lastIndex===u.index&&y.lastIndex++;return v===n[s]?!h&&y.test("")||d.push(""):d.push(n.slice(v)),d[s]>g?d.slice(0,g):d}}else"0".split(void 0,0)[s]&&(o=function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)});return[function(n,r){var i=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,i,r):o.call(String(i),n,r)},o]})},function(t,e,n){n(79)("search",1,function(t,e,n){return[function(n){"use strict";var o=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,o):new RegExp(n)[e](String(o))},n]})},function(t,e,n){"use strict";var o=n(39),r=n(5),i=n(40),a=n(166),s=n(167),l=n(27),u=n(130),c=n(168);r(r.S+r.F*!n(93)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,h,f=i(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,y=0,m=c(f);if(g&&(v=o(v,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&s(m))for(e=l(f.length),n=new d(e);e>y;y++)u(n,y,g?v(f[y],y):f[y]);else for(h=m.call(f),n=new d;!(r=h.next()).done;y++)u(n,y,g?a(h,v,[r.value,y],!0):r.value);return n.length=y,n}})},function(t,e,n){"use strict";var o=n(22),r=n(56);t.exports=function(t,e,n){e in t?o.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){"use strict";var o=n(5),r=n(130);o(o.S+o.F*n(25)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){var o=n(5);o(o.P,"Array",{copyWithin:n(259)}),n(51)("copyWithin")},function(t,e,n){"use strict";var o=n(5),r=n(77)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),o(o.P+o.F*i,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(51)("find")},function(t,e,n){"use strict";var o=n(5),r=n(77)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),o(o.P+o.F*a,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(51)(i)},function(t,e,n){var o=n(5);o(o.P,"Array",{fill:n(260)}),n(51)("fill")},function(t,e,n){var o=n(5),r=n(17).isFinite;o(o.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var o=n(5);o(o.S,"Number",{isInteger:n(183)})},function(t,e,n){var o=n(5),r=n(183),i=Math.abs;o(o.S,"Number",{isSafeInteger:function(t){return r(t)&&i(t)<=9007199254740991}})},function(t,e,n){var o=n(5);o(o.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var o=n(5);o(o.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var o=n(5);o(o.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var o=n(5);o(o.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){"use strict";var o=n(5),r=n(164)(!0);o(o.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(51)("includes")},function(t,e,n){var o=n(5),r=n(184)(!1);o(o.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var o=n(5),r=n(184)(!0);o(o.S,"Object",{entries:function(t){return r(t)}})},function(t,e,n){var o=n(5),r=n(261),i=n(26),a=n(76),s=n(130);o(o.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,o=i(t),l=a.f,u=r(o),c={},h=0;u.length>h;)void 0!==(n=l(o,e=u[h++]))&&s(c,e,n);return c}})},function(t,e,n){"use strict";var o=n(5),r=n(185);o(o.P+o.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(n(186)),"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var o=n(5),r=n(185);o(o.P+o.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(n(186)),"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){var o=n(5),r=n(98);o(o.G+o.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){for(var o=n(80),r=n(45),i=n(37),a=n(17),s=n(38),l=n(57),u=n(16),c=u("iterator"),h=u("toStringTag"),f=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(d),v=0;v<p.length;v++){var g,y=p[v],m=d[y],b=a[y],w=b&&b.prototype;if(w&&(w[c]||s(w,c,f),w[h]||s(w,h,y),l[y]=f,m))for(g in o)w[g]||i(w,g,o[g],!0)}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(60),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;o(this,t),this.highlight=e,this.from=n,this.to=r}return i(t,[{key:"setHighlight",value:function(t){return this.highlight=t,this}},{key:"setFrom",value:function(t){return this.from=t,this}},{key:"setTo",value:function(t){return this.to=t,this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var e=t.row,n=t.col,o=this.getTopLeftCorner(),r=this.getBottomRightCorner();return o.row<=e&&r.row>=e&&o.col<=n&&r.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=new r.a(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=new r.a(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=this.getDirection(),i=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=Math.min(e.row,i.row),l=Math.min(e.col,i.col),u=Math.max(n.row,a.row),c=Math.max(n.col,a.col),h=new r.a(s,l),f=new r.a(u,c);return this.from=h,this.to=f,this.setDirection(o),this.highlight.row===this.getBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var o=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var r=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=r[0],this.to=r[1]}}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new r.a(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new r.a(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new r.a(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new r.a(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getTopLeftCorner().isEqual(new r.a(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new r.a(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new r.a(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new r.a(e.to.row,e.to.col))))||t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof r.a))return!1;if(e&&e.includes(t)){if(this.getTopLeftCorner().isEqual(new r.a(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r.a(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r.a(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r.a(e.to.row,e.to.col)))return this.getTopLeftCorner()}return t.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():t.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():t.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():t.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return e.top==n.top&&o.push("top"),e.right==n.right&&o.push("right"),e.bottom==n.bottom&&o.push("bottom"),e.left==n.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],o=t.row;o<=e.row;o++)for(var i=t.col;i<=e.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(new r.a(o,i));return n}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],o=t.row;o<=e.row;o++)for(var i=t.col;i<=e.col;i++)n.push(t.row===o&&t.col===i?t:e.row===o&&e.col===i?e:new r.a(o,i));return n}},{key:"forAll",value:function(t){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=e.row;o<=n.row;o++)for(var r=e.col;r<=n.col;r++){var i=t(o,r);if(!1===i)return}}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),t}()},function(t,e,n){"use strict";function o(t){if(!O(t))throw Error('You declared cell type "'+t+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return w(t)}function r(t,e){var n=e.editor,o=e.renderer,r=e.validator;n&&Object(a.d)(t,n),o&&Object(s.c)(t,o),r&&Object(l.c)(t,r),b(t,e)}n.d(e,"c",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return C});var i=n(47),a=n(19),s=n(15),l=n(35),u=n(293),c=n(294),h=n(295),f=n(296),d=n(297),p=n(298),v=n(299),g=n(300),y=n(301),m=Object(i.a)("cellTypes"),b=m.register,w=m.getItem,O=m.hasItem,C=m.getNames;r("autocomplete",u.a),r("checkbox",c.a),r("date",h.a),r("dropdown",f.a),r("handsontable",d.a),r("numeric",p.a),r("password",v.a),r("text",g.a),r("time",y.a)},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){function n(t){var e=Object(M.c)(t);Object(A.d)(e)?(J.runHooks("beforeLanguageChange",e),$.prototype.language=e,J.runHooks("afterLanguageChange",e)):Object(M.d)(t)}function r(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(t){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==t&&(t=!0,this.onQueueEmpty(this.valid))}}}function x(t){var e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function I(t,e,n){function o(){var o;t.length&&(o=J.runHooks("beforeChange",t,e),Object(s.isFunction)(o)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===o&&t.splice(0,t.length)),n()}var a=new r;a.onQueueEmpty=o;for(var l=t.length-1;l>=0;l--)if(null===t[l])t.splice(l,1);else{var u=L(t[l],4),c=u[0],h=u[1],f=u[3],d=z.propToCol(h),p=J.getCellMeta(c,d);"numeric"===p.type&&"string"==typeof f&&function(t){return t.length>0&&/^-?[\d\s]*(\.|,)?\d*$/.test(t)}(f)&&(t[l][3]=x(f)),J.getCellValidator(p)&&(a.addValidatorToQueue(),J.validateCell(t[l][3],p,function(e,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){t.splice(e,1),n.valid=!0;var r=J.getCell(n.visualRow,n.visualCol);Object(i.removeClass)(r,J.getSettings().invalidCellClassName),--e}a.removeValidatorFormQueue()}}(l,p),e))}a.checkIfQueueIsEmpty()}function F(t,e){var n=t.length-1;if(!(n<0)){for(;n>=0;n--){var o=!1;if(null!==t[n]){if(null!=t[n][2]||null!=t[n][3]){if(U.settings.allowInsertRow)for(;t[n][0]>J.countRows()-1;){var r=z.createRow(void 0,void 0,e);if(0===r){o=!0;break}}if(!o){if("array"===J.dataType&&(!U.settings.columns||0===U.settings.columns.length)&&U.settings.allowInsertColumn)for(;z.propToCol(t[n][1])>J.countCols()-1;)z.createCol(void 0,void 0,e);z.set(t[n][0],t[n][1],t[n][3])}}}else t.splice(n,1)}J.forceFullRender=!0,X.adjustRowsAndCols(),J.runHooks("beforeChangeRender",t,e),J._refreshBorders(null,!0),J.view.wt.wtOverlays.adjustElementsSize(),J.runHooks("afterChange",t,e||"edit");var i=J.getActiveEditor();i&&Object(l.isDefined)(i.refreshValue)&&i.refreshValue()}}function B(t,e,n){return"object"===(void 0===t?"undefined":N(t))?t:[[t,e,n]]}function W(t){if(Object(d.hasOwnProperty)(t,"type")){var e,n={};"object"===N(t.type)?e=t.type:"string"==typeof t.type&&(e=Object(_.a)(t.type));for(var o in e)Object(d.hasOwnProperty)(e,o)&&!Object(d.hasOwnProperty)(t,o)&&(n[o]=e[o]);return n}}function V(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var U,z,G,X,Y,K=this,q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],J=this,$=function(){},Q=new f.a(J);Object(d.extend)($.prototype,R.a.prototype),Object(d.extend)($.prototype,e),Object(d.extend)($.prototype,W(e)),Object(M.a)($.prototype,e.language),Object(S.a)(q)&&Object(S.c)(this),Object(H.b)(),this.rootElement=t,this.isHotTableEnv=Object(i.isChildOfWebComponentTable)(this.rootElement),f.a.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Object(S.b)(this)&&Object(l._injectProductInfo)(e.licenseKey,t),this.guid="ht_"+Object(m.randomString)();var Z=Object(E.a)(J);G=new O.a(J),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),U={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new $,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};var tt=new P.a(U.settings,{countCols:function(){return J.countCols()},countRows:function(){return J.countRows()},isEditorOpened:function(){return!!J.getActiveEditor()&&J.getActiveEditor().isOpened()}});this.selection=tt,this.selection.addLocalHook("beforeSetRangeStart",function(t){K.runHooks("beforeSetRangeStart",t)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(t){K.runHooks("beforeSetRangeStartOnly",t)}),this.selection.addLocalHook("beforeSetRangeEnd",function(t){K.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=K.view.wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=K.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(t,e,n){var o=Object(d.createObjectPropListener)(!1),r=K.selection.getSelectedRange(),a=r.current(),s=a.from,l=a.to,u=r.size()-1;K.runHooks("afterSelection",s.row,s.col,l.row,l.col,o,u),K.runHooks("afterSelectionByProp",s.row,J.colToProp(s.col),l.row,J.colToProp(l.col),o,u);var c=!1,h=!0;(K.selection.selectedHeader.cols||K.selection.selectedHeader.rows)&&(c=!0),(t.row<0||t.col<0)&&(h=!1),o.isTouched()&&(e=!o.value),!1!==e&&!c&&h&&K.view.scrollViewport(K.selection.selectedRange.current().from&&!K.selection.isMultiple()?K.selection.selectedRange.current().from:t),K.selection.selectedHeader.rows&&K.selection.selectedHeader.cols?Object(i.addClass)(K.rootElement,["ht__selection--rows","ht__selection--columns"]):K.selection.selectedHeader.rows?(Object(i.removeClass)(K.rootElement,"ht__selection--columns"),Object(i.addClass)(K.rootElement,"ht__selection--rows")):K.selection.selectedHeader.cols?(Object(i.removeClass)(K.rootElement,"ht__selection--rows"),Object(i.addClass)(K.rootElement,"ht__selection--columns")):Object(i.removeClass)(K.rootElement,["ht__selection--rows","ht__selection--columns"]),K._refreshBorders(null,n)}),this.selection.addLocalHook("afterSelectionFinished",function(t){var e=t.length-1,n=t[e],o=n.from,r=n.to;K.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,e),K.runHooks("afterSelectionEndByProp",o.row,J.colToProp(o.col),r.row,J.colToProp(r.col),e)}),this.selection.addLocalHook("afterIsMultipleSelection",function(t){var e=K.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)}),this.selection.addLocalHook("beforeModifyTransformStart",function(t){K.runHooks("modifyTransformStart",t)}),this.selection.addLocalHook("afterModifyTransformStart",function(t,e,n){K.runHooks("afterModifyTransformStart",t,e,n)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(t){K.runHooks("modifyTransformEnd",t)}),this.selection.addLocalHook("afterModifyTransformEnd",function(t,e,n){K.runHooks("afterModifyTransformEnd",t,e,n)}),this.selection.addLocalHook("afterDeselect",function(t,e,n){Y.destroyEditor(),K._refreshBorders(),Object(i.removeClass)(K.rootElement,["ht__selection--rows","ht__selection--columns"]),K.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(t){K.alter("insert_row",t,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(t){K.alter("insert_col",t,1,"auto")}),X={alter:function(t,e,n,r,i){function a(t,e,n,r){var i=function(){var t=void 0;return"array"===r?t=[]:"object"===r&&(t={}),t},a=Object(p.arrayMap)(new Array(n),function(){return i()});a.unshift(e,0),t.splice.apply(t,o(a))}var s;n=n||1;var u=function(t){if(0===t.length)return[];var e=[].concat(o(t));return e.sort(function(t,e){var n=L(t,1),o=n[0],r=L(e,1),i=r[0];return o===i?0:o>i?1:-1}),Object(p.arrayReduce)(e,function(t,e){var n=L(e,2),o=n[0],r=n[1],i=t[t.length-1],a=L(i,2),s=a[0],l=a[1],u=s+l;return o<=u?i[1]+=Math.max(r-(u-o),0):t.push([o,r]),t},[e[0]])};switch(t){case"insert_row":var c=J.countSourceRows();if(J.getSettings().maxRows===c)return;e=Object(l.isDefined)(e)?e:c,s=z.createRow(e,n,r),a(U.cellSettings,e,n,"array"),s&&(tt.isSelected()&&tt.selectedRange.current().from.row>=e?(tt.selectedRange.current().from.row+=s,tt.transformEnd(s,0)):J._refreshBorders());break;case"insert_col":s=z.createCol(e,n,r);for(var h=0,f=J.countSourceRows();h<f;h++)U.cellSettings[h]&&a(U.cellSettings[h],e,n);if(s){if(Array.isArray(J.getSettings().colHeaders)){var d=[e,0];d.length+=s,Array.prototype.splice.apply(J.getSettings().colHeaders,d)}tt.isSelected()&&tt.selectedRange.current().from.col>=e?(tt.selectedRange.current().from.col+=s,tt.transformEnd(0,s)):J._refreshBorders()}break;case"remove_row":;(function(t){var e=0;Object(p.arrayEach)(t,function(t){var n=L(t,2),o=n[0],i=n[1],a=Object(l.isEmpty)(o)?J.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0)),z.removeRow(o,i,r),U.cellSettings.splice(a,i);var s=J.countRows(),u=J.getSettings().fixedRowsTop;u>=a+1&&(J.getSettings().fixedRowsTop-=Math.min(i,u-a));var c=J.getSettings().fixedRowsBottom;c&&a>=s-c&&(J.getSettings().fixedRowsBottom-=Math.min(i,c)),e+=i})})(Array.isArray(e)?u(e):[[e,n]]),X.adjustRowsAndCols(),J._refreshBorders();break;case"remove_col":;(function(t){var e=0;Object(p.arrayEach)(t,function(t){var n=L(t,2),o=n[0],i=n[1],a=Object(l.isEmpty)(o)?J.countCols()-1:Math.max(o-e,0),s=Z.toPhysicalColumn(a);Number.isInteger(o)&&(o=Math.max(o-e,0)),z.removeCol(o,i,r);for(var u=0,c=J.countSourceRows();u<c;u++)U.cellSettings[u]&&U.cellSettings[u].splice(s,i);var h=J.getSettings().fixedColumnsLeft;h>=a+1&&(J.getSettings().fixedColumnsLeft-=Math.min(i,h-a)),Array.isArray(J.getSettings().colHeaders)&&(void 0===s&&(s=-1),J.getSettings().colHeaders.splice(s,i)),e+=i})})(Array.isArray(e)?u(e):[[e,n]]),X.adjustRowsAndCols(),J._refreshBorders();break;default:throw new Error('There is no such action "'+t+'"')}i||X.adjustRowsAndCols()},adjustRowsAndCols:function(){if(U.settings.minRows){var t=J.countRows();if(t<U.settings.minRows)for(var e=0,n=U.settings.minRows;e<n-t;e++)z.createRow(J.countRows(),1,"auto")}if(U.settings.minSpareRows){var o=J.countEmptyRows(!0);if(o<U.settings.minSpareRows)for(;o<U.settings.minSpareRows&&J.countSourceRows()<U.settings.maxRows;o++)z.createRow(J.countRows(),1,"auto")}var r=void 0;if((U.settings.minCols||U.settings.minSpareCols)&&(r=J.countEmptyCols(!0)),U.settings.minCols&&!U.settings.columns&&J.countCols()<U.settings.minCols)for(;J.countCols()<U.settings.minCols;r++)z.createCol(J.countCols(),1,"auto");if(U.settings.minSpareCols&&!U.settings.columns&&"array"===J.dataType&&r<U.settings.minSpareCols)for(;r<U.settings.minSpareCols&&J.countCols()<U.settings.maxCols;r++)z.createCol(J.countCols(),1,"auto");var i=J.countRows(),a=J.countCols();0!==i&&0!==a||tt.deselect(),tt.isSelected()&&Object(p.arrayEach)(tt.selectedRange,function(t){var e=!1,n=t.from.row,o=t.from.col,r=t.to.row,s=t.to.col;n>i-1?(n=i-1,e=!0,r>n&&(r=n)):r>i-1&&(r=i-1,e=!0,n>r&&(n=r)),o>a-1?(o=a-1,e=!0,s>o&&(s=o)):s>a-1&&(s=a-1,e=!0,o>s&&(o=s)),e&&J.selectCell(n,o,r,s)}),J.view&&J.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(t,e,n,r,i,a,s){var u,c,h,f,p=[],v={};if(0===(c=e.length))return!1;var g,y,m,b;switch(i){case"shift_down":for(g=n?n.col-t.col+1:0,y=n?n.row-t.row+1:0,e=Object(C.translateRowsToColumns)(e),h=0,f=e.length,m=Math.max(f,g);h<m;h++)if(h<f){var w;for(u=0,c=e[h].length;u<y-c;u++)e[h].push(e[h][u%c]);e[h].unshift(t.col+h,t.row,0),(w=J).spliceCol.apply(w,o(e[h]))}else{var O;e[h%f][0]=t.col+h,(O=J).spliceCol.apply(O,o(e[h%f]))}break;case"shift_right":for(g=n?n.col-t.col+1:0,y=n?n.row-t.row+1:0,u=0,c=e.length,b=Math.max(c,y);u<b;u++)if(u<c){var E;for(h=0,f=e[u].length;h<g-f;h++)e[u].push(e[u][h%f]);e[u].unshift(t.row+u,t.col,0),(E=J).spliceRow.apply(E,o(e[u]))}else{var S;e[u%c][0]=t.row+u,(S=J).spliceRow.apply(S,o(e[u%c]))}break;case"overwrite":default:v.row=t.row,v.col=t.col;var k={row:n&&t?n.row-t.row+1:1,col:n&&t?n.col-t.col+1:1},T=0,R=0,_=!0,j=void 0,A=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e[t%e.length];return null!==n?o[n%o.length]:o},M=e.length,H=n?n.row-t.row+1:0;for(c=n?H:Math.max(M,H),u=0;u<c&&!(n&&v.row>n.row&&H>M||!U.settings.allowInsertRow&&v.row>J.countRows()-1||v.row>=U.settings.maxRows);u++){var P=u-T,L=A(P).length,D=n?n.col-t.col+1:0;if(f=n?D:Math.max(L,D),v.col=t.col,j=J.getCellMeta(v.row,v.col),"CopyPaste.paste"!==r&&"Autofill.autofill"!==r||!j.skipRowOnPaste){for(R=0,h=0;h<f&&!(n&&v.col>n.col&&D>L||!U.settings.allowInsertColumn&&v.col>J.countCols()-1||v.col>=U.settings.maxCols);h++)if(j=J.getCellMeta(v.row,v.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!j.skipColumnOnPaste)if(j.readOnly)v.col++;else{var x=h-R,I=A(P,x),F=J.getDataAtCell(v.row,v.col),B={row:P,col:x};if("Autofill.fill"===r){var W=J.runHooks("beforeAutofillInsidePopulate",B,a,e,s,{},k);W&&(I=Object(l.isUndefined)(W.value)?I:W.value)}if(null!==I&&"object"===(void 0===I?"undefined":N(I)))if(null===F||"object"!==(void 0===F?"undefined":N(F)))_=!1;else{var V=Object(d.duckSchema)(F[0]||F),z=Object(d.duckSchema)(I[0]||I);Object(d.isObjectEquals)(V,z)?I=Object(d.deepClone)(I):_=!1}else null!==F&&"object"===(void 0===F?"undefined":N(F))&&(_=!1);_&&p.push([v.row,v.col,I]),_=!0,v.col++}else R++,v.col++,f++;v.row++}else T++,v.row++,c++}J.setDataAtCell(p,null,null,r||"populateFromArray")}}},this.init=function(){G.setData(U.settings.data),J.runHooks("beforeInit"),Object(u.isMobileBrowser)()&&Object(i.addClass)(J.rootElement,"mobile"),this.updateSettings(U.settings,!0),this.view=new w.a(this),Y=new h.a(J,U,tt,z),this.forceFullRender=!0,J.runHooks("init"),this.view.render(),"object"===N(U.firstRun)&&(J.runHooks("afterChange",U.firstRun[0],U.firstRun[1]),U.firstRun=!1),J.runHooks("afterInit")},this.validateCell=function(t,e,n,o){function r(t){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!0===e.hidden)return void n(t);var o=e.visualCol,r=e.visualRow,i=J.getCell(r,o,!0);i&&"TH"!=i.nodeName&&J.view.wt.wtSettings.settings.cellRenderer(r,o,i),n(t)}var i=J.getCellValidator(e);Object(l.isRegExp)(i)&&(i=function(t){return function(e,n){n(t.test(e))}}(i)),Object(s.isFunction)(i)?(t=J.runHooks("beforeValidate",t,e.visualRow,e.prop,o),J._registerTimeout(setTimeout(function(){i.call(e,t,function(n){n=J.runHooks("afterValidate",n,t,e.visualRow,e.prop,o),e.valid=n,r(n),J.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,o)})},0))):J._registerTimeout(setTimeout(function(){e.valid=!0,r(e.valid,!1)},0))},this.setDataAtCell=function(t,e,n,o){var r,i,a,s=B(t,e,n),l=[];for(r=0,i=s.length;r<i;r++){if("object"!==N(s[r]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof s[r][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");a=z.colToProp(s[r][1]),l.push([s[r][0],a,G.getAtCell(Z.toPhysicalRow(s[r][0]),s[r][1]),s[r][2]])}o||"object"!==(void 0===t?"undefined":N(t))||(o=e),J.runHooks("afterSetDataAtCell",l,o),I(l,o,function(){F(l,o)})},this.setDataAtRowProp=function(t,e,n,o){var r,i,a=B(t,e,n),s=[];for(r=0,i=a.length;r<i;r++)s.push([a[r][0],a[r][1],G.getAtCell(Z.toPhysicalRow(a[r][0]),a[r][1]),a[r][2]]);o||"object"!==(void 0===t?"undefined":N(t))||(o=e),J.runHooks("afterSetDataAtRowProp",s,o),I(s,o,function(){F(s,o)})},this.listen=function(){if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var t=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;document.activeElement&&document.activeElement!==document.body&&!t?document.activeElement.blur():t&&document.body.focus()}J&&!J.isListening()&&(D=J.guid,J.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(D=null,J.runHooks("afterUnlisten"))},this.isListening=function(){return D===J.guid},this.destroyEditor=function(t){J._refreshBorders(t)},this.populateFromArray=function(t,e,n,o,r,i,a,s,l){var u;if("object"!==(void 0===n?"undefined":N(n))||"object"!==N(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");return u="number"==typeof o?new k.a(o,r):null,X.populateFromArray(new k.a(t,e),n,u,i,a,s,l)},this.spliceCol=function(t,e,n){var o;return(o=z).spliceCol.apply(o,arguments)},this.spliceRow=function(t,e,n){var o;return(o=z).spliceRow.apply(o,arguments)},this.getSelected=function(){if(tt.isSelected())return Object(p.arrayMap)(tt.getSelectedRange(),function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]})},this.getSelectedLast=function(){var t=this.getSelected(),e=void 0;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(tt.isSelected())return Array.from(tt.getSelectedRange())},this.getSelectedRangeLast=function(){var t=this.getSelectedRange(),e=void 0;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(){var t=this;if(tt.isSelected()){var e=[];Object(p.arrayEach)(tt.getSelectedRange(),function(n){var o=n.getTopLeftCorner(),r=n.getBottomRightCorner();Object(b.rangeEach)(o.row,r.row,function(n){Object(b.rangeEach)(o.col,r.col,function(o){t.getCellMeta(n,o).readOnly||e.push([n,o,""])})})}),e.length>0&&this.setDataAtCell(e)}},this.render=function(){J.view&&(J.renderCall=!0,J.forceFullRender=!0,J._refreshBorders(null,!0))},this.loadData=function(t){if(J.dataType=Array.isArray(U.settings.dataSchema)?"array":Object(s.isFunction)(U.settings.dataSchema)?"function":"object",z&&z.destroy(),z=new c.a(J,U,$),"object"===(void 0===t?"undefined":N(t))&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays ("+(void 0===t?"undefined":N(t))+" given)");t=[];var e,n=0,o=0,r=z.getSchema();for(n=0,o=U.settings.startRows;n<o;n++)if("object"!==J.dataType&&"function"!==J.dataType||!U.settings.dataSchema)if("array"===J.dataType)e=Object(d.deepClone)(r[0]),t.push(e);else{e=[];for(var i=0,a=U.settings.startCols;i<a;i++)e.push(null);t.push(e)}else e=Object(d.deepClone)(r),t.push(e)}U.isPopulated=!1,$.prototype.data=t,Array.isArray(t[0])&&(J.dataType="array"),z.dataSource=t,G.data=t,G.dataType=J.dataType,G.colToProp=z.colToProp.bind(z),G.propToCol=z.propToCol.bind(z),function(){U.cellSettings.length=0}(),X.adjustRowsAndCols(),J.runHooks("afterLoadData",U.firstRun),U.firstRun?U.firstRun=[null,"loadData"]:(J.runHooks("afterChange",null,"loadData"),J.render()),U.isPopulated=!0},this.getData=function(t,e,n,o){return Object(l.isUndefined)(t)?z.getAll():z.getRange(new k.a(t,e),new k.a(n,o),z.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return z.getCopyableText(new k.a(t,e),new k.a(n,o))},this.getCopyableData=function(t,e){return z.getCopyable(t,z.colToProp(e))},this.getSchema=function(){return z.getSchema()},this.updateSettings=function(t,e){var o=!1,r=void 0,u=void 0,c=void 0;if(Object(l.isDefined)(t.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(l.isDefined)(t.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(r in t)"data"!==r&&("language"!==r?T.a.getSingleton().getRegistered().indexOf(r)>-1?(Object(s.isFunction)(t[r])||Array.isArray(t[r]))&&(t[r].initialHook=!0,J.addHook(r,t[r])):!e&&Object(d.hasOwnProperty)(t,r)&&($.prototype[r]=t[r]):n(t.language));void 0===t.data&&void 0===U.settings.data?J.loadData(null):void 0!==t.data?J.loadData(t.data):void 0!==t.columns&&z.createMap(),c=J.countCols();var h=t.columns||$.prototype.columns;if(h&&Object(s.isFunction)(h)&&(c=J.countSourceCols(),o=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||(U.cellSettings.length=0),c>0){var f=void 0,p=void 0;for(r=0,u=0;r<c;r++)o&&!h(r)||(U.columnSettings[u]=Object(a.columnFactory)($,U.columnsSettingConflicts),f=U.columnSettings[u].prototype,h&&(p=o?h(r):h[u])&&(Object(d.extend)(f,p),Object(d.extend)(f,W(p))),u++)}if(Object(l.isDefined)(t.cell))for(var v in t.cell)if(Object(d.hasOwnProperty)(t.cell,v)){var g=t.cell[v];J.setCellMetaObject(g.row,g.col,g)}J.runHooks("afterCellMetaReset"),Object(l.isDefined)(t.className)&&($.prototype.className&&Object(i.removeClass)(J.rootElement,$.prototype.className),t.className&&Object(i.addClass)(J.rootElement,t.className));var y=J.rootElement.style.height;""!==y&&(y=parseInt(J.rootElement.style.height,10));var m=t.height;if(Object(s.isFunction)(m)&&(m=m()),e&&J.rootElement.getAttribute("style")&&J.rootElement.setAttribute("data-initialstyle",J.rootElement.getAttribute("style")),null===m){var b=J.rootElement.getAttribute("data-initialstyle");b&&(b.indexOf("height")>-1||b.indexOf("overflow")>-1)?J.rootElement.setAttribute("style",b):(J.rootElement.style.height="",J.rootElement.style.overflow="")}else void 0!==m&&(J.rootElement.style.height=m+"px",J.rootElement.style.overflow="hidden");if(void 0!==t.width){var w=t.width;Object(s.isFunction)(w)&&(w=w()),J.rootElement.style.width=w+"px"}e||(z.clearLengthCache(),J.view&&J.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),J.runHooks("afterUpdateSettings",t)),X.adjustRowsAndCols(),J.view&&!U.firstRun&&(J.forceFullRender=!0,J._refreshBorders(null,!0)),e||!J.view||""!==y&&""!==m&&void 0!==m||y===m||J.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=J.getSelectedLast();if($.prototype.getValue){if(Object(s.isFunction)($.prototype.getValue))return $.prototype.getValue.call(J);if(t)return J.getData()[t[0][0]][$.prototype.getValue]}else if(t)return J.getDataAtCell(t[0],t[1])},this.getSettings=function(){return U.settings},this.clear=function(){tt.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,o,r){X.alter(t,e,n,o,r)},this.getCell=function(t,e,n){return J.view.getCellAtCoords(new k.a(t,e),n)},this.getCoords=function(t){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,t)},this.colToProp=function(t){return z.colToProp(t)},this.propToCol=function(t){return z.propToCol(t)},this.toVisualRow=function(t){return Z.toVisualRow(t)},this.toVisualColumn=function(t){return Z.toVisualColumn(t)},this.toPhysicalRow=function(t){return Z.toPhysicalRow(t)},this.toPhysicalColumn=function(t){return Z.toPhysicalColumn(t)},this.getDataAtCell=function(t,e){return z.get(t,z.colToProp(e))},this.getDataAtRowProp=function(t,e){return z.get(t,e)},this.getDataAtCol=function(t){var e=[];return e.concat.apply(e,o(z.getRange(new k.a(0,t),new k.a(U.settings.data.length-1,t),z.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=[];return e=z.getRange(new k.a(0,z.propToCol(t)),new k.a(U.settings.data.length-1,z.propToCol(t)),z.DESTINATION_RENDERER),n.concat.apply(n,o(e))},this.getSourceData=function(t,e,n,o){return void 0===t?G.getData():G.getByRange(new k.a(t,e),new k.a(n,o))},this.getSourceDataArray=function(t,e,n,o){return void 0===t?G.getData(!0):G.getByRange(new k.a(t,e),new k.a(n,o),!0)},this.getSourceDataAtCol=function(t){return G.getAtColumn(t)},this.getSourceDataAtRow=function(t){return G.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return G.getAtCell(t,e)},this.getDataAtRow=function(t){return z.getRange(new k.a(t,0),new k.a(t,this.countCols()-1),z.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,o){var r=this,i=null,a=null;void 0===t&&(t=0,n=this.countRows(),e=0,o=this.countCols()),void 0===n&&(n=t),void 0===o&&(o=e);var s="mixed";return Object(b.rangeEach)(Math.min(t,n),Math.max(t,n),function(t){var n=!0;return Object(b.rangeEach)(Math.min(e,o),Math.max(e,o),function(e){var o=r.getCellMeta(t,e);return a=o.type,i?n=i===a:i=a,n}),s=n?a:"mixed",n}),s},this.removeCellMeta=function(t,e,n){var o=Z.toPhysical(t,e),r=L(o,2),i=r[0],a=r[1],s=U.cellSettings[i][a][n];!1!==J.runHooks("beforeRemoveCellMeta",t,e,n,s)&&(delete U.cellSettings[i][a][n],J.runHooks("afterRemoveCellMeta",t,e,n,s)),s=null},this.spliceCellsMeta=function(t,e){for(var n,o=arguments.length,r=Array(o>2?o-2:0),i=2;i<o;i++)r[i-2]=arguments[i];(n=U.cellSettings).splice.apply(n,[t,e].concat(r))},this.setCellMetaObject=function(t,e,n){if("object"===(void 0===n?"undefined":N(n)))for(var o in n)if(Object(d.hasOwnProperty)(n,o)){var r=n[o];this.setCellMeta(t,e,o,r)}},this.setCellMeta=function(t,e,n,o){var r=Z.toPhysical(t,e),i=L(r,2),s=i[0],l=i[1];U.columnSettings[l]||(U.columnSettings[l]=Object(a.columnFactory)($,U.columnsSettingConflicts)),U.cellSettings[s]||(U.cellSettings[s]=[]),U.cellSettings[s][l]||(U.cellSettings[s][l]=new U.columnSettings[l]),U.cellSettings[s][l][n]=o,J.runHooks("afterSetCellMeta",t,e,n,o)},this.getCellsMeta=function(){return Object(p.arrayFlatten)(U.cellSettings)},this.getCellMeta=function(t,e){var n=z.colToProp(e),o=void 0,r=Z.toPhysical(t,e),i=L(r,2),s=i[0],l=i[1];if(null===s&&(s=t),U.columnSettings[l]||(U.columnSettings[l]=Object(a.columnFactory)($,U.columnsSettingConflicts)),U.cellSettings[s]||(U.cellSettings[s]=[]),U.cellSettings[s][l]||(U.cellSettings[s][l]=new U.columnSettings[l]),o=U.cellSettings[s][l],o.row=s,o.col=l,o.visualRow=t,o.visualCol=e,o.prop=n,o.instance=J,J.runHooks("beforeGetCellMeta",t,e,o),Object(d.extend)(o,W(o)),o.cells){var u=o.cells.call(o,s,l,n);u&&(Object(d.extend)(o,u),Object(d.extend)(o,W(u)))}return J.runHooks("afterGetCellMeta",t,e,o),o},this.getCellMetaAtRow=function(t){return U.cellSettings[t]},this.isColumnModificationAllowed=function(){return!("object"===J.dataType||J.getSettings().columns)};var et=Object(C.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(t,e){return Object(g.b)(et.call(this,t,e))},this.getCellEditor=Object(C.cellMethodLookupFactory)("editor");var nt=Object(C.cellMethodLookupFactory)("validator");this.getCellValidator=function(t,e){var n=nt.call(this,t,e);return"string"==typeof n&&(n=Object(y.b)(n)),n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var o=new r;t&&(o.onQueueEmpty=t);for(var i=J.countRows()-1;i>=0;)if(void 0===e||-1!==e.indexOf(i)){for(var a=J.countCols()-1;a>=0;)void 0===n||-1!==n.indexOf(a)?(o.addValidatorToQueue(),J.validateCell(J.getDataAtCell(i,a),J.getCellMeta(i,a),function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(o.valid=!1),o.removeValidatorFormQueue()},"validateCells"),a--):a--;i--}else i--;o.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=U.settings.rowHeaders;return void 0!==t&&(t=J.runHooks("modifyRowHeader",t)),void 0===t?(e=[],Object(b.rangeEach)(J.countRows()-1,function(t){e.push(J.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[t]?e=e[t]:Object(s.isFunction)(e)?e=e(t):e&&"string"!=typeof e&&"number"!=typeof e&&(e=t+1),e},this.hasRowHeaders=function(){return!!U.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==U.settings.colHeaders&&null!==U.settings.colHeaders)return!!U.settings.colHeaders;for(var t=0,e=J.countCols();t<e;t++)if(J.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=U.settings.columns&&Object(s.isFunction)(U.settings.columns),n=U.settings.colHeaders;if(void 0===(t=J.runHooks("modifyColHeader",t))){for(var o=[],r=e?J.countSourceCols():J.countCols(),i=0;i<r;i++)o.push(J.getColHeader(i));n=o}else{var a=t;t=J.runHooks("modifyCol",t);var l=function(t){for(var e=[],n=J.countSourceCols(),o=0;o<n;o++)Object(s.isFunction)(J.getSettings().columns)&&J.getSettings().columns(o)&&e.push(o);return e[t]}(t);U.settings.columns&&Object(s.isFunction)(U.settings.columns)&&U.settings.columns(l)&&U.settings.columns(l).title?n=U.settings.columns(l).title:U.settings.columns&&U.settings.columns[t]&&U.settings.columns[t].title?n=U.settings.columns[t].title:Array.isArray(U.settings.colHeaders)&&void 0!==U.settings.colHeaders[t]?n=U.settings.colHeaders[t]:Object(s.isFunction)(U.settings.colHeaders)?n=U.settings.colHeaders(t):U.settings.colHeaders&&"string"!=typeof U.settings.colHeaders&&"number"!=typeof U.settings.colHeaders&&(n=Object(C.spreadsheetColumnLabel)(a))}return n},this._getColWidthFromSettings=function(t){var e=J.getCellMeta(0,t),n=e.width;if(void 0!==n&&n!==U.settings.width||(n=e.colWidths),void 0!==n&&null!==n){switch(void 0===n?"undefined":N(n)){case"object":n=n[t];break;case"function":n=n(t)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(t){var e=J._getColWidthFromSettings(t);return e=J.runHooks("modifyColWidth",e,t),void 0===e&&(e=k.d.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=U.settings.rowHeights;if(void 0!==e&&null!==e){switch(void 0===e?"undefined":N(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=J._getRowHeightFromSettings(t);return e=J.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return J.runHooks("modifySourceLength")||(J.getSourceData()?J.getSourceData().length:0)},this.countSourceCols=function(){var t=J.getSourceData()&&J.getSourceData()[0]?J.getSourceData()[0]:[];return Object(d.isObject)(t)?Object(d.deepObjectSize)(t):t.length||0},this.countRows=function(){return z.getLength()},this.countCols=function(){var t=this.getSettings().maxCols,e=!1,n=0;if("array"===J.dataType&&(e=U.settings.data&&U.settings.data[0]&&U.settings.data[0].length),e&&(n=U.settings.data[0].length),U.settings.columns)if(Object(s.isFunction)(U.settings.columns))if("array"===J.dataType){for(var o=0,r=0;r<n;r++)U.settings.columns(r)&&o++;n=o}else"object"!==J.dataType&&"function"!==J.dataType||(n=z.colToPropCache.length);else n=U.settings.columns.length;else"object"!==J.dataType&&"function"!==J.dataType||(n=z.colToPropCache.length);return Math.min(t,n)},this.rowOffset=function(){return J.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return J.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return J.view.wt.drawn?J.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return J.view.wt.drawn?J.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return J.view.wt.drawn?J.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return J.view.wt.drawn?J.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(t){for(var e,n=J.countRows()-1,o=0;n>=0;){if(e=J.runHooks("modifyRow",n),J.isEmptyRow(e))o++;else if(t)break;n--}return o},this.countEmptyCols=function(t){if(J.countRows()<1)return 0;for(var e=J.countCols()-1,n=0;e>=0;){if(J.isEmptyCol(e))n++;else if(t)break;e--}return n},this.isEmptyRow=function(t){return U.settings.isEmptyRow.call(J,t)},this.isEmptyCol=function(t){return U.settings.isEmptyCol.call(J,t)},this.selectCell=function(t,e,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("number"!=typeof t||t<0||t>=J.countRows())return!1;if("number"!=typeof e||e<0||e>=J.countCols())return!1;if(Object(l.isDefined)(n)){if("number"!=typeof n||n<0||n>=J.countRows())return!1;if("number"!=typeof o||o<0||o>=J.countCols())return!1}return tt.selectedRange.set(new k.a(t,e)),i&&J.listen(),Object(l.isUndefined)(n)?tt.setRangeEnd(tt.selectedRange.current().from,r):tt.setRangeEnd(new k.a(n,o),r),tt.finish(),!0},this.selectCellByProp=function(t,e,n,o,r){var i=void 0;return Object(l.isDefined)(o)&&(i=z.propToCol(o)),J.selectCell(t,z.propToCol(e),n,i,r)},this.deselectCell=function(){tt.deselect()},this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(void 0!==t&&(t<0||t>=J.countRows()))return!1;if(void 0!==e&&(e<0||e>=J.countCols()))return!1;var r=!1;return void 0!==t&&void 0!==e&&(J.view.wt.wtOverlays.topOverlay.scrollTo(t,n),J.view.wt.wtOverlays.leftOverlay.scrollTo(e,o),r=!0),"number"==typeof t&&"number"!=typeof e&&(J.view.wt.wtOverlays.topOverlay.scrollTo(t,n),r=!0),"number"==typeof e&&"number"!=typeof t&&(J.view.wt.wtOverlays.leftOverlay.scrollTo(e,o),r=!0),r},this.destroy=function(){if(J._clearTimeouts(),J.view&&J.view.destroy(),G&&G.destroy(),G=null,Object(H.c)(),Object(S.b)(J)){var t=document.querySelector("#hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(i.empty)(J.rootElement),Q.destroy(),J.runHooks("afterDestroy"),T.a.getSingleton().destroy(J);for(var e in J)Object(d.hasOwnProperty)(J,e)&&(Object(s.isFunction)(J[e])?J[e]=V:"guid"!==e&&(J[e]=null));z&&z.destroy(),z=null,U=null,X=null,tt=null,Y=null,J=null,$=null},this.getActiveEditor=function(){return Y.getActiveEditor()},this.getPlugin=function(t){return Object(v.a)(this,t)},this.getInstance=function(){return J},this.addHook=function(t,e){T.a.getSingleton().add(t,e,J)},this.hasHook=function(t){return T.a.getSingleton().has(t,J)},this.addHookOnce=function(t,e){T.a.getSingleton().once(t,e,J)},this.removeHook=function(t,e){T.a.getSingleton().remove(t,e,J)},this.runHooks=function(t,e,n,o,r,i,a){return T.a.getSingleton().run(J,t,e,n,o,r,i,a)},this.getTranslatedPhrase=function(t,e){return Object(j.a)(U.settings.language,t,e)},this.timeouts=[],this._registerTimeout=function(t){this.timeouts.push(t)},this._clearTimeouts=function(){for(var t=0,e=this.timeouts.length;t<e;t++)clearTimeout(this.timeouts[t])},this._refreshBorders=function(t,e){e||Y.destroyEditor(t),J.view.render(),tt.isSelected()&&!e&&Y.prepareEditor()},T.a.getSingleton().run(J,"construct")}e.a=r;var i=n(2),a=n(154),s=n(34),l=n(14),u=n(33),c=n(302),h=n(305),f=n(8),d=n(1),p=n(0),v=n(6),g=n(15),y=n(35),m=n(30),b=n(4),w=n(306),O=n(307),C=n(81),E=n(53),S=n(204),k=n(9),T=n(13),R=n(205),_=n(152),j=n(206),A=n(82),M=n(207),H=n(208),P=n(311),N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),D=null},function(t,e,n){"use strict";function o(t,e){function n(){}Object(r.inherit)(n,t);for(var o=0,i=e.length;o<i;o++)n.prototype[e[o]]=void 0;return n}Object.defineProperty(e,"__esModule",{value:!0}),e.columnFactory=o;var r=n(1)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(0),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return a(t,[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){if(null!=this.hot.getColHeader(0)){var e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),Object(i.arrayEach)(this.rows,function(e){t(e.row,Object(r.outerHeight)(e.table)-1)})}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),Object(i.arrayEach)(this.columns,function(e){t(e.col,Object(r.outerWidth)(e.table))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=document,n=e.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(e){Object(i.arrayEach)(e.strings,function(e){n.appendChild(t.createColElement(e.col))})}),n}},{key:"createRow",value:function(t){var e=this,n=document,o=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),o.appendChild(r)),this.samples.forEach(function(r){Object(i.arrayEach)(r.strings,function(r){var i=r.col,a=e.hot.getCellMeta(t,i);a.col=i,a.row=t;var s=e.hot.getCellRenderer(a),l=n.createElement("td");s(e.hot,l,t,i,e.hot.colToProp(i),r.value,a),o.appendChild(l)})}),o}},{key:"createColumnHeadersRow",value:function(){var t=this,e=document,n=e.createDocumentFragment();if(this.hot.hasRowHeaders()){var o=e.createElement("th");this.hot.view.appendColHeader(-1,o),n.appendChild(o)}return this.samples.forEach(function(o){Object(i.arrayEach)(o.strings,function(o){var r=o.col,i=e.createElement("th");t.hot.view.appendColHeader(r,i),n.appendChild(i)})}),n}},{key:"createCol",value:function(t){var e=this,n=document,o=n.createDocumentFragment();return this.samples.forEach(function(r){Object(i.arrayEach)(r.strings,function(r){var i=r.row,a=e.hot.getCellMeta(i,t);a.col=t,a.row=i;var s=e.hot.getCellRenderer(a),l=n.createElement("td"),u=n.createElement("tr");s(e.hot,l,i,t,e.hot.colToProp(t),r.value,a),u.appendChild(l),o.appendChild(u)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=document,n=e.createElement("col");return n.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(t)+"px",n}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document,n=e.createDocumentFragment(),o=e.createElement("table"),i=e.createElement("thead"),a=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),u=e.createElement("th");return this.isVertical()&&o.appendChild(s),this.isHorizontal()&&(l.appendChild(u),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&a.appendChild(l),o.appendChild(a),Object(r.addClass)(o,t),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document,n=e.createDocumentFragment(),o=e.createElement("div");return t="htGhostTable htAutoSize "+t.trim(),Object(r.addClass)(o,t),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(153),i=n(2),a=n(0),s=n(336),l=n(8),u=n(1),c=n(14),h=n(34),f=n(23),d=n(18),p=n(21),v=n(43),g=n(11),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function(){function t(e,n){o(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new l.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return y(t,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){return t.onDocumentMouseDown(e)})}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"setOffset",value:function(t){this.offset[t]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.container.removeAttribute("style"),this.container.style.display="block";var e=Object(h.debounce)(function(e){return t.openSubMenu(e)},300),n=Object(a.arrayFilter)(this.menuItems,function(e){return Object(f.h)(e,t.hot)});n=Object(f.c)(n,v.l);var o={data:n,colHeaders:!1,colWidths:[215],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(e,n,o,r,i,a){return t.menuItemRenderer(e,n,o,r,i,a)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(e){return t.onBeforeKeyDown(e)},afterOnCellMouseOver:function(n,o,r){t.isAllSubMenusClosed()?e(o.row):t.openSubMenu(o.row)},rowHeights:function(t){return n[t].name===v.l?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new r.a(this.container,o),this.hotMenu.addHook("afterInit",function(){return t.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return t.onAfterSelection.apply(t,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Object(f.f)(n))return!1;var o=this.hotMenu.getSourceDataAtRow(e),r=new t(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0});return r.setMenuItems(o.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=r,r}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;Object(a.arrayEach)(this.hotMenu.getData(),function(e,n){return t.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hotMenu.getSelectedLast()){var e=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]);if(this.runLocalHooks("select",e,t),!1!==e.isCommand&&e.name!==v.l){var n=this.hot.getSelectedRange(),o=n?Object(f.l)(n):[],r=!0;(!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot)||e.submenu)&&(r=!1),this.runLocalHooks("executeCommand",e.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,o,t),r&&this.close(!0)}}}},{key:"setPosition",value:function(t){var e=new s.a(t);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top=e+"px"}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top=e+"px"}},{key:"setPositionOnRightOfCursor",value:function(t){var e=void 0;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left=e+"px"}},{key:"setPositionOnLeftOfCursor",value:function(t){this.container.style.left=this.offset.left+t.left-this.container.offsetWidth+Object(i.getScrollbarWidth)()+4+"px"}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);Object(f.j)(t)||Object(f.g)(t)||Object(f.i)(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);Object(f.j)(e)||Object(f.g)(e)||Object(f.i)(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;o&&(Object(f.j)(o)||Object(f.g)(o)||Object(f.i)(o)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,o=n>=0?this.hotMenu.getCell(n,e):null;o&&(Object(f.j)(o)||Object(f.g)(o)||Object(f.i)(o)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,o,r,a){var s=this,l=t.getSourceDataAtRow(n),c=document.createElement("div"),h=function(t){return t.disableSelection};"function"==typeof a&&(a=a.call(this.hot)),Object(i.empty)(e),Object(i.addClass)(c,"htItemWrapper"),e.appendChild(c),function(t){return new RegExp(v.l,"i").test(t.name)}(l)?Object(i.addClass)(e,"htSeparator"):"function"==typeof l.renderer?(Object(i.addClass)(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,c,n,o,r,a))):Object(i.fastInnerHTML)(c,a),function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(s.hot)}(l)?(Object(i.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):h(l)?(Object(i.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):function(t){return Object(u.hasOwnProperty)(t,"submenu")}(l)?(Object(i.addClass)(e,"htSubmenu"),h(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,o,void 0,void 0,!1,!1)})):(Object(i.removeClass)(e,"htSubmenu"),Object(i.removeClass)(e,"htDisabled"),h(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=void 0;return t?(Object(h.isFunction)(t)&&(t=t.call(this.hot),t=null===t||Object(c.isUndefined)(t)?"":t.toString()),t=t.replace(/[^A-z0-9]/g,"_"),t=this.options.className+"Sub_"+t,e=document.querySelector("."+this.options.className+"."+t)):e=document.querySelector("."+this.options.className),e||(e=document.createElement("div"),Object(i.addClass)(e,"htMenu "+this.options.className),t&&Object(i.addClass)(e,t),document.getElementsByTagName("body")[0].appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){var e=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,t.keyCode){case d.KEY_CODES.ESCAPE:this.close(),n=!0;break;case d.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case d.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case d.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case d.KEY_CODES.ARROW_RIGHT:if(e){var o=this.openSubMenu(e[0]);o&&o.selectFirstCell()}n=!0;break;case d.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),Object(g.stopImmediatePropagation)(t)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var t=this.hotMenu.getSettings().data,e=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,o=parseInt(e.width,10),r=Object(a.arrayReduce)(t,function(t,e){return t+(e.name===v.l?1:26)},0);n.width=o+22+"px",n.height=r+4+"px",e.height=n.height}},{key:"onAfterSelection",value:function(t,e,n,o,r){!1===this.keyEvent&&(r.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.container&&Object(i.isChildOf)(t.target,this.container)&&this.executeCommand(t),this.options.standalone&&this.hotMenu&&!Object(i.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Object(i.isChildOf)(t.target,".htMenu")&&Object(i.isChildOf)(t.target,document)&&this.close(!0))}}]),t}();Object(u.mixin)(m,p.a),e.a=m},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e=[];return L[t]||(t=N),Object(a.arrayEach)(L[t],function(t){var n=void 0;n=t===s.l?{name:s.l}:Object(i.clone)(Object(l.b)(t)),e.push(n)}),e}e.f=r;var i=n(1),a=n(0),s=n(43),l=n(10),u=n(396),c=n(229),h=n(397),f=n(230),d=n(398),p=n(399),v=n(400),g=n(401),y=n(402),m=n(231),b=n(403),w=n(404),O=n(405),C=n(234),E=n(406),S=n(233),k=n(232),T=n(407),R=n(408),_=n(409),j=n(410),A=(n(411),n(412),n(158)),M=n(235),H=n(236);n.d(e,"b",function(){return u.a}),n.d(e,"a",function(){return j.a}),n.d(e,"c",function(){return A.a}),n.d(e,"d",function(){return M.a}),n.d(e,"e",function(){return H.a});var P,N="text",L=(P={},o(P,"numeric",[u.a,s.l,c.a,h.a,s.l,f.a,d.a,s.l,p.a,v.a,g.a,y.a,m.a,b.a]),o(P,N,[u.a,s.l,c.a,h.a,s.l,f.a,d.a,s.l,w.a,O.a,s.l,C.a,E.a]),o(P,"date",[u.a,s.l,c.a,h.a,s.l,f.a,d.a,s.l,S.a,k.a,m.a,s.l,T.a,R.a,_.a]),P)},function(t,e,n){"use strict";function o(t,e){return t.every(function(t){return t.func(e)})}n.d(e,"a",function(){return a});var r=n(3),i=n(64),a="conjunction",s=r.FILTERS_LABELS_CONJUNCTION;Object(i.d)(a,s,o)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(1),l=n(3),u=n(65),c=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=new WeakMap;e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object(s.extend)(e.DEFAULTS,n)));return f.set(i,{}),i.registerHooks(),i}return i(e,t),h(e,null,[{key:"DEFAULTS",get:function(){return Object(s.clone)({placeholder:"",type:"text",tagName:"input"})}}]),h(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",function(e){return t.onClick(e)}),this.addLocalHook("keyup",function(e){return t.onKeyup(e)})}},{key:"build",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this);var t=f.get(this),n=document.createElement("div");t.input=this._element.firstChild,Object(a.addClass)(this._element,"htUIInput"),Object(a.addClass)(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=f.get(this).input;t.type=this.options.type,t.placeholder=this.hot.getTranslatedPhrase(this.options.placeholder),t.value="string"==typeof this.options.value&&this.options.value.startsWith(l.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(this.options.value):this.options.value}}},{key:"focus",value:function(){this.isBuilt()&&f.get(this).input.focus()}},{key:"onClick",value:function(t){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}]),e}(u.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.a=function t(e,n){o(this,t),this.hot=n,this.plugin=e}},function(t,e,n){"use strict";var o=n(22).f,r=n(88),i=n(70),a=n(39),s=n(72),l=n(73),u=n(170),c=n(172),h=n(173),f=n(24),d=n(41).fastKey,p=n(50),v=f?"_s":"size",g=function(t,e){var n,o=d(e);if("F"!==o)return t._i[o];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,o){s(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=o&&l(o,n,t[u],t)});return i(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete n[o.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),o=g(n,t);if(o){var r=o.n,i=o.p;delete n._i[o.i],o.r=!0,i&&(i.n=r),r&&(r.p=i),n._f==o&&(n._f=r),n._l==o&&(n._l=i),n[v]--}return!!o},forEach:function(t){p(this,e);for(var n,o=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(o(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),f&&o(c.prototype,"size",{get:function(){return p(this,e)[v]}}),c},def:function(t,e,n){var o,r,i=g(t,e);return i?i.v=n:(t._l=i={i:r=d(e,!0),k:e,v:n,p:o=t._l,n:void 0,r:!1},t._f||(t._f=i),o&&(o.n=i),t[v]++,"F"!==r&&(t._i[r]=i)),t},getEntry:g,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?c(0,n.k):"values"==e?c(0,n.v):c(0,[n.k,n.v]):(t._t=void 0,c(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){t.exports=!n(24)&&!n(25)(function(){return 7!=Object.defineProperty(n(86)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(32),r=n(26),i=n(164)(!1),a=n(90)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)n!=a&&o(s,n)&&u.push(n);for(;e.length>l;)o(s,n=e[l++])&&(~i(u,n)||u.push(n));return u}},function(t,e,n){var o=n(26),r=n(27),i=n(69);t.exports=function(t){return function(e,n,a){var s,l=o(e),u=r(l.length),c=i(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var o=n(17).document;t.exports=o&&o.documentElement},function(t,e,n){var o=n(20);t.exports=function(t,e,n,r){try{return r?e(o(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&o(i.call(t)),e}}},function(t,e,n){var o=n(57),r=n(16)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||i[r]===t)}},function(t,e,n){var o=n(169),r=n(16)("iterator"),i=n(57);t.exports=n(49).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||i[o(t)]}},function(t,e,n){var o=n(48),r=n(16)("toStringTag"),i="Arguments"==o(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:i?o(e):"Object"==(s=o(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){"use strict";var o=n(74),r=n(5),i=n(37),a=n(38),s=n(32),l=n(57),u=n(245),c=n(58),h=n(171),f=n(16)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,v,g,y,m){u(n,e,v);var b,w,O,C=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",S="values"==g,k=!1,T=t.prototype,R=T[f]||T["@@iterator"]||g&&T[g],_=!d&&R||C(g),j=g?S?C("entries"):_:void 0,A="Array"==e?T.entries||R:R;if(A&&(O=h(A.call(new t)))!==Object.prototype&&O.next&&(c(O,E,!0),o||s(O,f)||a(O,f,p)),S&&R&&"values"!==R.name&&(k=!0,_=function(){return R.call(this)}),o&&!m||!d&&!k&&T[f]||a(T,f,_),l[e]=_,l[E]=p,g)if(b={values:S?_:C("values"),keys:y?_:C("keys"),entries:j},m)for(w in b)w in T||i(T,w,b[w]);else r(r.P+r.F*(d||k),e,b);return b}},function(t,e,n){var o=n(32),r=n(40),i=n(90)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),o(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var o=n(17),r=n(22),i=n(24),a=n(16)("species");t.exports=function(t){var e=o[t];i&&e&&!e[a]&&r.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var o=n(12),r=n(20),i=function(t,e){if(r(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,o){try{o=n(39)(Function.call,n(76).f(Object.prototype,"__proto__").set,2),o(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:o(t,n),t}}({},!1):void 0),check:i}},function(t,e,n){var o=n(48);t.exports=Array.isArray||function(t){return"Array"==o(t)}},function(t,e,n){"use strict";var o=n(45),r=n(78),i=n(59),a=n(40),s=n(89),l=Object.assign;t.exports=!l||n(25)(function(){var t={},e={},n=Symbol(),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=o})?function(t,e){for(var n=a(t),l=arguments.length,u=1,c=r.f,h=i.f;l>u;)for(var f,d=s(arguments[u++]),p=c?o(d).concat(c(d)):o(d),v=p.length,g=0;v>g;)h.call(d,f=p[g++])&&(n[f]=d[f]);return n}:l},function(t,e,n){"use strict";var o=n(70),r=n(41).getWeak,i=n(20),a=n(12),s=n(72),l=n(73),u=n(77),c=n(32),h=n(50),f=u(5),d=u(6),p=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},y=function(t,e){return f(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var u=t(function(t,o){s(t,u,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=o&&l(o,n,t[i],t)});return o(u.prototype,{delete:function(t){if(!a(t))return!1;var n=r(t);return!0===n?v(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=r(t);return!0===n?v(h(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var o=r(i(e),!0);return!0===o?v(t).set(e,n):o[t._i]=n,t},ufstore:v}},function(t,e,n){"use strict";function o(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=r(e),this.reject=r(n)}var r=n(71);t.exports.f=function(t){return new o(t)}},function(t,e,n){e.f=n(16)},function(t,e,n){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(26),i=n(100).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":o(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(t){try{return i(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?l(t):i(r(t))}},function(t,e,n){"use strict";var o=n(68),r=n(46);t.exports=function(t){var e=String(r(this)),n="",i=o(t);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},function(t,e,n){var o=n(12),r=n(48),i=n(16)("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==r(t))}},function(t,e,n){var o=n(12),r=Math.floor;t.exports=function(t){return!o(t)&&isFinite(t)&&r(t)===t}},function(t,e,n){var o=n(45),r=n(26),i=n(59).f;t.exports=function(t){return function(e){for(var n,a=r(e),s=o(a),l=s.length,u=0,c=[];l>u;)i.call(a,n=s[u++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){var o=n(27),r=n(181),i=n(46);t.exports=function(t,e,n,a){var s=String(i(t)),l=s.length,u=void 0===n?" ":String(n),c=o(e);if(c<=l||""==u)return s;var h=c-l,f=r.call(u,Math.ceil(h/u.length));return f.length>h&&(f=f.slice(0,h)),a?f+s:s+f}},function(t,e,n){var o=n(17),r=o.navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=new WeakMap;e.a=function(){function t(e,n,r,a,s,l,u){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(t){return t};o(this,t),i.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:r,columnWidthFn:a,overrideFn:s,onlyFullyVisible:l,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return r(t,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),r(t,[{key:"calculate",value:function(){for(var t=0,e=!0,n=[],o=void 0,r=i.get(this),a=r.onlyFullyVisible,s=r.overrideFn,l=r.scrollOffset,u=r.totalColumns,c=r.viewportWidth,h=0;h<u;h++){o=this._getColumnWidth(h),t<=l&&!a&&(this.startColumn=h);var f=l>0?c+1:c;if(t>=l&&t+o<=l+f&&(null==this.startColumn&&(this.startColumn=h),this.endColumn=h),n.push(t),t+=o,a||(this.endColumn=h),t>=l+c){e=!1;break}}if(this.endColumn===u-1&&e)for(this.startColumn=this.endColumn;this.startColumn>0;){var d=n[this.endColumn]+o-n[this.startColumn-1];if((d<=c||!a)&&this.startColumn--,d>c)break}null!==this.startColumn&&s&&s(this),this.startPosition=n[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){this.totalTargetWidth=t;for(var e=i.get(this),n=e.totalColumns,o=0,r=0;r<n;r++){var a=this._getColumnWidth(r),s=e.stretchingColumnWidthFn(void 0,r);"number"==typeof s?t-=s:o+=a}var l=t-o;if("all"===this.stretch&&l>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(n-1),c=l+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,o=i.get(this),r=o.totalColumns;if(!this.stretchAllColumnsWidth[t]){var a=Math.round(e*this.stretchAllRatio),s=o.stretchingColumnWidthFn(a,t);this.stretchAllColumnsWidth[t]=void 0===s?a:isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===r&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===i.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=i.get(this).columnWidthFn(e);return void 0===n&&(n=t.DEFAULT_WIDTH),n}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=new WeakMap;e.a=function(){function t(e,n,r,a,s,l,u){o(this,t),i.set(this,{viewportHeight:e,scrollOffset:n,totalRows:r,rowHeightFn:a,overrideFn:s,onlyFullyVisible:l,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return r(t,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),r(t,[{key:"calculate",value:function(){for(var e=0,n=!0,o=[],r=i.get(this),a=r.onlyFullyVisible,s=r.overrideFn,l=r.rowHeightFn,u=r.scrollOffset,c=r.totalRows,h=r.viewportHeight,f=r.horizontalScrollbarHeight||0,d=void 0,p=0;p<c;p++)if(d=l(p),void 0===d&&(d=t.DEFAULT_HEIGHT),e<=u&&!a&&(this.startRow=p),e>=u&&e+d<=u+h-f&&(null===this.startRow&&(this.startRow=p),this.endRow=p),o.push(e),e+=d,a||(this.endRow=p),e>=u+h-f){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var v=o[this.endRow]+d-o[this.startRow-1];if((v<=h-f||!a)&&this.startRow--,v>=h-f)break}null!==this.startRow&&s&&s(this),this.startPosition=o[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n,r){o(this,t),this.offset=e,this.total=n,this.countTH=r}return r(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n,r){o(this,t),this.offset=e,this.total=n,this.countTH=r}return r(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(1),a=n(30),s=n(192),l=n(193),u=n(194),c=n(195),h=n(196),f=n(198),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t);var n=[];if(this.guid="wt_"+Object(a.randomString)(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new h.a(this,e.table,e.wtRootElement),this.wtScroll=new u.a(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new s.a(this),this.selections=this.cloneSource.selections):(this.wtSettings=new c.a(this,e),this.wtTable=new h.a(this,e.table),this.wtScroll=new u.a(this),this.wtViewport=new f.a(this),this.wtEvent=new s.a(this),this.selections=this.getSetting("selections"),this.wtOverlays=new l.a(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,d=this.wtTable.THEAD.childNodes[0].childNodes.length;i<d;i++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){Object(r.fastInnerText)(e,n[t])}])}this.drawn=!1,this.drawInterrupted=!1}return d(t,[{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||Object(r.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<n&&t.col<r)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<r&&t.row>=e-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<r)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>e-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,e){return this.wtSettings.update(t,e)}},{key:"scrollVertical",value:function(t){return this.wtOverlays.topOverlay.scrollTo(t),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(t){return this.wtOverlays.leftOverlay.scrollTo(t),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(t){return this.wtScroll.scrollViewport(t),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(t){return!!this.cloneOverlay&&this.cloneOverlay.type===t}},{key:"exportSettingsAsClassNames",value:function(){var t=this,e={rowHeaders:["array"],columnHeaders:["array"]},n=[],o=[];Object(i.objectEach)(e,function(e,r){e.indexOf("array")>-1&&t.getSetting(r).length&&o.push("ht"+Object(a.toUpperCaseFirst)(r)),n.push("ht"+Object(a.toUpperCaseFirst)(r))}),Object(r.removeClass)(this.wtTable.wtRootElement.parentNode,n),Object(r.addClass)(this.wtTable.wtRootElement.parentNode,o)}},{key:"getSetting",value:function(t,e,n,o,r){return this.wtSettings.getSetting(t,e,n,o,r)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),t}()},function(t,e,n){"use strict";function o(t){var e=this,n=new s.a(t);this.instance=t;var o=[null,null];this.dblClickTimeout=[null,null];var l=function(t){var n=document.activeElement,a=Object(i.partial)(r.getParent,t.realTarget),s=t.realTarget;if(s!==n&&a(0)!==n&&a(1)!==n){var l=e.parentCell(s);Object(r.hasClass)(s,"corner")?e.instance.getSetting("onCellCornerMouseDown",t,s):l.TD&&e.instance.hasSetting("onCellMouseDown")&&e.instance.getSetting("onCellMouseDown",t,l.coords,l.TD,e.instance),2!==t.button&&l.TD&&(o[0]=l.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout(function(){o[0]=null},1e3))}},u=function(t){e.instance.touchMoving=!0},c=function(t){n.addEventListener(this,"touchmove",u),e.checkIfTouchMove=setTimeout(function(){!0===e.instance.touchMoving&&(e.instance.touchMoving=void 0,n.removeEventListener("touchmove",u,!1)),l(t)},30)},h=function(t){var n,o,i;e.instance.hasSetting("onCellMouseOver")&&(n=e.instance.wtTable.TABLE,o=Object(r.closestDown)(t.realTarget,["TD","TH"],n),i=e.instance.cloneSource||e.instance,o&&o!==i.lastMouseOver&&Object(r.isChildOf)(o,n)&&(i.lastMouseOver=o,e.instance.getSetting("onCellMouseOver",t,e.instance.wtTable.getCoords(o),o,e.instance)))},f=function(t){var n=void 0,o=void 0,i=void 0;e.instance.hasSetting("onCellMouseOut")&&(n=e.instance.wtTable.TABLE,o=Object(r.closestDown)(t.realTarget,["TD","TH"],n),i=Object(r.closestDown)(t.relatedTarget,["TD","TH"],n),o&&o!==i&&Object(r.isChildOf)(o,n)&&e.instance.getSetting("onCellMouseOut",t,e.instance.wtTable.getCoords(o),o,e.instance))},d=function(t){if(2!==t.button){var n=e.parentCell(t.realTarget);n.TD===o[0]&&n.TD===o[1]?(Object(r.hasClass)(t.realTarget,"corner")?e.instance.getSetting("onCellCornerDblClick",t,n.coords,n.TD,e.instance):e.instance.getSetting("onCellDblClick",t,n.coords,n.TD,e.instance),o[0]=null,o[1]=null):n.TD===o[0]?(e.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,e.instance),o[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout(function(){o[1]=null},500)):n.TD&&e.instance.hasSetting("onCellMouseUp")&&e.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,e.instance)}},p=function(t){clearTimeout(void 0),t.preventDefault(),d(t)};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",l),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",h),n.addEventListener(this.instance.wtTable.TABLE,"mouseout",f),n.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&Object(a.isMobileBrowser)()&&!e.instance.wtTable.isWorkingOnClone()){var v="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(t){e.instance.touchApplied=!0,Object(r.isChildOf)(t.target,v)&&c.call(t.target,t)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(t){e.instance.touchApplied=!1,Object(r.isChildOf)(t.target,v)&&p.call(t.target,t)}),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(t){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout(function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==e.instance.getSetting("stretchH")&&e.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}var r=n(2),i=n(34),a=n(33),s=n(8);o.prototype.parentCell=function(t){var e={},n=this.instance.wtTable.TABLE,o=Object(r.closestDown)(t,["TD","TH"],n);return o?(e.coords=this.instance.wtTable.getCoords(o),e.TD=o):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"current")?(e.coords=this.instance.selections.getCell().cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"area")&&this.instance.selections.createOrGetArea().cellRange&&(e.coords=this.instance.selections.createOrGetArea().cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e},e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(0),a=n(18),s=n(33),l=n(8),u=n(29),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.wot=e,this.instance=this.wot,this.eventManager=new l.a(this.wot),this.wot.update("scrollbarWidth",Object(r.getScrollbarWidth)()),this.wot.update("scrollbarHeight",Object(r.getScrollbarWidth)()),this.scrollableElement=Object(r.getScrollableElement)(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()}return c(t,[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=u.a.createOverlay(u.a.CLONE_TOP,this.wot),u.a.hasOverlay(u.a.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),u.a.hasOverlay(u.a.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=u.a.createOverlay(u.a.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=u.a.createOverlay(u.a.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=u.a.createOverlay(u.a.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=u.a.createOverlay(u.a.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=u.a.createOverlay(u.a.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var t=this,e=this.topOverlay.mainTableScrollableElement,n=this.leftOverlay.mainTableScrollableElement,o=[];for(o.push([document.documentElement,"keydown",function(e){return t.onKeyDown(e)}]),o.push([document.documentElement,"keyup",function(){return t.onKeyUp()}]),o.push([document,"visibilitychange",function(){return t.onKeyUp()}]),o.push([e,"scroll",function(e){return t.onTableScroll(e)}]),e!==n&&o.push([n,"scroll",function(e){return t.onTableScroll(e)}]),this.topOverlay.needFullRender&&(o.push([this.topOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),o.push([this.topOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.bottomOverlay.needFullRender&&(o.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),o.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.leftOverlay.needFullRender&&(o.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),o.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&o.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&o.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&o.push([window,"wheel",function(e){var n=void 0,o=e.wheelDeltaY||e.deltaY,r=e.wheelDeltaX||e.deltaX;t.topOverlay.clone.wtTable.holder.contains(e.realTarget)?n="top":t.bottomOverlay.clone&&t.bottomOverlay.clone.wtTable.holder.contains(e.realTarget)?n="bottom":t.leftOverlay.clone.wtTable.holder.contains(e.realTarget)?n="left":t.topLeftCornerOverlay&&t.topLeftCornerOverlay.clone&&t.topLeftCornerOverlay.clone.wtTable.holder.contains(e.realTarget)?n="topLeft":t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&t.bottomLeftCornerOverlay.clone.wtTable.holder.contains(e.realTarget)&&(n="bottomLeft"),("top"==n&&0!==o||"left"==n&&0!==r||"bottom"==n&&0!==o||("topLeft"===n||"bottomLeft"===n)&&(0!==o||0!==r))&&e.preventDefault()}]);o.length;){var r=o.pop();this.eventManager.addEventListener(r[0],r[1],r[2]),this.registeredListeners.push(r)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var t=this.registeredListeners.pop();this.eventManager.removeEventListener(t[0],t[1],t[2])}}},{key:"onTableScroll",value:function(t){if(!Object(s.isMobileBrowser)()){var e=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(n!==window&&o!==window&&!t.target.contains(n)||e!==window&&o!==window&&!t.target.contains(e))||("scroll"===t.type?this.syncScrollPositions(t):this.translateMouseWheelToScroll(t))}}},{key:"onKeyDown",value:function(t){this.keyPressed=Object(a.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=this.topOverlay.clone.wtTable.holder,n=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,o=this.leftOverlay.clone.wtTable.holder,r=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,i=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,a=t.wheelDeltaY||-1*t.deltaY,s=t.wheelDeltaX||-1*t.deltaX,l=null,u={type:"wheel"},c=t.target,h=null;for(1===t.deltaMode&&(a*=120,s*=120);c!=document&&null!=c;){if(c.className.indexOf("wtHolder")>-1){l=c;break}c=c.parentNode}return u.target=l,l===r||l===i?(this.syncScrollPositions(u,-.2*s,"x"),this.syncScrollPositions(u,-.2*a,"y")):(l===e||l===n?h=a:l===o&&(h=s),this.syncScrollPositions(u,-.2*h)),!1}},{key:"syncScrollPositions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var o=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=t.target,s=0,l=!1,u=void 0,c=void 0,h=void 0,f=void 0,d=void 0,p=!1,v=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(u=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(d=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(c=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(h=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(f=this.bottomLeftCornerOverlay.clone.wtTable.holder),a===document&&(a=window),a===o||a===i?(s=v?Object(r.getScrollLeft)(this.scrollableElement):Object(r.getScrollLeft)(a),this.horizontalScrolling=this.overlayScrollPositions.master.left!==s,this.overlayScrollPositions.master.left=s,l=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(u&&u.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=o!==window),d&&d.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=s,p=o!==window)),s=Object(r.getScrollTop)(a),this.verticalScrolling=this.overlayScrollPositions.master.top!==s,this.overlayScrollPositions.master.top=s,l=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:c&&c.scrollTop!==s&&(null==e&&this.pendingScrollCallbacks.left.top++,c.scrollTop=s,p=i!==window)):a===d?(s=Object(r.getScrollLeft)(a),this.overlayScrollPositions.bottom.left=s,l=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==e&&this.pendingScrollCallbacks.master.left++,o.scrollLeft=s,u&&u.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=i!==window)),null!==e&&(l=!0,i.scrollTop+=e)):a===u?(s=Object(r.getScrollLeft)(a),this.overlayScrollPositions.top.left=s,l=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==e&&this.pendingScrollCallbacks.master.left++,o.scrollLeft=s),null!==e&&(l=!0,i.scrollTop+=e),d&&d.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=s,p=i!==window)):a===c?(s=Object(r.getScrollTop)(a),this.overlayScrollPositions.left.top!==s&&(this.overlayScrollPositions.left.top=s,l=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==e&&this.pendingScrollCallbacks.master.top++,i.scrollTop=s)),null!==e&&(l=!0,i.scrollLeft+=e)):a!==h&&a!==f||null!==e&&(l=!0,"x"===n?i.scrollLeft+=e:"y"===n&&(i.scrollTop+=e)),!this.keyPressed&&l&&"scroll"===t.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),p&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=Object(r.getScrollableElement)(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=e.clientWidth,o=e.clientHeight;n===this.spreaderLastSize.width&&o===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.leftOverlay.refresh(t),this.topOverlay.refresh(t),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(t),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(t),this.debug&&this.debug.refresh(t)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),o=this.wot.wtViewport.getRowHeaderWidth(),r=this.wot.wtViewport.getColumnHeaderHeight(),i=this.wot.wtTable.hider.style;i.width=o+this.leftOverlay.sumCellSizes(0,e)+"px",i.height=r+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(t),this.leftOverlay.adjustElementsSize(t),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return Object(i.arrayEach)(e,function(e,o){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)}),n}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(4),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.wot=e,this.instance=e}return a(t,[{key:"scrollViewport",value:function(t){if(this.wot.drawn){var e=this._getVariables(),n=e.topOverlay,o=e.leftOverlay,r=e.totalRows,i=e.totalColumns,a=e.fixedRowsTop,s=e.fixedRowsBottom,l=e.fixedColumnsLeft;if(t.row<0||t.row>Math.max(r-1,0))throw new Error("row "+t.row+" does not exist");if(t.col<0||t.col>Math.max(i-1,0))throw new Error("column "+t.col+" does not exist");t.row>=a&&t.row<this.getFirstVisibleRow()?n.scrollTo(t.row):t.row>this.getLastVisibleRow()&&t.row<r-s&&n.scrollTo(t.row,!0),t.col>=l&&t.col<this.getFirstVisibleColumn()?o.scrollTo(t.col):t.col>this.getLastVisibleColumn()&&o.scrollTo(t.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,o=t.wtViewport,a=t.totalRows,s=t.fixedRowsTop,l=n.getFirstVisibleRow();if(e.mainTableScrollableElement===window){var u=Object(r.offset)(n.wtRootElement),c=Object(r.innerHeight)(n.hider),h=Object(r.innerHeight)(window),f=Object(r.getScrollTop)(window);if(u.top+c-h<=f){var d=o.getColumnHeaderHeight();d+=e.sumCellSizes(0,s),Object(i.rangeEachReverse)(a,1,function(t){if(d+=e.sumCellSizes(t-1,t),u.top+c-d<=f)return l=t,!1})}}return l}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,o=t.wtViewport,a=t.totalRows,s=n.getLastVisibleRow();if(e.mainTableScrollableElement===window){var l=Object(r.offset)(n.wtRootElement),u=Object(r.innerHeight)(window),c=Object(r.getScrollTop)(window);if(l.top>c){var h=o.getColumnHeaderHeight();Object(i.rangeEach)(1,a,function(t){if(h+=e.sumCellSizes(t-1,t),l.top+h-c>=u)return s=t-2,!1})}}return s}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,o=t.wtViewport,a=t.totalColumns,s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===window){var l=Object(r.offset)(n.wtRootElement),u=Object(r.innerWidth)(n.hider),c=Object(r.innerWidth)(window),h=Object(r.getScrollLeft)(window);if(l.left+u-c<=h){var f=o.getRowHeaderWidth();Object(i.rangeEachReverse)(a,1,function(t){if(f+=e.sumCellSizes(t-1,t),l.left+u-f<=h)return s=t,!1})}}return s}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,o=t.wtViewport,a=t.totalColumns,s=n.getLastVisibleColumn();if(e.mainTableScrollableElement===window){var l=Object(r.offset)(n.wtRootElement),u=Object(r.innerWidth)(window),c=Object(r.getScrollLeft)(window);if(l.left>c){var h=o.getRowHeaderWidth();Object(i.rangeEach)(1,a,function(t){if(h+=e.sumCellSizes(t-1,t),l.left+h-c>=u)return s=t-2,!1})}}return s}},{key:"_getVariables",value:function(){var t=this.wot;return{topOverlay:t.wtOverlays.topOverlay,leftOverlay:t.wtOverlays.leftOverlay,wtTable:t.wtTable,wtViewport:t.wtViewport,totalRows:t.getSetting("totalRows"),totalColumns:t.getSetting("totalColumns"),fixedRowsTop:t.getSetting("fixedRowsTop"),fixedRowsBottom:t.getSetting("fixedRowsBottom"),fixedColumnsLeft:t.getSetting("fixedColumnsLeft")}}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){var a=this;o(this,t),this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,e,n){var o=a.getSetting("data",t,e);Object(r.fastInnerText)(n,void 0===o||null===o?"":o)},columnWidth:function(t){},rowHeight:function(t){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var s in this.defaults)if(Object(i.hasOwnProperty)(this.defaults,s))if(void 0!==n[s])this.settings[s]=n[s];else{if(void 0===this.defaults[s])throw new Error('A required setting "'+s+'" was not provided');this.settings[s]=this.defaults[s]}}return a(t,[{key:"update",value:function(t,e){if(void 0===e)for(var n in t)Object(i.hasOwnProperty)(t,n)&&(this.settings[n]=t[n]);else this.settings[t]=e;return this.wot}},{key:"getSetting",value:function(t,e,n,o,r){return"function"==typeof this.settings[t]?this.settings[t](e,n,o,r):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),t}()},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(2),a=n(34),s=n(60),l=(n(151),n(189)),u=n(190),c=n(197),h=n(29),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){var o=this;r(this,t),this.wot=e,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,Object(i.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var a=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return o._modifyRowHeaderWidth(a)}}return p(t,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&Object(i.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",n}},{key:"createHider",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&Object(i.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),n}},{key:"createHolder",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&Object(i.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isWorkingOnClone()||(n.parentNode.className+="ht_master handsontable"),n.appendChild(t)),n}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=Object(i.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",t===window){var e=this.wot.getSetting("preventOverflow");e||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=Object(i.getStyle)(t,"width"),this.holder.style.height=Object(i.getStyle)(t,"height"),this.holder.style.overflow=""}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(t){var e=this.wot,n=e.wtOverlays,o=e.wtViewport,r=this.instance.getSetting("totalRows"),a=this.wot.getSetting("rowHeaders").length,s=this.wot.getSetting("columnHeaders").length,c=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=Object(i.offset)(this.holder),t=o.createRenderCalculators(t),a&&!this.wot.getSetting("fixedColumnsLeft"))){var f=n.leftOverlay.getScrollPosition(),d=this.correctHeaderWidth;this.correctHeaderWidth=f>0,d!==this.correctHeaderWidth&&(t=!1)}if(this.isWorkingOnClone()||(c=n.prepareOverlays()),t)this.isWorkingOnClone()||o.createVisibleCalculators(),n&&n.refresh(!0);else{this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:Object(i.offset)(this.TABLE);var p=void 0;p=h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_DEBUG)||h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_TOP)||h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_TOP_LEFT_CORNER)?0:h.a.isOverlayTypeOf(this.instance.cloneOverlay,h.a.CLONE_BOTTOM)||h.a.isOverlayTypeOf(this.instance.cloneOverlay,h.a.CLONE_BOTTOM_LEFT_CORNER)?Math.max(r-this.wot.getSetting("fixedRowsBottom"),0):o.rowsRenderCalculator.startRow;var v=void 0;v=h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_DEBUG)||h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_LEFT)||h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_TOP_LEFT_CORNER)||h.a.isOverlayTypeOf(this.wot.cloneOverlay,h.a.CLONE_BOTTOM_LEFT_CORNER)?0:o.columnsRenderCalculator.startColumn,this.rowFilter=new u.a(p,r,s),this.columnFilter=new l.a(v,this.wot.getSetting("totalColumns"),a),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(t),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),c&&n.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){new c.a(this).render()}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll("."+t),n=0,o=e.length;n<o;n++)Object(i.removeClass)(e[n],t)}},{key:"refreshSelections",value:function(t){if(this.wot.selections){var e=Array.from(this.wot.selections),n=e.length;if(t){for(var o=[],r=0;r<n;r++){for(var i=e[r].settings,a=i.highlightHeaderClassName,s=i.highlightRowClassName,l=i.highlightColumnClassName,u=e[r].classNames,c=u.length,h=0;h<c;h++)o.includes(u[h])||o.push(u[h]);a&&!o.includes(a)&&o.push(a),s&&!o.includes(s)&&o.push(s),l&&!o.includes(l)&&o.push(l)}for(var f=o.length,d=0;d<f;d++)this.removeClassFromCells(o[d])}for(var p=0;p<n;p++)e[p].draw(this.wot,t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,o=this.wot.getSetting("onModifyGetCellCoords",e,n);if(o&&Array.isArray(o)){var r=d(o,2);e=r[0],n=r[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return i?i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]:void 0}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return e?e.childNodes[0]:void 0}},{key:"getCoords",value:function(t){if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Object(i.closest)(t,["TD","TH"])),null===t)return null;var e=t.parentNode,n=e.parentNode,o=Object(i.index)(e),r=t.cellIndex;return Object(i.overlayContainsElement)(h.a.CLONE_TOP_LEFT_CORNER,t)||Object(i.overlayContainsElement)(h.a.CLONE_TOP,t)?"THEAD"===n.nodeName&&(o-=n.childNodes.length):o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),r=Object(i.overlayContainsElement)(h.a.CLONE_TOP_LEFT_CORNER,t)||Object(i.overlayContainsElement)(h.a.CLONE_LEFT,t)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),new s.a(o,r)}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)<0&&t>=0}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var t=this.wot.wtViewport.columnsRenderCalculator.count,e=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(h.a.CLONE_DEBUG))t=e;else if(this.wot.isOverlayName(h.a.CLONE_LEFT)||this.wot.isOverlayName(h.a.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(h.a.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),e);return t}},{key:"getRenderedRowsCount",value:function(){var t=this.wot.wtViewport.rowsRenderCalculator.count,e=this.wot.getSetting("totalRows");return this.wot.isOverlayName(h.a.CLONE_DEBUG)?t=e:this.wot.isOverlayName(h.a.CLONE_TOP)||this.wot.isOverlayName(h.a.CLONE_TOP_LEFT_CORNER)?t=Math.min(this.wot.getSetting("fixedRowsTop"),e):(this.wot.isOverlayName(h.a.CLONE_BOTTOM)||this.wot.isOverlayName(h.a.CLONE_BOTTOM_LEFT_CORNER))&&(t=Math.min(this.wot.getSetting("fixedRowsBottom"),e)),t}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(t){var e=this.wot.wtSettings.settings.rowHeight(t),n=this.wot.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}},{key:"getColumnHeaderHeight",value:function(t){var e=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(t){var e=this.wot.wtSettings.settings.columnWidth;return"function"==typeof e?e=e(t):"object"===(void 0===e?"undefined":f(e))&&(e=e[t]),e||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var e=this.getColumnWidth(t),n=null==e?this.instance.wtSettings.settings.defaultColumnWidth:e,o=this.wot.wtViewport.columnsRenderCalculator;if(o){var r=o.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"_modifyRowHeaderWidth",value:function(t){var e=Object(a.isFunction)(t)?t():null;return Array.isArray(e)?(e=[].concat(o(e)),e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){return"number"!=typeof t&&(t=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&t++,t}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var n=document.createElement("TH");return e.insertBefore(n,t),e.removeChild(t),n}function i(t,e){var n=document.createElement("TD");return e.insertBefore(n,t),e.removeChild(t),n}var a=n(2),s=n(29),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=!1;e.a=function(){function t(e){o(this,t),this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}return l(t,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var t={};if(this.wot.getSetting("beforeDraw",!0,t),!0===t.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),i=void 0,l=!1;if((s.a.isOverlayTypeOf(this.wot.cloneOverlay,s.a.CLONE_BOTTOM)||s.a.isOverlayTypeOf(this.wot.cloneOverlay,s.a.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),o>=0&&(this.adjustAvailableNodes(),l=!0,this.renderColumnHeaders(),this.renderRows(r,n,e),this.wtTable.isWorkingOnClone()||(i=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(e),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),l||this.adjustAvailableNodes(),this.removeRedundantRows(n),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(s.a.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(s.a.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var u=Object(a.outerWidth)(this.wtTable.hider),c=Object(a.outerWidth)(this.wtTable.TABLE);if(0!==u&&c!==u&&this.adjustColumnWidths(e),i!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var h=this.wtTable.getFirstRenderedColumn(),f=this.wtTable.getLastRenderedColumn(),d=this.wot.getSetting("defaultColumnWidth"),p=this.wot.getSetting("rowHeaderWidth");if(null!=(p=this.instance.getSetting("onModifyRowHeaderWidth",p)))for(var v=0;v<this.rowHeaderCount;v++){var g=Array.isArray(p)?p[v]:p;g=null==g?d:g,this.COLGROUP.childNodes[v].style.width=g+"px"}for(var y=h;y<f;y++){var m=this.wtTable.getStretchedColumnWidth(y);this.COLGROUP.childNodes[this.columnFilter.sourceToRendered(y)+this.rowHeaderCount].style.width=m+"px"}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(t,e,n){for(var o=void 0,r=0,i=this.rowFilter.renderedToSource(r),a=this.wtTable.isWorkingOnClone();i<t&&i>=0&&(!u&&r>1e3&&(u=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===e||r!==e);){if(o=this.getOrCreateTrForRow(r,o),this.renderRowHeaders(i,o),this.adjustColumns(o,n+this.rowHeaderCount),this.renderCells(i,o,n),a&&!this.wot.isOverlayName(s.a.CLONE_BOTTOM)||this.resetOversizedRow(i),o.firstChild){var l=this.wot.wtTable.getRowHeight(i);l?(l--,o.firstChild.style.height=l+"px"):o.firstChild.style.height=""}r++,i=this.rowFilter.renderedToSource(r)}}},{key:"resetOversizedRow",value:function(t){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[t]&&(this.wot.wtViewport.oversizedRows[t]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t=this.instance.wtTable.TBODY.childNodes.length,e=t*this.instance.wtSettings.settings.defaultRowHeight,n=Object(a.innerHeight)(this.instance.wtTable.TBODY)-1,o=void 0,r=void 0,i=void 0,s=void 0,l=void 0;if(this.instance.getSetting("totalRows"),e!==n||this.instance.getSetting("fixedRowsBottom"))for(;t;)t--,i=this.instance.wtTable.rowFilter.renderedToSource(t),o=this.instance.wtTable.getRowHeight(i),s=this.instance.wtTable.getTrForRow(i),l=s.querySelector("th"),r=l?Object(a.innerHeight)(l):Object(a.innerHeight)(s)-1,(!o&&this.instance.wtSettings.settings.defaultRowHeight<r||o<r)&&(this.instance.wtViewport.oversizedRows[i]=++r)}}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]&&!this.wtTable.isWorkingOnClone()){for(var e=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var o=-1*this.rowHeaderCount;o<e;o++)this.markIfOversizedColumnHeader(o);this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot.getSetting("columnHeaders"),e=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,o=0,r=t.length;o<r;o++)if(n[o]){if(!e[o]||0===e[o].childNodes.length)return;e[o].childNodes[0].style.height=n[o]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e=this.wot.wtTable.columnFilter.renderedToSource(t),n=this.columnHeaderCount,o=this.wot.wtSettings.settings.defaultRowHeight,r=void 0,i=void 0,s=void 0,l=this.wot.getSetting("columnHeaderHeight")||[];n;)n--,r=this.wot.wtTable.getColumnHeaderHeight(n),(i=this.wot.wtTable.getColumnHeader(e,n))&&(s=Object(a.innerHeight)(i),(!r&&o<s||r<s)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?null!=l[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.wot.wtViewport.oversizedColumnHeaders[n]=l),this.wot.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"renderCells",value:function(t,e,n){for(var o=void 0,r=void 0,s=0;s<n;s++)r=this.columnFilter.renderedToSource(s),o=0===s?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:o.nextSibling,"TH"==o.nodeName&&(o=i(o,e)),Object(a.hasClass)(o,"hide")||(o.className=""),o.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(t,r,o);return o}},{key:"adjustColumnWidths",value:function(t){var e=0,n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,r=this.wot.getSetting("defaultColumnWidth"),i=this.wot.getSetting("rowHeaderWidth");if(o.offsetHeight<o.scrollHeight&&(e=Object(a.getScrollbarWidth)()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),null!=(i=this.instance.getSetting("onModifyRowHeaderWidth",i)))for(var s=0;s<this.rowHeaderCount;s++){var l=Array.isArray(i)?i[s]:i;l=null==l?r:l,this.COLGROUP.childNodes[s].style.width=l+"px"}for(var u=0;u<t;u++)this.COLGROUP.childNodes[u+this.rowHeaderCount].style.width=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(u))+"px"}},{key:"appendToTbody",value:function(t){this.TBODY.appendChild(t),this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(t,e){var n=void 0;return t>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===t?this.TBODY.firstChild:e.nextSibling,n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var t=document.createElement("TR"),e=0;e<this.rowHeaderCount;e++)t.appendChild(document.createElement("TH"));return t}},{key:"renderRowHeader",value:function(t,e,n){n.className="",n.removeAttribute("style"),this.rowHeaders[e](t,n,e)}},{key:"renderRowHeaders",value:function(t,e){for(var n=e.firstChild,o=0;o<this.rowHeaderCount;o++)n?"TD"==n.nodeName&&(n=r(n,e)):(n=document.createElement("TH"),e.appendChild(n)),this.renderRowHeader(t,o,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var t=this.wtTable.getRenderedColumnsCount(),e=0;e<this.columnHeaderCount;e++)for(var n=this.getTrForColumnHeaders(e),o=-1*this.rowHeaderCount;o<t;o++){var r=this.columnFilter.renderedToSource(o);this.renderColumnHeader(e,r,n.childNodes[o+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var t=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<t+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>t+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&Object(a.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var t=this.wtTable.getRenderedColumnsCount(),e=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,o=this.columnHeaders.length;n<o;n++){for(e=this.THEAD.childNodes[n],e||(e=document.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;this.theadChildrenLength<t+this.rowHeaderCount;)e.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>t+this.rowHeaderCount;)e.removeChild(e.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var i=this.columnHeaders.length;i<r;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else e&&Object(a.empty)(e)}},{key:"getTrForColumnHeaders",value:function(t){return this.THEAD.childNodes[t]}},{key:"renderColumnHeader",value:function(t,e,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[t](e,n,t)}},{key:"adjustColumns",value:function(t,e){for(var n=t.childNodes.length;n<e;)t.appendChild(document.createElement("TD")),n++;for(;n>e;)t.removeChild(t.lastChild),n--}},{key:"removeRedundantColumns",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(1),a=n(8),s=n(187),l=n(188),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){var n=this;o(this,t),this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new a.a(this.wot),this.eventManager.addEventListener(window,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}return u(t,[{key:"getWorkspaceHeight",value:function(){var t=this.instance.wtOverlays.topOverlay.trimmingContainer,e=void 0,n=0;return t===window?n=document.documentElement.clientHeight:(e=Object(r.outerHeight)(t),n=e>0&&t.clientHeight>0?t.clientHeight:1/0),n}},{key:"getWorkspaceWidth",value:function(){var t=void 0,e=this.wot.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,o=void 0,i=this.wot.getSetting("stretchH"),a=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?Object(r.outerWidth)(this.instance.wtTable.wtRootElement):(t=this.wot.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),n===window&&e>0&&this.sumColumnWidths(0,e-1)>t?document.documentElement.clientWidth:n===window||"scroll"!=(o=Object(r.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=o&&"auto"!=o?"none"!==i&&i?t:Math.max(t,Object(r.outerWidth)(this.instance.wtTable.TABLE)):Math.max(t,n.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=0;t<e;)n+=this.wot.wtTable.getColumnWidth(t),t++;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,e=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",t.appendChild(n),e=n.offsetWidth,this.containerWidth=e,t.removeChild(n),e}},{key:"getWorkspaceOffset",value:function(){return Object(r.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Object(r.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return Object(r.outerWidth)(this.wot.wtTable.TABLE)||Object(r.outerWidth)(this.wot.wtTable.TBODY)||Object(r.outerWidth)(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(r.outerHeight)(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight(),e=void 0;return t===1/0?t:(e=this.getColumnHeaderHeight(),e>0&&(t-=e),t)}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),e=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,o=e.length;n<o;n++)this.rowHeaderWidth+=t[n]||t}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(e.length){var i=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,s=e.length;a<s;a++)i?(this.rowHeaderWidth+=Object(r.outerWidth)(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth(),e=void 0;return t===1/0?t:(e=this.getRowHeaderWidth(),e>0?t-e:t)}},{key:"createRowsCalculator",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=void 0,o=void 0,i=void 0,a=void 0,s=void 0,u=void 0,c=void 0;return this.rowHeaderWidth=NaN,n=this.wot.wtSettings.settings.renderAllRows&&!e?1/0:this.getViewportHeight(),o=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),o<0&&(o=0),i=this.wot.getSetting("fixedRowsTop"),s=this.wot.getSetting("fixedRowsBottom"),c=this.wot.getSetting("totalRows"),i&&(u=this.wot.wtOverlays.topOverlay.sumCellSizes(0,i),o+=u,n-=u),s&&this.wot.wtOverlays.bottomOverlay.clone&&(u=this.wot.wtOverlays.bottomOverlay.sumCellSizes(c-s,c),n-=u),a=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:Object(r.getScrollbarWidth)(),new l.a(n,o,this.wot.getSetting("totalRows"),function(e){return t.wot.wtTable.getRowHeight(e)},e?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,e,a)}},{key:"createColumnsCalculator",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getViewportWidth(),o=void 0,i=void 0;if(this.columnHeaderHeight=NaN,o=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),o<0&&(o=0),i=this.wot.getSetting("fixedColumnsLeft")){var a=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i);o+=a,n-=a}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(n-=Object(r.getScrollbarWidth)()),new s.a(n,o,this.wot.getSetting("totalColumns"),function(e){return t.wot.wtTable.getColumnWidth(e)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(e,n){return t.wot.getSetting("onBeforeStretchingColumnWidth",e,n)})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){return!(!this.rowsVisibleCalculator||t.startRow<this.rowsRenderCalculator.startRow||t.startRow===this.rowsRenderCalculator.startRow&&t.startRow>0||t.endRow>this.rowsRenderCalculator.endRow||t.endRow===this.rowsRenderCalculator.endRow&&t.endRow<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){return!(!this.columnsVisibleCalculator||t.startColumn<this.columnsRenderCalculator.startColumn||t.startColumn===this.columnsRenderCalculator.startColumn&&t.startColumn>0||t.endColumn>this.columnsRenderCalculator.endColumn||t.endColumn===this.columnsRenderCalculator.endColumn&&t.endColumn<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(i.objectEach)(this.hasOversizedColumnHeadersMarked,function(t,e,n){n[e]=void 0})}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(11),a=n(1),s=n(33),l=n(8),u=n(60),c=(n(29),function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),n&&(this.eventManager=new l.a(e),this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return h(t,[{key:"registerListeners",value:function(){var t=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return t.onMouseUp()});for(var e=0,n=this.main.childNodes.length;e<n;e++)!function(e,n){t.eventManager.addEventListener(t.main.childNodes[e],"mouseenter",function(n){return t.onMouseEnter(n,t.main.childNodes[e])})}(e)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){function n(t){return t.clientY<Math.floor(a.top)||t.clientY>Math.ceil(a.top+a.height)||t.clientX<Math.floor(a.left)||t.clientX>Math.ceil(a.left+a.width)||void 0}function o(t){n(t)&&(r.eventManager.removeEventListener(document.body,"mousemove",o),e.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Object(i.stopImmediatePropagation)(t);var r=this,a=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",o)}}},{key:"createBorders",value:function(t){this.main=document.createElement("div");var e=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var o=0;o<5;o++){var r=e[o],i=document.createElement("div");i.className="wtBorder "+(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(i.className+=" hidden"),n=i.style,n.backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:t.border.color,n.height=this.settings[r]&&this.settings[r].width?this.settings[r].width+"px":t.border.width+"px",n.width=this.settings[r]&&this.settings[r].width?this.settings[r].width+"px":t.border.width+"px",this.main.appendChild(i)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(s.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var t={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var e in t)Object(a.hasOwnProperty)(t,e)&&(this.selectionHandles.styles.bottomRightHitArea[e]=t[e],this.selectionHandles.styles.topLeftHitArea[e]=t[e]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var o in n)Object(a.hasOwnProperty)(n,o)&&(this.selectionHandles.styles.bottomRight[o]=n[o],this.selectionHandles.styles.topLeft[o]=n[o]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t==n.cellRange.to.row&&e==n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,o,r,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-a,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(o-a,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-s/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(o-s/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+i,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(o+r,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+i-s/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(o+r-s/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t==this.wot.wtSettings.getSetting("fixedRowsTop")||e==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e=void 0,n=void 0,o=void 0,i=void 0,a=this.wot.wtTable.getRenderedRowsCount(),l=0;l<a;l+=1){var h=this.wot.wtTable.rowFilter.renderedToSource(l);if(h>=t[0]&&h<=t[2]){e=h;break}}for(var f=a-1;f>=0;f-=1){var d=this.wot.wtTable.rowFilter.renderedToSource(f);if(d>=t[0]&&d<=t[2]){n=d;break}}for(var p=this.wot.wtTable.getRenderedColumnsCount(),v=0;v<p;v+=1){var g=this.wot.wtTable.columnFilter.renderedToSource(v);if(g>=t[1]&&g<=t[3]){o=g;break}}for(var y=p-1;y>=0;y-=1){var m=this.wot.wtTable.columnFilter.renderedToSource(y);if(m>=t[1]&&m<=t[3]){i=m;break}}if(void 0===e||void 0===o)return void this.disappear();var b=this.wot.wtTable.getCell(new u.a(e,o)),w=e!==n||o!==i,O=w?this.wot.wtTable.getCell(new u.a(n,i)):b,C=Object(r.offset)(b),E=w?Object(r.offset)(O):C,S=Object(r.offset)(this.wot.wtTable.TABLE),k=C.top,T=C.left,R=T-S.left-1,_=E.left+Object(r.outerWidth)(O)-T;if(this.isEntireColumnSelected(e,n)){var j=this.getDimensionsFromHeader("columns",o,i,S),A=null;if(j){var M=c(j,3);A=M[0],R=M[1],_=M[2]}A&&(b=A)}var H=k-S.top-1,P=E.top+Object(r.outerHeight)(O)-k;if(this.isEntireRowSelected(o,i)){var N=this.getDimensionsFromHeader("rows",e,n,S),L=null;if(N){var D=c(N,3);L=D[0],H=D[1],P=D[2]}L&&(b=L)}var x=Object(r.getComputedStyle)(b);parseInt(x.borderTopWidth,10)>0&&(H+=1,P=P>0?P-1:0),parseInt(x.borderLeftWidth,10)>0&&(R+=1,_=_>0?_-1:0),this.topStyle.top=H+"px",this.topStyle.left=R+"px",this.topStyle.width=_+"px",this.topStyle.display="block",this.leftStyle.top=H+"px",this.leftStyle.left=R+"px",this.leftStyle.height=P+"px",this.leftStyle.display="block";var I=Math.floor(this.settings.border.width/2);this.bottomStyle.top=H+P-I+"px",this.bottomStyle.left=R+"px",this.bottomStyle.width=_+"px",this.bottomStyle.display="block",this.rightStyle.top=H+"px",this.rightStyle.left=R+_-I+"px",this.rightStyle.height=P+1+"px",this.rightStyle.display="block";var F=this.settings.border.cornerVisible;if(F="function"==typeof F?F(this.settings.layerLevel):F,Object(s.isMobileBrowser)()||!F)this.cornerStyle.display="none";else{this.cornerStyle.top=H+P-4+"px",this.cornerStyle.left=R+_-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var B=Object(r.getTrimmingContainer)(this.wot.wtTable.TABLE);i===this.wot.getSetting("totalColumns")-1&&O.offsetLeft+Object(r.outerWidth)(O)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(r.innerWidth)(B)&&(this.cornerStyle.left=Math.floor(R+_-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0),n===this.wot.getSetting("totalRows")-1&&O.offsetTop+Object(r.outerHeight)(O)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(r.innerHeight)(B)&&(this.cornerStyle.top=Math.floor(H+P-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(s.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(e,o,H,R,_,P)}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,o){var i=this,a=this.wot.wtTable.wtRootElement.parentNode,s=null,l=null,u=null,c=null,h=null,f=null,d=null,p=null;switch(t){case"rows":s=function(){var t;return(t=i.wot.wtTable).getRowHeader.apply(t,arguments)},l=function(){return r.outerHeight.apply(void 0,arguments)},u="ht__selection--rows",f="top";break;case"columns":s=function(){var t;return(t=i.wot.wtTable).getColumnHeader.apply(t,arguments)},l=function(){return r.outerWidth.apply(void 0,arguments)},u="ht__selection--columns",f="left"}if(a.className.includes(u)){if(d=s(e,0),p=s(n,0),!d||!p)return!1;var v=Object(r.offset)(d),g=Object(r.offset)(p);return d&&p&&(c=v[f]-o[f]-1,h=g[f]+l(p)-v[f]),[d,c,h]}return!1}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Object(s.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}]),t}()},function(t,e,n){"use strict";function o(t){h=!1;var e=this.getActiveEditor();if(Object(r.isPrintableChar)(t.keyCode)||t.keyCode===r.KEY_CODES.BACKSPACE||t.keyCode===r.KEY_CODES.DELETE||t.keyCode===r.KEY_CODES.INSERT){var n=0;if(t.keyCode===r.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;e.isOpened()||(n+=10),e.htEditor&&e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value),h=!0},n))}}var r=n(18),i=n(14),a=n(30),s=n(0),l=n(2),u=n(201),c=u.a.prototype.extend();c.prototype.init=function(){u.a.prototype.init.apply(this,arguments),this.query=null,this.strippedChoices=[],this.rawChoices=[]},c.prototype.getValue=function(){var t=this,e=this.rawChoices.find(function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value});return Object(i.isDefined)(e)?e:this.TEXTAREA.value},c.prototype.createElements=function(){u.a.prototype.createElements.apply(this,arguments),Object(l.addClass)(this.htContainer,"autocompleteEditor"),Object(l.addClass)(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var h=!1;c.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",o),u.a.prototype.prepare.apply(this,arguments)},c.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",u.a.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var t=this.htEditor.getInstance(),e=this,n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),t.updateSettings({colWidths:n?[Object(l.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?Object(l.outerWidth)(this.TEXTAREA)+Object(l.getScrollbarWidth)()+2:void 0,afterRenderer:function(t,n,o,r,a,s){var l=e.cellProperties,u=l.filteringCaseSensitive,c=l.allowHtml,h=void 0,f=void 0;a=Object(i.stringify)(a),a&&!c&&-1!==(h=!0===u?a.indexOf(this.query):a.toLowerCase().indexOf(e.query.toLowerCase()))&&(f=a.substr(h,e.query.length),a=a.replace(f,"<strong>"+f+"</strong>")),t.innerHTML=a},autoColumnSize:!0,modifyColWidth:function(t,e){var o=this.getPlugin("autoColumnSize").widths;return o[e]&&(t=o[e]),n?t:t+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=Object(l.getScrollbarWidth)()+2+"px",h&&(h=!1),e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value)},0))},c.prototype.close=function(){u.a.prototype.close.apply(this,arguments)},c.prototype.queryChoices=function(t){var e=this;this.query=t;var n=this.cellProperties.source;"function"==typeof n?n.call(this.cellProperties,t,function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])},c.prototype.updateChoicesList=function(t){var e=Object(l.getCaretPosition)(this.TEXTAREA),n=Object(l.getSelectionEndPosition)(this.TEXTAREA),o=this.cellProperties.sortByRelevance,r=this.cellProperties.filter,i=null,a=null;o&&(i=c.sortByRelevance(this.stripValueIfNeeded(this.getValue()),t,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(i)?i.length:0;if(!1===r)u&&(a=i[0]);else{for(var h=[],f=0,d=t.length;f<d&&!(o&&u<=f);f++)h.push(u?t[i[f]]:t[f]);a=0,t=h}this.strippedChoices=t,this.htEditor.loadData(Object(s.pivot)([t])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.instance.listen(!1),Object(l.setCaretPosition)(this.TEXTAREA,e,e===n?void 0:n)},c.prototype.flipDropdownIfNeeded=function(){var t=Object(l.offset)(this.TEXTAREA),e=Object(l.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),o=Object(l.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE),r=o.scrollTop,i=Object(l.outerHeight)(this.instance.view.wt.wtTable.THEAD),a={row:0,col:0};o!==window&&(a=Object(l.offset)(o));var s=t.top-a.top-i+r,u=o.scrollHeight-s-i-e,c=n>u&&s>u;return c?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(c?s:u,n),c},c.prototype.limitDropdownIfNeeded=function(t,e){if(e>t){var n=0,o=0,r=0,i=null;do{r=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,n+=r,o++}while(n<t);i=n-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-i+"px"),this.setDropdownHeight(n-r)}},c.prototype.flipDropdown=function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0},c.prototype.unflipDropdown=function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0},c.prototype.updateDropdownHeight=function(){var t=this.htEditor.getColWidth(0)+Object(l.getScrollbarWidth)()+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},c.prototype.setDropdownHeight=function(t){this.htEditor.updateSettings({height:t})},c.prototype.finishEditing=function(t){t||this.instance.removeHook("beforeKeyDown",o),u.a.prototype.finishEditing.apply(this,arguments)},c.prototype.highlightBestMatchingChoice=function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()},c.sortByRelevance=function(t,e,n){var o=[],r=void 0,s=t.length,l=void 0,u=void 0,c=[],h=void 0,f=e.length;if(0===s){for(h=0;h<f;h++)c.push(h);return c}for(h=0;h<f;h++)r=Object(a.stripTags)(Object(i.stringify)(e[h])),-1!==(l=n?r.indexOf(t):r.toLowerCase().indexOf(t.toLowerCase()))&&(u=r.length-l-s,o.push({baseIndex:h,index:l,charsLeft:u,value:r}));for(o.sort(function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0}),h=0,f=o.length;h<f;h++)c.push(o[h].baseIndex);return c},c.prototype.getDropdownHeight=function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8},c.prototype.stripValueIfNeeded=function(t){return this.stripValuesIfNeeded([t])[0]},c.prototype.stripValuesIfNeeded=function(t){var e=this.cellProperties.allowHtml,n=Object(s.arrayMap)(t,function(t){return Object(i.stringify)(t)});return Object(s.arrayMap)(n,function(t){return e?t:Object(a.stripTags)(t)})},c.prototype.allowKeyEventPropagation=function(t){var e=this.htEditor.getSelectedRangeLast(),n={row:e?e.from.row:-1},o=!1;return t===r.KEY_CODES.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(o=!0),t===r.KEY_CODES.ARROW_UP&&n.row>-1&&(o=!0),o},c.prototype.discardEditor=function(t){u.a.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},e.a=c},function(t,e,n){"use strict";var o=n(18),r=n(1),i=n(2),a=n(11),s=n(62),l=s.a.prototype.extend();l.prototype.createElements=function(){s.a.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()},l.prototype.prepare=function(t,e,n,o,i,a){s.a.prototype.prepare.apply(this,arguments);var l=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()}};this.cellProperties.handsontable&&Object(r.extend)(u,a.handsontable),this.htOptions=u};var u=function(t){if(!Object(a.isImmediatePropagationStopped)(t)){var e,n,r=this.getActiveEditor(),i=r.htEditor.getInstance();if(t.keyCode==o.KEY_CODES.ARROW_DOWN)if(i.getSelectedLast()||i.flipped){if(i.getSelectedLast())if(i.flipped)e=i.getSelectedLast()[0]+1;else if(!i.flipped){n=i.getSelectedLast()[0];var s=i.countRows()-1;e=Math.min(s,n+1)}}else e=0;else t.keyCode==o.KEY_CODES.ARROW_UP&&(!i.getSelectedLast()&&i.flipped?e=i.countRows()-1:i.getSelectedLast()&&(i.flipped?(n=i.getSelectedLast()[0],e=Math.max(0,n-1)):(n=i.getSelectedLast()[0],e=n-1)));void 0!==e&&(e<0||i.flipped&&e>i.countRows()-1?i.deselectCell():i.selectCell(e,0),i.getData().length&&(t.preventDefault(),Object(a.stopImmediatePropagation)(t),r.instance.listen(),r.TEXTAREA.focus()))}};l.prototype.open=function(){this.instance.addHook("beforeKeyDown",u),s.a.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),Object(i.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)},l.prototype.close=function(){this.instance.removeHook("beforeKeyDown",u),this.instance.listen(),s.a.prototype.close.apply(this,arguments)},l.prototype.focus=function(){this.instance.listen(),s.a.prototype.focus.apply(this,arguments)},l.prototype.beginEditing=function(t){var e=this.instance.getSettings().onBeginEditing;e&&!1===e()||s.a.prototype.beginEditing.apply(this,arguments)},l.prototype.finishEditing=function(t,e){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return s.a.prototype.finishEditing.apply(this,arguments)},l.prototype.assignHooks=function(){var t=this;this.instance.addHook("afterDestroy",function(){t.htEditor&&t.htEditor.destroy()})},e.a=l},function(t,e,n){"use strict";function o(t){var e=new Date(t);return isNaN(new Date(t+"T00:00").getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}Object.defineProperty(e,"__esModule",{value:!0}),e.getNormalizedDate=o},function(t,e,n){!function(t){"use strict";function n(t){return t.split('"').length-1}var o={parse:function(t){var e,o,r,i,a,s,l,u=[],c=0;for(r=t.split("\n"),r.length>1&&""===r[r.length-1]&&r.pop(),e=0,o=r.length;e<o;e+=1){for(r[e]=r[e].split("\t"),i=0,a=r[e].length;i<a;i+=1)u[c]||(u[c]=[]),s&&0===i?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+r[e][0],s&&1&n(r[e][0])&&(s=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):i===a-1&&0===r[e][i].indexOf('"')&&1&n(r[e][i])?(u[c].push(r[e][i].substring(1).replace(/""/g,'"')),s=!0):(u[c].push(r[e][i].replace(/""/g,'"')),s=!1);s||(c+=1)}return u},stringify:function(t){var e,n,o,r,i,a="";for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,o=0;o<r;o+=1)o>0&&(a+="\t"),i=t[e][o],"string"==typeof i?i.indexOf("\n")>-1?a+='"'+i.replace(/"/g,'""')+'"':a+=i:a+=null===i||void 0===i?"":i;e!==n-1&&(a+="\n")}return a}};e.parse=o.parse,e.stringify=o.stringify}(window)},function(t,e,n){"use strict";function o(t){a.set(t,!0)}function r(t){return t===s}function i(t){return a.has(t)}n.d(e,"d",function(){return s}),e.c=o,e.a=r,e.b=i;var a=new WeakMap,s=Symbol("rootInstance")},function(t,e,n){"use strict";function o(){}var r=n(14),i=n(1),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};o.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(t){var e,n,o,s;for(e=0,n=this.countCols();e<n;e++)if(""!==(o=this.getDataAtCell(t,e))&&null!==o&&Object(r.isDefined)(o))return"object"===(void 0===o?"undefined":a(o))&&(s=this.getCellMeta(t,e),Object(i.isObjectEquals)(this.getSchema()[s.prop],o));return!0},isEmptyCol:function(t){var e,n,o;for(e=0,n=this.countRows();e<n;e++)if(""!==(o=this.getDataAtCell(e,t))&&null!==o&&Object(r.isDefined)(o))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0},e.a=o},function(t,e,n){"use strict";function o(t,e,n){var o=Object(a.b)(t);if(null===o)return null;var i=o[e];if(Object(l.isUndefined)(i))return null;var s=r(i,n);return Array.isArray(s)?s[0]:s}function r(t,e){var n=t;return Object(i.arrayEach)(Object(s.a)(),function(o){n=o(t,e)}),n}e.a=o;var i=n(0),a=n(82),s=n(309),l=n(14)},function(t,e,n){"use strict";function o(t,e){return Object(l.objectEach)(e,function(e,n){Object(s.isUndefined)(t[n])&&(t[n]=e)}),t}function r(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=e.exec(t);return n?n[1].toLowerCase()+"-"+n[2].toUpperCase():t}function i(t,e){var n=r(e);Object(c.d)(n)?t.language=n:(t.language=c.a,a(e))}function a(t){Object(s.isDefined)(t)&&console.error(Object(u.a)(h,t))}e.b=o,e.c=r,e.a=i,e.d=a;var s=n(14),l=n(1),u=n(61),c=n(82),h=function(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])},function(t,e,n){"use strict";function o(){0===h&&(u.addEventListener(document,"keydown",function(t){c.has(t.keyCode)||c.add(t.keyCode)}),u.addEventListener(document,"keyup",function(t){c.has(t.keyCode)&&c.delete(t.keyCode)}),u.addEventListener(document,"visibilitychange",function(){document.hidden&&c.clear()})),h+=1}function r(){h>0&&(h-=1),0===h&&i()}function i(){u.clearEvents(),c.clear(),h=0}function a(){return Array.from(c.values()).some(function(t){return Object(l.isCtrlMetaKey)(t)})}n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r});var s=n(8),l=n(18),u=(n(0),new s.a),c=new Set,h=0},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"b",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return c});var i=n(312),a=n(0),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l="cell",u="area",c="header";e.d=function(){function t(e){r(this,t),this.options=e,this.layerLevel=0,this.cell=Object(i.a)(l,e),this.fill=Object(i.a)("fill",e),this.areas=new Map,this.headers=new Map,this.borders=[]}return s(t,[{key:"isEnabledFor",value:function(t){var e=this.options.disableHighlight;return"current"===t&&(t=l),"string"==typeof e&&(e=[e]),!1===e||Array.isArray(e)&&!e.includes(t)}},{key:"useLayerLevel",value:function(){return this.layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t=this.layerLevel,e=void 0;return this.areas.has(t)?e=this.areas.get(t):(e=Object(i.a)(u,Object.assign({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return[].concat(o(this.areas.values()))}},{key:"createOrGetHeader",value:function(){var t=void 0,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=Object(i.a)(c,Object.assign({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return[].concat(o(this.headers.values()))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(a.arrayEach)(this.areas.values(),function(t){t.clear()}),Object(a.arrayEach)(this.headers.values(),function(t){t.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell].concat(o(this.areas.values()),o(this.headers.values()),[this.fill],o(this.borders))[Symbol.iterator]()}}]),t}()},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(1),a=n(4),s=n(14),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){r(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return l(t,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),l(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var o=this,r=new Map;return"number"==typeof n&&(n={from:n,to:n}),Object(a.rangeEach)(n.from,n.to,function(n){var i=o.generateSample(t,e,n);r.set(n,i)}),r}},{key:"generateSample",value:function(t,e,n){var r=this,l=new Map,u=[],c=void 0;return Object(a.rangeEach)(e.from,e.to,function(e){var a=void 0;if("row"===t)a=r.dataFactory(n,e);else{if("col"!==t)throw new Error("Unsupported sample type");a=r.dataFactory(e,n)}c=Object(i.isObject)(a)?Object.keys(a).length:Array.isArray(a)?a.length:Object(s.stringify)(a).length,l.has(c)||l.set(c,{needed:r.getSampleCount(),strings:[]});var h=l.get(c);h.needed&&(u.indexOf(a)>-1&&!r.allowDuplicates||(h.strings.push(o({value:a},"row"===t?"col":"row",e)),u.push(a),h.needed--))}),l}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var n=void 0;return Object(i.arrayEach)(e,function(e){var o=e.key?e.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=e,!1}),n}var i=n(0),a=n(1),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.hot=e,this.commands={},this.commonCallback=null}return s(t,[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];var l=t.split(":");t=l[0];var u=2===l.length?l[1]:null,c=this.commands[t];if(!c)throw new Error("Menu command '"+t+"' not exists.");if(u&&c.submenu&&(c=r(u,c.submenu.items)),!0!==c.disabled&&("function"!=typeof c.disabled||!0!==c.disabled.call(this.hot))&&!Object(a.hasOwnProperty)(c,"submenu")){var h=[];"function"==typeof c.callback&&h.push(c.callback),"function"==typeof this.commonCallback&&h.push(this.commonCallback),o.unshift(l.join(":")),Object(i.arrayEach)(h,function(t){return t.apply(e.hot,o)})}}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[];return t&&t.items?t=t.items:Array.isArray(t)||(t=e),Object(i.isObject)(t)?Object(i.objectEach)(t,function(t,e){var r=n["string"==typeof t?t:e];r||(r=t),Object(i.isObject)(t)?Object(i.extend)(r,t):"string"==typeof r&&(r={name:r}),void 0===r.key&&(r.key=e),o.push(r)}):Object(a.arrayEach)(t,function(t,e){var r=n[t];!r&&s.e.indexOf(t)>=0||(r||(r={name:t,key:""+e}),Object(i.isObject)(t)&&Object(i.extend)(r,t),void 0===r.key&&(r.key=e),o.push(r))}),o}var i=n(1),a=n(0),s=n(43),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o(this,t),this.hot=e,this.predefinedItems=Object(s.n)(),this.defaultOrderPattern=n}return l(t,[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,Object(i.objectEach)(t,function(t,o){var r="";t.name===s.l?(n[s.l]=t,r=s.l):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,n[o]=t,r=t.key):(n[t.key]=t,r=t.key),e.defaultOrderPattern.push(r)}),this.predefinedItems=n}},{key:"getItems",value:function(){return r(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}]),t}()},function(t,e,n){"use strict";function o(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:s+":left",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htLeft"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htLeft"),Object(r.a)(e,"horizontal","htLeft",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1},{key:s+":center",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htCenter"))return!0})&&(e=Object(r.k)(e)),e},callback:function(t,e){var n=this,o=this.getSelectedRange(),i=Object(r.d)(o,function(t,e){return n.getCellMeta(t,e).className});this.runHooks("beforeCellAlignment",i,o,"horizontal","htCenter"),Object(r.a)(o,"horizontal","htCenter",function(t,e){return n.getCellMeta(t,e)},function(t,e,o,r){return n.setCellMeta(t,e,o,r)}),this.render()},disabled:!1},{key:s+":right",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htRight"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htRight"),Object(r.a)(e,"horizontal","htRight",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1},{key:s+":justify",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htJustify"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htJustify"),Object(r.a)(e,"horizontal","htJustify",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1},{name:i.a},{key:s+":top",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htTop"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htTop"),Object(r.a)(e,"vertical","htTop",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1},{key:s+":middle",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htMiddle"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htMiddle"),Object(r.a)(e,"vertical","htMiddle",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1},{key:s+":bottom",name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return Object(r.b)(this.getSelectedRange(),function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htBottom"))return!0})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.d)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htBottom"),Object(r.a)(e,"vertical","htBottom",function(e,n){return t.getCellMeta(e,n)},function(e,n,o,r){return t.setCellMeta(e,n,o,r)}),this.render()},disabled:!1}]}}}n.d(e,"a",function(){return s}),e.b=o;var r=n(23),i=n(83),a=n(3),s="alignment"},function(t,e,n){"use strict";function o(){return{key:s,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=Object(r.e)(this);if(!t)return!0;var e=a(t[0],4),n=e[0],o=e[1],i=e[2],s=[n,0,i,this.countCols()-1],l=s.join(",")===t.join(",");return o<0||this.countCols()>=this.getSettings().maxCols||l}}}n.d(e,"a",function(){return s}),e.b=o;var r=n(23),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="clear_column"},function(t,e,n){"use strict";function o(){return{key:s,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){this.alter("insert_col",e[Math.max(e.length-1,0)].start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=Object(r.e)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=a(t[0],4),n=e[0],o=e[1],i=e[2],s=[n,0,i,this.countCols()-1],l=s.join(",")===t.join(","),u=1===this.countCols();return o<0||this.countCols()>=this.getSettings().maxCols||!u&&l},hidden:function(){return!this.getSettings().allowInsertColumn}}}n.d(e,"a",function(){return s}),e.b=o;var r=n(23),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="col_left"},function(t,e,n){"use strict";function o(){return{key:s,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){this.alter("insert_col",e[Math.max(e.length-1,0)].end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=Object(r.e)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=a(t[0],4),n=e[0],o=e[1],i=e[2],s=[n,0,i,this.countCols()-1],l=s.join(",")===t.join(","),u=1===this.countCols();return o<0||this.countCols()>=this.getSettings().maxCols||!u&&l},hidden:function(){return!this.getSettings().allowInsertColumn}}}n.d(e,"a",function(){return s}),e.b=o;var r=n(23),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="col_right"},function(t,e,n){"use strict";function o(){return{key:s,name:function(){var t=this,e=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_READ_ONLY);return Object(r.b)(this.getSelectedRange(),function(e,n){return t.getCellMeta(e,n).readOnly})&&(e=Object(r.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(r.b)(e,function(e,n){return t.getCellMeta(e,n).readOnly});Object(i.arrayEach)(e,function(e){e.forAll(function(e,o){t.setCellMeta(e,o,"readOnly",!n)})}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}n.d(e,"a",function(){return s}),e.b=o;var r=n(23),i=n(0),a=n(3),s="make_read_only"},function(t,e,n){"use strict";function o(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}n.d(e,"a",function(){return i}),e.b=o;var r=n(3),i="redo"},function(t,e,n){"use strict";function o(){return{key:l,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=s(t[0],4),o=n[1],r=n[3];o-r!=0&&(e=1)}return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",Object(i.a)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var t=Object(r.e)(this),e=this.countCols();return!t||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}n.d(e,"a",function(){return l}),e.b=o;var r=n(23),i=(n(0),n(220)),a=n(3),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="remove_col"},function(t,e,n){"use strict";function o(t){var e=void 0;if(t.length){var n=t[0];Array.isArray(n)?e=c:n instanceof s.b&&(e=h)}return e}function r(t){if(!f.includes(t))throw new Error("Unsupported selection ranges data type was provided.");return function(e){var n=t===h,o=n?e.from.row:e[0],r=n?e.from.col:e[1],i=n?e.to.row:e[2],a=n?e.to.col:e[3];return[Math.min(o,i),Math.min(r,a),Math.max(o,i),Math.max(r,a)]}}function i(t){var e=o(t);if(!e)return[];var n=r(e),i=new Set;Object(l.arrayEach)(t,function(t){var e=n(t),o=u(e,4),r=o[1],a=o[3],s=a-r+1;Object(l.arrayEach)(Array.from(new Array(s),function(t,e){return r+e}),function(t){i.has(t)||i.add(t)})});var a=Array.from(i).sort(function(t,e){return t-e});return Object(l.arrayReduce)(a,function(t,e,n,o){return 0!==n&&e===o[n-1]+1?t[t.length-1][1]++:t.push([e,1]),t},[])}function a(t){var e=o(t);if(!e)return[];var n=r(e),i=new Set;Object(l.arrayEach)(t,function(t){var e=n(t),o=u(e,3),r=o[0],a=o[2],s=a-r+1;Object(l.arrayEach)(Array.from(new Array(s),function(t,e){return r+e}),function(t){i.has(t)||i.add(t)})});var a=Array.from(i).sort(function(t,e){return t-e});return Object(l.arrayReduce)(a,function(t,e,n,o){return 0!==n&&e===o[n-1]+1?t[t.length-1][1]++:t.push([e,1]),t},[])}e.a=i,e.b=a;var s=n(9),l=n(0),u=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c="array",h="object",f=[h,c]},function(t,e,n){"use strict";function o(){return{key:l,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=s(t[0],3),o=n[0],r=n[2];o-r!=0&&(e=1)}return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",Object(i.b)(this.getSelected()),null,"ContextMenu.removeRow")},disabled:function(){var t=Object(r.e)(this),e=this.countRows();return!t||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!e},hidden:function(){return!this.getSettings().allowRemoveRow}}}n.d(e,"a",function(){return l}),e.b=o;var r=n(23),i=(n(0),n(220)),a=n(3),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="remove_row"},function(t,e,n){"use strict";function o(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){this.alter("insert_row",e[Math.max(e.length-1,0)].start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!Object(r.e)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}n.d(e,"a",function(){return a}),e.b=o;var r=n(23),i=n(3),a="row_above"},function(t,e,n){"use strict";function o(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){this.alter("insert_row",e[Math.max(e.length-1,0)].end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!Object(r.e)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}n.d(e,"a",function(){return a}),e.b=o;var r=n(23),i=n(3),a="row_below"},function(t,e,n){"use strict";function o(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}n.d(e,"a",function(){return i}),e.b=o;var r=n(3),i="undo"},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(4),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=0;e.a=function(){function t(e){o(this,t),this.hot=e,this._element=null,this.state=a}return i(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=a}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){Object(r.isNumeric)(t)&&(this._element.style.top=t+"px"),Object(r.isNumeric)(e)&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){Object(r.isNumeric)(t)&&(this._element.style.width=t+"px"),Object(r.isNumeric)(e)&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){Object(r.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),Object(r.isNumeric)(e)&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=0;e.a=function(){function t(e){o(this,t),this.hot=e,this._element=null,this.state=i}return r(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=i}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}()},function(t,e,n){"use strict";function o(t,e,n,o){e?e.row===n&&e.col===o?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}e.a=o},function(t,e,n){var o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=Error;!function(t){function e(t,n){switch(void 0===t?"undefined":r(t)){case"undefined":case"boolean":case"string":case"number":return t===n;case"object":if(null===t)return null===n;if(R(t)){if(!R(n)||t.length!==n.length)return!1;for(var o=0,i=t.length;o<i;o++)if(!e(t[o],n[o]))return!1;return!0}var a=w(n),s=a.length;if(w(t).length!==s)return!1;for(var o=0;o<s;o++)if(!e(t[o],n[o]))return!1;return!0;default:return!1}}function n(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function o(t){for(var e=0,n=S.length;e<n;e++)if(S[e].obj===t)return S[e]}function s(t,e){for(var n=0,o=t.observers.length;n<o;n++)if(t.observers[n].callback===e)return t.observers[n].observer}function l(t,e){for(var n=0,o=t.observers.length;n<o;n++)if(t.observers[n].observer===e)return void t.observers.splice(n,1)}function u(t,e){e.unobserve()}function c(t){return"object"===(void 0===t?"undefined":r(t))?JSON.parse(JSON.stringify(t)):t}function h(t,e){var n,r=[],i=o(t);if(i?n=s(i,e):(i=new k(t),S.push(i)),n)return n;if(n={},i.value=c(t),e){n.callback=e,n.next=null;var u=this.intervals||[100,1e3,1e4,6e4];if(void 0===u.push)throw new a("jsonpatch.intervals must be an array");var h=0,d=function(){f(n)},p=function(){clearTimeout(n.next),n.next=setTimeout(function(){d(),h=0,n.next=setTimeout(v,u[h++])},0)},v=function t(){d(),h==u.length&&(h=u.length-1),n.next=setTimeout(t,u[h++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",p),window.addEventListener("mouseup",p),window.addEventListener("keydown",p)):(document.documentElement.attachEvent("onmousedown",p),document.documentElement.attachEvent("onmouseup",p),document.documentElement.attachEvent("onkeydown",p))),n.next=setTimeout(v,u[h++])}return n.patches=r,n.object=t,n.unobserve=function(){f(n),clearTimeout(n.next),l(i,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",p),window.removeEventListener("mouseup",p),window.removeEventListener("keydown",p)):(document.documentElement.detachEvent("onmousedown",p),document.documentElement.detachEvent("onmouseup",p),document.documentElement.detachEvent("onkeydown",p)))},i.observers.push(new T(e,n)),n}function f(t){for(var e,n=0,o=S.length;n<o;n++)if(S[n].obj===t.object){e=S[n];break}d(e.value,t.object,t.patches,""),t.patches.length&&v(e.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function d(t,e,o,i){for(var a=w(e),s=w(t),l=!1,u=s.length-1;u>=0;u--){var h=s[u],f=t[h];if(e.hasOwnProperty(h)){var p=e[h];"object"==(void 0===f?"undefined":r(f))&&null!=f&&"object"==(void 0===p?"undefined":r(p))&&null!=p?d(f,p,o,i+"/"+n(h)):f!=p&&o.push({op:"replace",path:i+"/"+n(h),value:c(p)})}else o.push({op:"remove",path:i+"/"+n(h)}),l=!0}if(l||a.length!=s.length)for(var u=0;u<a.length;u++){var h=a[u];t.hasOwnProperty(h)||o.push({op:"add",path:i+"/"+n(h),value:c(e[h])})}}function p(t){for(var e,n=0,o=t.length;n<o;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function v(t,e,n){for(var o,r,i=!1,a=0,s=e.length;a<s;){o=e[a],a++;for(var l=o.path||"",u=l.split("/"),c=t,h=1,f=u.length,d=void 0;;){if(r=u[h],n&&void 0===d&&(void 0===c[r]?d=u.slice(0,h).join("/"):h==f-1&&(d=o.path),void 0!==d&&this.validator(o,a-1,t,d)),h++,void 0===r&&h>=f){i=E[o.op].call(o,c,r,t);break}if(R(c)){if("-"===r)r=c.length;else{if(n&&!p(r))throw new _("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,o.path,o);r=parseInt(r,10)}if(h>=f){if(n&&"add"===o.op&&r>c.length)throw new _("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,o.path,o);i=C[o.op].call(o,c,r,t);break}}else if(r&&-1!=r.indexOf("~")&&(r=r.replace(/~1/g,"/").replace(/~0/g,"~")),h>=f){i=O[o.op].call(o,c,r,t);break}c=c[r]}}return i}function g(t,e){var n=[];return d(t,e,n,""),n}function y(t){if(void 0===t)return!0;if("array"==typeof t||"object"==(void 0===t?"undefined":r(t)))for(var e in t)if(y(t[e]))return!0;return!1}function m(e,n,o,i){if("object"!==(void 0===e?"undefined":r(e))||null===e||R(e))throw new _("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,e,o);if(!O[e.op])throw new _("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,e,o);if("string"!=typeof e.path)throw new _("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,e,o);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new _("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new _("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&y(e.value))throw new _("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,e,o);if(o)if("add"==e.op){var a=e.path.split("/").length,s=i.split("/").length;if(a!==s+1&&a!==s)throw new _("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,e,o)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new _("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,e,o)}else if("move"===e.op||"copy"===e.op){var l={op:"_get",path:e.from,value:void 0},u=t.validate([l],o);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new _("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,e,o)}}function b(t,e){try{if(!R(t))throw new _("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),v.call(this,e,t,!0);else for(var n=0;n<t.length;n++)this.validator(t[n],n)}catch(t){if(t instanceof _)return t;throw t}}var w=function(t){if(R(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(o);return e},O={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,n){var o={op:"_get",path:this.from};return v(n,[o]),v(n,[{op:"remove",path:this.from}]),v(n,[{op:"add",path:this.path,value:o.value}]),!0},copy:function(t,e,n){var o={op:"_get",path:this.from};return v(n,[o]),v(n,[{op:"add",path:this.path,value:o.value}]),!0},test:function(t,n){return e(t[n],this.value)},_get:function(t,e){this.value=t[e]}},C={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:O.move,copy:O.copy,test:O.test,_get:O._get},E={add:function(t){E.remove.call(this,t);for(var e in this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&O.remove.call(this,t,e);return!0},replace:function(t){return v(t,[{op:"remove",path:this.path}]),v(t,[{op:"add",path:this.path,value:this.value}]),!0},move:O.move,copy:O.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}},S=[],k=function(){function t(t){this.observers=[],this.obj=t}return t}(),T=function(){function t(t,e){this.callback=t,this.observer=e}return t}();t.unobserve=u,t.observe=h,t.generate=f;var R;R=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=v,t.compare=g;var _=function(t){function e(e,n,o,r,i){t.call(this,e),this.message=e,this.name=n,this.index=o,this.operation=r,this.tree=i}return i(e,t),e}(a);t.JsonPatchError=_,t.Error=_,t.validator=m,t.validate=b}(o||(o={})),e.apply=o.apply,e.observe=o.observe,e.unobserve=o.unobserve,e.generate=o.generate,e.compare=o.compare,e.validate=o.validate,e.validator=o.validator,e.JsonPatchError=o.JsonPatchError,e.Error=o.Error},function(t,e,n){"use strict";function o(t){return""===t.value||null===t.value||void 0===t.value}n.d(e,"a",function(){return a});var r=n(3),i=n(10),a="empty";Object(i.c)(a,o,{name:r.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=s(e,1),o=n[0];return Object(i.stringify)(t.value).toLowerCase()===Object(i.stringify)(o)}n.d(e,"a",function(){return l});var r=n(3),i=n(14),a=n(10),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="eq";Object(a.c)(l,o,{name:r.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=l(e,2),o=n[0],r=n[1];if("numeric"===t.meta.type){var u=parseFloat(o,10),c=parseFloat(r,10);o=Math.min(u,c),r=Math.max(u,c)}else if("date"===t.meta.type){var h=Object(i.a)(s.a,[r]),f=Object(i.a)(a.a,[o]);return h(t)&&f(t)}return t.value>=o&&t.value<=r}n.d(e,"a",function(){return u});var r=n(3),i=n(10),a=n(232),s=n(233),l=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="between";Object(i.c)(u,o,{name:r.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=l(e,1),o=n[0],r=i()(t.value,t.meta.dateFormat),a=i()(o,t.meta.dateFormat);return!(!r.isValid()||!a.isValid())&&r.diff(a)>=0}n.d(e,"a",function(){return u});var r=n(31),i=n.n(r),a=n(3),s=n(10),l=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="date_after";Object(s.c)(u,o,{name:a.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=l(e,1),o=n[0],r=i()(t.value,t.meta.dateFormat),a=i()(o,t.meta.dateFormat);return!(!r.isValid()||!a.isValid())&&r.diff(a)<=0}n.d(e,"a",function(){return u});var r=n(31),i=n.n(r),a=n(3),s=n(10),l=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="date_before";Object(s.c)(u,o,{name:a.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=s(e,1),o=n[0];return Object(i.stringify)(t.value).toLowerCase().indexOf(Object(i.stringify)(o))>=0}n.d(e,"a",function(){return l});var r=n(3),i=n(14),a=n(10),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="contains";Object(a.c)(l,o,{name:r.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t,e){return t.some(function(t){return t.func(e)})}n.d(e,"a",function(){return a});var r=n(3),i=n(64),a="disjunction",s=r.FILTERS_LABELS_DISJUNCTION;Object(i.d)(a,s,o)},function(t,e,n){"use strict";function o(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(t){return t.func(e)})&&t[t.length-1].func(e)}n.d(e,"a",function(){return a});var r=n(3),i=n(64),a="disjunctionAndVariable",s=r.FILTERS_LABELS_DISJUNCTION;Object(i.d)(a,s,o)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(1),a=n(61),s=n(21),l=n(10),u=n(158),c=n(64),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\` \n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`, \n        use it consequently for a particular column)."]),d=function(){function t(){o(this,t),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}return h(t,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(t,e){var n=this,o=!0;if(void 0===e)Object(i.objectEach)(this.columnTypes,function(e,r){return o=n.isMatchInConditions(n.conditions[e][r],t,e)});else{var r=this.columnTypes[e];o=this.isMatchInConditions(this.getConditions(e),t,r)}return o}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.a;return!t.length||Object(c.a)(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.a,o=Object(r.arrayMap)(e.args,function(t){return"string"==typeof t?t.toLowerCase():t}),i=e.name||e.command.key;this.runLocalHooks("beforeAdd",t),-1===this.orderStack.indexOf(t)&&this.orderStack.push(t);var s=this.columnTypes[t];if(s){if(s!==n)throw Error(Object(a.a)(f,t,s))}else{if(!this.conditions[n])throw new Error("Unexpected operation named `"+n+"`. Possible ones are `disjunction` and `conjunction`.");this.columnTypes[t]=n}this.getConditions(t).push({name:i,args:o,func:Object(l.a)(i,o)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e=this.columnTypes[t];return e?(this.conditions[e][t]||(this.conditions[e][t]=[]),this.conditions[e][t]):[]}},{key:"exportAllConditions",value:function(){var t=this,e=[];return Object(r.arrayEach)(this.orderStack,function(n){var o=Object(r.arrayMap)(t.getConditions(n),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:condition;return{name:t.name,args:t.args}});e.push({column:n,conditions:o})}),e}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),Object(r.arrayEach)(t,function(t){e.orderStack.push(t.column),Object(r.arrayEach)(t.conditions,function(n){return e.addCondition(t.column,n)})})}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.orderStack.indexOf(t)>=0&&this.orderStack.splice(this.orderStack.indexOf(t),1),this.clearConditions(t),this.runLocalHooks("afterRemove",t)}},{key:"clearConditions",value:function(t){this.runLocalHooks("beforeClear",t),this.getConditions(t).length=0,delete this.columnTypes[t],this.runLocalHooks("afterClear",t)}},{key:"hasConditions",value:function(t,e){if(!this.columnTypes[t])return!1;var n=this.getConditions(t);return e?Object(r.arrayFilter)(n,function(t){return t.name===e}).length>0:n.length>0}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var t=Object.create(null);return Object(i.objectEach)(c.c,function(e,n){t[n]=Object.create(null)}),t}}]),t}();Object(i.mixin)(d,s.a),e.a=d},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return[]};o(this,t),this.conditionCollection=e,this.columnDataFactory=n}return i(t,[{key:"filter",value:function(){var t=this,e=[];return this.conditionCollection.isEmpty()||Object(r.arrayEach)(this.conditionCollection.orderStack,function(n,o){var r=t.columnDataFactory(n);o&&(r=t._getIntersectData(r,e)),e=t.filterByColumn(n,r)}),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];return Object(r.arrayEach)(n,function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&o.push(n)}),o}},{key:"_getIntersectData",value:function(t,e){var n=[];return Object(r.arrayEach)(e,function(e){var o=e.meta.visualRow;void 0!==t[o]&&(n[o]=t[o])}),n}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(66),a=(n.n(i),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}());e.a=function(){function t(e,n){o(this,t);var i=Object(r.isObject)(e),a=Object(r.isObject)(n);this._row=i?e.index:e,this.rowAbsolute=!i||e.isAbsolute,this._column=a?n.index:n,this.columnAbsolute=!a||n.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(t){this._row=t},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(t){this._column=t},enumerable:!0,configurable:!0})}return a(t,[{key:"translateTo",value:function(t,e){this.row=this.row+t,this.column=this.column+e}},{key:"isEqual",value:function(t){return t.row===this.row&&t.column===this.column}},{key:"toString",value:function(){return Object(i.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(1),a=n(241),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),this.year=e,this.firstWeekDay="monday",this.allowSplitWeeks=void 0===n||n,this.weekSectionCount=0,this.monthList=this.calculateMonthData(),this.daysInColumns={},this.calculateWeekStructure()}return s(t,[{key:"setYear",value:function(t){this.year=t,this.monthList=this.calculateMonthData(),this.calculateWeekStructure()}},{key:"setFirstWeekDay",value:function(t){var e=t.toLowerCase();"monday"!==e&&"sunday"!==e&&console.warn("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=e,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){return this.monthList}},{key:"parseDate",value:function(t){return t instanceof Date||(t=new Date(t),"Invalid Date"!==t.toString())?t:null}},{key:"dateToColumn",value:function(t){if(!(t=this.parseDate(t))||t.getFullYear()!==this.year)return!1;var e=t.getMonth();return this.getWeekColumn(t.getDate()-1,e)}},{key:"getWeekColumn",value:function(t,e){var n=null,o=this.getMonthCacheArray(e);return Object(r.arrayEach)(o,function(e){if(Object(i.objectEach)(e,function(e,o){if(e.indexOf(t+1)>-1)return n=parseInt(o,10),!1}),n)return!1}),n}},{key:"getMonthCacheArray",value:function(t){var e=this,n=this.getMonthList(),o=[];if(this.allowSplitWeeks)o.push(this.daysInColumns[t]);else{var r=-1;Object(i.objectEach)(this.daysInColumns,function(i,a){var s=n[a];if(Object.keys(i).length>1&&r++,r===t)return s.daysBeforeFullWeeks>0&&o.push(e.daysInColumns[parseInt(a,10)-1]),o.push(i),s.daysAfterFullWeeks>0&&o.push(e.daysInColumns[parseInt(a,10)+1]),!1})}return o}},{key:"columnToDate",value:function(t){var e=null;return Object(i.objectEach)(this.daysInColumns,function(n,o){if(n[t])return e=o,!1}),1===this.daysInColumns[e][t].length?new Date(this.year,e,this.daysInColumns[e][t][0]):this.daysInColumns[e][t]}},{key:"isOnTheEdgeOfWeek",value:function(t){var e=this;if(!(t=this.parseDate(t)))return null;var n=t.getMonth(),o=t.getDate()-1,a=this.getMonthCacheArray(n),s=!1;return Object(r.arrayEach)(a,function(n){if(Object(i.objectEach)(n,function(n){if(!e.allowSplitWeeks&&7!==n.length&&(0===o||o===new Date(t.getYear(),t.getMonth()+1,0).getDate()-1))return!0;var r=n.indexOf(o+1);return 0===r?(s=[1,0],!1):r===n.length-1?(s=[0,1],!1):void 0}),s)return!1}),s}},{key:"addDaysToCache",value:function(t,e,n,o){if(this.daysInColumns[t]||(this.daysInColumns[t]={}),this.daysInColumns[t][e]||(this.daysInColumns[t][e]=[]),n<=o)for(var r=n;r<=o;r++)this.daysInColumns[t][e].push(r);else{for(var i=t-1>=0?this.countMonthDays(t):31,a=n;a<=i;a++)this.daysInColumns[t][e].push(a);for(var s=1;s<=o;s++)this.daysInColumns[t][e].push(s)}}},{key:"isValidRangeBarData",value:function(t,e){var n=this.parseDate(t),o=this.parseDate(e);return n&&o&&n.getTime()<=o.getTime()}},{key:"calculateMonthData",value:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){return this.monthList.length}},{key:"countMonthDays",value:function(t){return this.monthList[t-1].days}},{key:"countMonthFullWeeks",value:function(t){return this.monthList[t-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var t=this;this.monthList=this.calculateMonthData();var e=this.getFirstWeekDay(),n=this.getMonthList(),o=this.getYear(),i=[],s=0,l=0;"monday"===e&&(s=1),Object(r.arrayEach)(n,function(e,r){var u=new Date(o,r,1).getDay(),c=0,h=null;e.daysBeforeFullWeeks=(7-u+s)%7,!t.allowSplitWeeks&&e.daysBeforeFullWeeks&&(h=Object(a.c)(r,n),i.push(Object(a.d)(h,r)),c++),e.fullWeeks=Math.floor((e.days-e.daysBeforeFullWeeks)/7),e.daysAfterFullWeeks=e.days-e.daysBeforeFullWeeks-7*e.fullWeeks,t.allowSplitWeeks?l+=e.fullWeeks+(e.daysBeforeFullWeeks?1:0)+(e.daysAfterFullWeeks?1:0):(r===n.length-1&&e.daysAfterFullWeeks&&(h=Object(a.c)(r,n),i.push(Object(a.d)(h,null)),c++),l+=e.fullWeeks+c)}),Object(r.arrayEach)(i,function(e,n){var o=e.index;delete e.index,t.addMixedMonth(null===o?o:n+o,e)}),this.weekSectionCount=l}},{key:"addMixedMonth",value:function(t,e){null===t?this.monthList.push(e):this.monthList.splice(t,0,e)}}]),t}()},function(t,e,n){"use strict";function o(t,e){return{name:t,days:s,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:e}}function r(t,e){var n=i(e[t].name),o=t>0?i(e[t-1].name):null,r=i(e[0].name),a=i(e[e.length-1].name);return t>0?o+"/"+n:t===e.length-1?n+"/"+r:a+"/"+n}function i(t){return t.substring(0,3)}n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s}),e.d=o,e.c=r;var a=31,s=7},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(0),s=n(4),l=n(2),u=n(160),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i.trimRowsPlugin=t.trimRowsPlugin,i}return i(e,t),c(e,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),c(e,[{key:"appendLevelIndicators",value:function(t,n){t=this.trimRowsPlugin.rowsMapper.getValueByIndex(t);var o=this.dataManager.getRowLevel(t),r=this.dataManager.getDataObject(t),i=n.getElementsByTagName("DIV")[0],u=i.querySelector("span.rowHeader"),c=i.querySelectorAll('[class^="ht_nesting"]');if(Object(a.arrayEach)(c,function(t,e){t&&i.removeChild(t)}),Object(l.addClass)(n,e.CSS_CLASSES.indicatorContainer),o){var h=u.cloneNode(!0);i.innerHTML="",Object(s.rangeEach)(0,o-1,function(t){var n=document.createElement("SPAN");Object(l.addClass)(n,e.CSS_CLASSES.emptyIndicator),i.appendChild(n)}),i.appendChild(h)}if(this.dataManager.hasChildren(r)){var f=document.createElement("DIV");Object(l.addClass)(n,e.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(t)?Object(l.addClass)(f,e.CSS_CLASSES.button+" "+e.CSS_CLASSES.expandButton):Object(l.addClass)(f,e.CSS_CLASSES.button+" "+e.CSS_CLASSES.collapseButton),i.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(t){t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}]),e}(u.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(85),r=(n.n(o),n(94)),i=(n.n(r),n(95)),a=(n.n(i),n(96)),s=(n.n(a),n(97)),l=(n.n(s),n(99)),u=(n.n(l),n(101)),c=(n.n(u),n(102)),h=(n.n(c),n(103)),f=(n.n(h),n(104)),d=(n.n(f),n(105)),p=(n.n(d),n(106)),v=(n.n(p),n(107)),g=(n.n(v),n(108)),y=(n.n(g),n(109)),m=(n.n(y),n(110)),b=(n.n(m),n(111)),w=(n.n(b),n(112)),O=(n.n(w),n(113)),C=(n.n(O),n(114)),E=(n.n(C),n(115)),S=(n.n(E),n(116)),k=(n.n(S),n(117)),T=(n.n(k),n(118)),R=(n.n(T),n(119)),_=(n.n(R),n(122)),j=(n.n(_),n(123)),A=(n.n(j),n(124)),M=(n.n(A),n(125)),H=(n.n(M),n(126)),P=(n.n(H),n(127)),N=(n.n(P),n(128)),L=(n.n(N),n(129)),D=(n.n(L),n(131)),x=(n.n(D),n(132)),I=(n.n(x),n(133)),F=(n.n(I),n(134)),B=(n.n(F),n(135)),W=(n.n(B),n(80)),V=(n.n(W),n(136)),U=(n.n(V),n(137)),z=(n.n(U),n(138)),G=(n.n(z),n(139)),X=(n.n(G),n(140)),Y=(n.n(X),n(141)),K=(n.n(Y),n(142)),q=(n.n(K),n(143)),J=(n.n(q),n(144)),$=(n.n(J),n(145)),Q=(n.n($),n(146)),Z=(n.n(Q),n(147)),tt=(n.n(Z),n(148)),et=(n.n(tt),n(149)),nt=(n.n(et),n(150)),ot=(n.n(nt),n(262));n(377),n(457),n(458),ot.a.baseVersion=void 0,e.default=ot.a},function(t,e,n){var o=n(22),r=n(20),i=n(45);t.exports=n(24)?Object.defineProperties:function(t,e){r(t);for(var n,a=i(e),s=a.length,l=0;s>l;)o.f(t,n=a[l++],e[n]);return t}},function(t,e,n){"use strict";var o=n(88),r=n(56),i=n(58),a={};n(38)(a,n(16)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=o(a,{next:r(1,n)}),i(t,e+" Iterator")}},function(t,e,n){var o=n(12),r=n(174).set;t.exports=function(t,e,n){var i,a=e.constructor;return a!==n&&"function"==typeof a&&(i=a.prototype)!==n.prototype&&o(i)&&r&&r(t,i),t}},function(t,e,n){var o=n(248);t.exports=function(t,e){return new(o(t))(e)}},function(t,e,n){var o=n(12),r=n(175),i=n(16)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),o(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var o=n(20),r=n(71),i=n(16)("species");t.exports=function(t,e){var n,a=o(t).constructor;return void 0===a||void 0==(n=o(a)[i])?e:r(n)}},function(t,e){t.exports=function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var o=n(17),r=n(98).set,i=o.MutationObserver||o.WebKitMutationObserver,a=o.process,s=o.Promise,l="process"==n(48)(a);t.exports=function(){var t,e,n,u=function(){var o,r;for(l&&(o=a.domain)&&o.exit();t;){r=t.fn,t=t.next;try{r()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(l)n=function(){a.nextTick(u)};else if(!i||o.navigator&&o.navigator.standalone)if(s&&s.resolve){var c=s.resolve();n=function(){c.then(u)}}else n=function(){r.call(o,u)};else{var h=!0,f=document.createTextNode("");new i(u).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(o){var r={fn:o,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var o=n(20),r=n(12),i=n(178);t.exports=function(t,e){if(o(t),r(e)&&e.constructor===t)return e;var n=i.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var o=n(17),r=n(49),i=n(74),a=n(179),s=n(22).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=i?{}:o.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var o=n(45),r=n(78),i=n(59);t.exports=function(t){var e=o(t),n=r.f;if(n)for(var a,s=n(t),l=i.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var o=n(68),r=n(46);t.exports=function(t){return function(e,n){var i,a,s=String(r(e)),l=o(n),u=s.length;return l<0||l>=u?t?"":void 0:(i=s.charCodeAt(l),i<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):i:t?s.slice(l,l+2):a-56320+(i-55296<<10)+65536)}}},function(t,e,n){"use strict";var o=n(20);t.exports=function(){var t=o(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var o=n(40),r=n(69),i=n(27);t.exports=[].copyWithin||function(t,e){var n=o(this),a=i(n.length),s=r(t,a),l=r(e,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:r(u,a))-l,a-s),h=1;for(l<s&&s<l+c&&(h=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=h,l+=h;return n}},function(t,e,n){"use strict";var o=n(40),r=n(69),i=n(27);t.exports=function(t){for(var e=o(this),n=i(e.length),a=arguments.length,s=r(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:r(l,n);u>s;)e[s++]=t;return e}},function(t,e,n){var o=n(100),r=n(78),i=n(20),a=n(17).Reflect;t.exports=a&&a.ownKeys||function(t){var e=o.f(i(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";function o(t,e){var n=new ht.a(t,e||{},Pt.d);return n.init(),n}var r=n(85),i=(n.n(r),n(94)),a=(n.n(i),n(95)),s=(n.n(a),n(96)),l=(n.n(s),n(97)),u=(n.n(l),n(99)),c=(n.n(u),n(101)),h=(n.n(c),n(102)),f=(n.n(h),n(103)),d=(n.n(f),n(104)),p=(n.n(d),n(105)),v=(n.n(p),n(106)),g=(n.n(v),n(107)),y=(n.n(g),n(108)),m=(n.n(y),n(109)),b=(n.n(m),n(110)),w=(n.n(b),n(111)),O=(n.n(w),n(112)),C=(n.n(O),n(113)),E=(n.n(C),n(114)),S=(n.n(E),n(115)),k=(n.n(S),n(116)),T=(n.n(k),n(117)),R=(n.n(T),n(118)),_=(n.n(R),n(119)),j=(n.n(_),n(122)),A=(n.n(j),n(123)),M=(n.n(A),n(124)),H=(n.n(M),n(125)),P=(n.n(H),n(126)),N=(n.n(P),n(127)),L=(n.n(N),n(128)),D=(n.n(L),n(129)),x=(n.n(D),n(131)),I=(n.n(x),n(132)),F=(n.n(I),n(133)),B=(n.n(F),n(134)),W=(n.n(B),n(135)),V=(n.n(W),n(80)),U=(n.n(V),n(136)),z=(n.n(U),n(137)),G=(n.n(z),n(138)),X=(n.n(G),n(139)),Y=(n.n(X),n(140)),K=(n.n(Y),n(141)),q=(n.n(K),n(142)),J=(n.n(q),n(143)),$=(n.n(J),n(144)),Q=(n.n($),n(145)),Z=(n.n(Q),n(146)),tt=(n.n(Z),n(147)),et=(n.n(tt),n(148)),nt=(n.n(et),n(149)),ot=(n.n(nt),n(150)),rt=(n.n(ot),n(263)),it=(n.n(rt),n(264)),at=(n.n(it),n(265)),st=(n.n(at),n(19)),lt=n(15),ut=n(35),ct=n(152),ht=n(153),ft=n(320),dt=n(8),pt=n(13),vt=n(155),gt=n(0),yt=n(33),mt=n(81),bt=n(202),wt=n(42),Ot=n(34),Ct=n(14),Et=n(4),St=n(1),kt=n(154),Tt=n(30),Rt=n(18),_t=n(2),jt=n(11),At=n(321),Mt=n(6),Ht=n(205),Pt=n(204),Nt=n(206),Lt=n(3),Dt=n(82);Object(ft.a)(o),o.Core=ht.a,o.DefaultSettings=Ht.a,o.EventManager=dt.a,o._getListenersCounter=dt.b,o.buildDate=void 0,o.packageName=void 0,o.version=void 0,o.hooks=pt.a.getSingleton(),o.__GhostTable=vt.a;var xt=[gt,yt,mt,bt,wt,Ot,Ct,Et,St,kt,Tt,Rt],It=[_t,jt];o.helper={},o.dom={},gt.arrayEach(xt,function(t){gt.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(o.helper[e]=t[e])})}),gt.arrayEach(It,function(t){gt.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(o.dom[e]=t[e])})}),o.cellTypes={},gt.arrayEach(Object(ct.b)(),function(t){o.cellTypes[t]=Object(ct.a)(t)}),o.cellTypes.registerCellType=ct.c,o.cellTypes.getCellType=ct.a,o.editors={},gt.arrayEach(Object(st.c)(),function(t){o.editors[Tt.toUpperCaseFirst(t)+"Editor"]=Object(st.a)(t)}),o.editors.registerEditor=st.d,o.editors.getEditor=st.a,o.renderers={},gt.arrayEach(Object(lt.a)(),function(t){var e=Object(lt.b)(t);"base"===t&&(o.renderers.cellDecorator=e),o.renderers[Tt.toUpperCaseFirst(t)+"Renderer"]=e}),o.renderers.registerRenderer=lt.c,o.renderers.getRenderer=lt.b,o.validators={},gt.arrayEach(Object(ut.a)(),function(t){o.validators[Tt.toUpperCaseFirst(t)+"Validator"]=Object(ut.b)(t)}),o.validators.registerValidator=ut.c,o.validators.getValidator=ut.b,o.plugins={},gt.arrayEach(Object.getOwnPropertyNames(At),function(t){var e=At[t];"Base"===t?o.plugins[t+"Plugin"]=e:o.plugins[t]=e}),o.plugins.registerPlugin=Mt.d,o.languages={},o.languages.dictionaryKeys=Lt,o.languages.getLanguageDictionary=Dt.b,o.languages.getLanguagesDictionaries=Dt.c,o.languages.registerLanguageDictionary=Dt.e,o.languages.getTranslatedPhrase=function(){return Nt.a.apply(void 0,arguments)},e.a=o},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(29),l=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(s.a.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",Object(a.addClass)(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return i(e,t),e}(s.a);s.a.registerOverlay(s.a.CLONE_DEBUG,l)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(29),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(s.a.CLONE_LEFT),n}return i(e,t),l(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)e=this.getScrollPosition(),Object(a.resetCssTransform)(t);else{var o=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(o.left),i=Math.ceil(o.right),s=void 0,l=void 0;l=this.wot.wtTable.hider.style.top,l=""===l?0:l,s=r<0&&i-t.offsetWidth>0?-r:0,e=s,s+="px",Object(a.setOverlayPosition)(t,s,l)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo(t,Object(a.getWindowScrollTop)()):this.mainTableScrollableElement.scrollLeft=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=0,o=this.wot.wtSettings.defaultColumnWidth;t<e;)n+=this.wot.wtTable.getStretchedColumnWidth(t)||o,t++;return n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientHeight===t.offsetHeight?0:Object(a.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,o=n.style,r=this.wot.getSetting("preventOverflow"),i=void 0;if(this.trimmingContainer!==window||"vertical"===r){var s=this.wot.wtViewport.getWorkspaceHeight()-e;s=Math.min(s,Object(a.innerHeight)(this.wot.wtTable.wtRootElement)),o.height=s+"px"}else o.height="";this.clone.wtTable.holder.style.height=o.height,i=Object(a.outerWidth)(this.clone.wtTable.TABLE),o.width=(0===i?i:i+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=Object(a.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===t&&(t=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.top="number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=o.wtTable.holder,i=0;e&&r.offsetWidth!==r.clientWidth&&(i=Object(a.getScrollbarWidth)()),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=this.wot.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==window||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Object(a.getScrollLeft)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),o=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?Object(a.removeClass)(e,"emptyRows"):Object(a.addClass)(e,"emptyRows"),o&&!n.length)Object(a.addClass)(e,"innerBorderLeft");else if(!o&&n.length){var r=Object(a.hasClass)(e,"innerBorderLeft");t?Object(a.addClass)(e,"innerBorderLeft"):Object(a.removeClass)(e,"innerBorderLeft"),(!r&&t||r&&!t)&&this.wot.wtOverlays.adjustElementsSize()}}}]),e}(s.a);s.a.registerOverlay(s.a.CLONE_LEFT,u)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(0),l=n(29),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(l.a.CLONE_TOP),n}return i(e,t),u(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)e=this.getScrollPosition(),Object(a.resetCssTransform)(t);else{var o=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(o.top),i=Math.ceil(o.bottom),s=void 0,l=void 0;s=this.wot.wtTable.hider.style.left,s=""===s?0:s,l=r<0&&i-t.offsetHeight>0?-r:0,e=l,l+="px",Object(a.setOverlayPosition)(t,s,l)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo(Object(a.getWindowScrollLeft)(),t):this.mainTableScrollableElement.scrollTop=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=0,o=this.wot.wtSettings.settings.defaultRowHeight;t<e;){var r=this.wot.wtTable.getRowHeight(t);n+=void 0===r?o:r,t++}return n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientWidth===t.offsetWidth?0:Object(a.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,o=n.style,r=this.wot.getSetting("preventOverflow"),i=void 0;if(this.trimmingContainer!==window||"horizontal"===r){var s=this.wot.wtViewport.getWorkspaceWidth()-e;s=Math.min(s,Object(a.innerWidth)(this.wot.wtTable.wtRootElement)),o.width=s+"px"}else o.width="";this.clone.wtTable.holder.style.width=o.width,i=Object(a.outerHeight)(this.clone.wtTable.TABLE),o.height=(0===i?i:i+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=Object(a.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=o.wtTable.holder,i=0;if(e&&r.offsetHeight!==r.clientHeight&&(i=Object(a.getScrollbarWidth)()),e){var s=this.wot.getSetting("fixedRowsBottom"),l=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(l-s,l),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),t);n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(a.getScrollTop)(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(t){if(t&&t.cellRange){var e=t.getBorder(this.wot),n=t.getCorners();e.disappear(),e.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this,e=this.wot.selections;this.redrawSelectionBorders(e.getCell()),Object(s.arrayEach)(e.getAreas(),function(e){t.redrawSelectionBorders(e)}),this.redrawSelectionBorders(e.getFill()),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?Object(a.removeClass)(e,"emptyColumns"):Object(a.addClass)(e,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=Object(a.hasClass)(e,"innerBorderTop");t||0===this.wot.getSetting("totalRows")?Object(a.addClass)(e,"innerBorderTop"):Object(a.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var o=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(o)for(var r=0;r<o.length;r++)o[r].style["border-left-width"]=0}}}]),e}(l.a);l.a.registerOverlay(l.a.CLONE_TOP,c)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(29),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(s.a.CLONE_TOP_LEFT_CORNER),n}return i(e,t),l(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=Object(a.outerHeight)(this.clone.wtTable.TABLE),n=Object(a.outerWidth)(this.clone.wtTable.TABLE),o=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var r=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(r.top),s=Math.ceil(r.left),l=Math.ceil(r.bottom),u=Math.ceil(r.right),c="0",h="0";o&&"vertical"!==o||s<0&&u-t.offsetWidth>0&&(c=-s+"px"),o&&"horizontal"!==o||i<0&&l-t.offsetHeight>0&&(h=-i+"px"),Object(a.setOverlayPosition)(t,c,h)}else Object(a.resetCssTransform)(t);t.style.height=(0===e?e:e+4)+"px",t.style.width=(0===n?n:n+4)+"px"}}}]),e}(s.a);s.a.registerOverlay(s.a.CLONE_TOP_LEFT_CORNER,u)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(199),a=n(60),s=n(151),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return u(t,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new i.a(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=new s.a(t,t,t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),e=this.cellRange.getBottomRightCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t.wtTable.getCell(new a.a(e,n));return"object"===(void 0===s?"undefined":l(s))&&(i&&(o=this.classNameGenerator(s),this.classNames.includes(o)||this.classNames.push(o)),Object(r.addClass)(s,o)),this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(o){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===i)return t;var a=i>=0?i:e;a-=1;var s=0===a?t:t+"-"+a;return Object(r.hasClass)(o,s)?t+"-"+(a+1):n(o,a)}}},{key:"draw",value:function(t){if(this.isEmpty())return void(this.settings.border&&this.getBorder(t).disappear());for(var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),o=this.getCorners(),i=void 0,a=void 0,s=void 0,l=0;l<n;l++)if((a=t.wtTable.columnFilter.renderedToSource(l))>=o[1]&&a<=o[3]&&(s=t.wtTable.getColumnHeader(a))){var u=[];this.settings.highlightHeaderClassName&&u.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&u.push(this.settings.highlightColumnClassName),Object(r.addClass)(s,u)}for(var c=0;c<e;c++){if((i=t.wtTable.rowFilter.renderedToSource(c))>=o[0]&&i<=o[2]&&(s=t.wtTable.getRowHeader(i))){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),Object(r.addClass)(s,h)}for(var f=0;f<n;f++)a=t.wtTable.columnFilter.renderedToSource(f),i>=o[0]&&i<=o[2]&&a>=o[1]&&a<=o[3]?this.settings.className&&this.addClassAtCoords(t,i,a,this.settings.className,this.settings.markIntersections):i>=o[0]&&i<=o[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(t,i,a,this.settings.highlightRowClassName):a>=o[1]&&a<=o[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(t,i,a,this.settings.highlightColumnClassName)}t.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(t).appear(o)}}]),t}()},function(t,e,n){function o(){function t(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}var e,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),a=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,!1)},s=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},l=function(a){var s,l;a?/^[a-zA-Z \.,\\\/\|0-9]$/.test(a)||(a="."):a="",void 0!==r.textContent?r.textContent=e.value+a:r.data=e.value+a,i.style.fontSize=t(e).fontSize,i.style.fontFamily=t(e).fontFamily,i.style.whiteSpace="pre",o.appendChild(i),s=i.clientWidth+2,o.removeChild(i),e.style.height=n.minHeight+"px",e.style.width=n.minWidth>s?n.minWidth+"px":s>n.maxWidth?n.maxWidth+"px":s+"px",l=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>l?e.style.height=n.minHeight+"px":n.maxHeight<l?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},u=function(){window.setTimeout(l,0)},c=function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)n.minHeight=e.clientHeight;else{var o=parseInt(t.minHeight);isNaN(o)||(n.minHeight=o)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)n.maxHeight=e.clientHeight;else{var a=parseInt(t.maxHeight);isNaN(a)||(n.maxHeight=a)}if(t&&t.minWidth)if("inherit"==t.minWidth)n.minWidth=e.clientWidth;else{var s=parseInt(t.minWidth);isNaN(s)||(n.minWidth=s)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)n.maxWidth=e.clientWidth;else{var l=parseInt(t.maxWidth);isNaN(l)||(n.maxWidth=l)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},h=function(t,o,r){e=t,c(o),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),r&&(a(e,"change",l),a(e,"cut",u),a(e,"paste",u),a(e,"drop",u),a(e,"keydown",u),a(e,"focus",l)),l()};return{init:function(t,e,n){h(t,e,n)},unObserve:function(){s(e,"change",l),s(e,"cut",u),s(e,"paste",u),s(e,"drop",u),s(e,"keydown",u),s(e,"focus",l)},resize:l}}t.exports=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(52),s=n(2),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"beginEditing",value:function(t,e){if("mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');Object(s.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),e}(a.b)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(31),s=n.n(a),l=n(274),u=n.n(l),c=n(275),h=(n.n(c),n(2)),f=n(1),d=n(8),p=n(18),v=n(11),g=n(62),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return i(e,t),y(e,[{key:"init",value:function(){var t=this;if("function"!=typeof s.a)throw new Error("You need to include moment.js to your project.");if("function"!=typeof u.a)throw new Error("You need to include Pikaday to your project.");m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){t.parentDestroyed=!0,t.destroyElements()})}},{key:"createElements",value:function(){m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Object(h.addClass)(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new u.a(this.getDatePickerConfig()),new d.a(this).addEventListener(this.datePicker,"mousedown",function(t){return Object(v.stopPropagation)(t)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(t,n,o,r,i,a){this._opened=!1,m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepare",this).call(this,t,n,o,r,i,a)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this),this.showDatepicker(t)}},{key:"close",value:function(){var t=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){t.instance._refreshBorders()},0)),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var o=this.originalValue;void 0!==o&&this.setValue(o)}this.hideDatepicker(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finishEditing",this).call(this,t,n)}},{key:"showDatepicker",value:function(t){this.$datePicker.config(this.getDatePickerConfig());var e=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),r=void 0,i=this.instance.view.isMouseDown(),a=!!t&&Object(p.isMetaKey)(t.keyCode);this.datePickerStyle.top=window.pageYOffset+e.top+Object(h.outerHeight)(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+e.left+"px",this.$datePicker._onInputFocus=function(){},o.format=n,this.originalValue?(r=this.originalValue,s()(r,n,!0).isValid()&&this.$datePicker.setMoment(s()(r,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||i||this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,o.defaultDate=r,s()(r,n,!0).isValid()&&this.$datePicker.setMoment(s()(r,n),!0),a||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(f.deepExtend)(n,this.cellProperties.datePickerConfig);var o=n.onSelect,r=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(e){isNaN(e.getTime())||(e=s()(e).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(e),t.hideDatepicker(),o&&o()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),r&&r()},n}}]),e}(g.a)},function(t,n){t.exports=e},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(200),s=n(13),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},c=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"prepare",value:function(t,n,o,r,i,a){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepare",this).call(this,t,n,o,r,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),e}(a.a);s.a.getSingleton().add("beforeValidate",function(t,e,n,o){var r=this.getCellMeta(e,this.propToCol(n));r.editor===c&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}),e.a=c},function(t,e,n){"use strict";var o=n(18),r=n(11),i=n(2),a=n(52),s=n(8),l=a.b.prototype.extend(),u={},c=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var t in this.controls)Object.prototype.hasOwnProperty.call(this.controls,t)&&this.positionControls.appendChild(this.controls[t])};l.prototype.valueChanged=function(){return this.initValue!=this.getValue()},l.prototype.init=function(){var t=this;this.eventManager=new s.a(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){t.destroy()})},l.prototype.getValue=function(){return this.TEXTAREA.value},l.prototype.setValue=function(t){this.initValue=t,this.TEXTAREA.value=t},l.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),Object(i.addClass)(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),c.call(this),document.body.appendChild(this.editorContainer)},l.prototype.onBeforeKeyDown=function(t){var e=this,n=e.getActiveEditor();if(t.target===n.TEXTAREA&&!Object(r.isImmediatePropagationStopped)(t))switch(t.keyCode){case o.KEY_CODES.ENTER:n.close(),t.preventDefault();break;case o.KEY_CODES.BACKSPACE:Object(r.stopImmediatePropagation)(t)}},l.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),Object(i.addClass)(this.editorContainer,"active"),Object(i.removeClass)(this.cellPointer,"hidden"),this.updateEditorPosition()},l.prototype.focus=function(){this.TEXTAREA.focus(),Object(i.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},l.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),Object(i.removeClass)(this.editorContainer,"active")},l.prototype.scrollToView=function(){this.instance.view.scrollViewport(this.instance.getSelectedRangeLast().highlight)},l.prototype.hideCellPointer=function(){Object(i.hasClass)(this.cellPointer,"hidden")||Object(i.addClass)(this.cellPointer,"hidden")},l.prototype.updateEditorPosition=function(t,e){if(t&&e)t=parseInt(t,10),e=parseInt(e,10),this.editorContainer.style.top=e+"px",this.editorContainer.style.left=t+"px";else{var n=this.instance.getSelectedLast(),o=this.instance.getCell(n[0],n[1]);if(u.cellPointer||(u.cellPointer={height:Object(i.outerHeight)(this.cellPointer),width:Object(i.outerWidth)(this.cellPointer)}),u.editorContainer||(u.editorContainer={width:Object(i.outerWidth)(this.editorContainer)}),void 0!==o){var r=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:Object(i.getScrollLeft)(this.instance.view.wt.wtOverlays.leftOverlay.holder),a=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:Object(i.getScrollTop)(this.instance.view.wt.wtOverlays.topOverlay.holder),s=Object(i.offset)(o),l=Object(i.outerWidth)(o),c={x:r,y:a};this.editorContainer.style.top=parseInt(s.top+Object(i.outerHeight)(o)-c.y+u.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-u.editorContainer.width/2,10)+"px",s.left+l/2>parseInt(this.editorContainer.style.left,10)+u.editorContainer.width?this.editorContainer.style.left=window.innerWidth-u.editorContainer.width+"px":s.left+l/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-u.cellPointer.width/2-Object(i.offset)(this.editorContainer).left+l/2-c.x,10)+"px"}}},l.prototype.updateEditorData=function(){var t=this.instance.getSelectedLast(),e=this.instance.getDataAtCell(t[0],t[1]);this.row=t[0],this.col=t[1],this.setValue(e),this.updateEditorPosition()},l.prototype.prepareAndSave=function(){var t;this.valueChanged()&&(t=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(t))},l.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(0,-1,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(0,1,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(-1,0,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(1,0,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var n=e.touches[0],o={x:t.editorContainer.offsetLeft,y:t.editorContainer.offsetTop},r={x:n.pageX-o.x,y:n.pageY-o.y};t.eventManager.addEventListener(this,"touchmove",function(e){var n=e.touches[0];t.updateEditorPosition(n.pageX-r.x,n.pageY-r.y),t.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){Object(i.isChildOf)(e.target,t.editorContainer)||Object(i.isChildOf)(e.target,t.instance.rootElement)||t.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(e){t.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&t.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(e){t.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&t.hideCellPointer()})},l.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},e.a=l},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(62);e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(a.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(62),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"createElements",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(a.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),e}(s.a)},function(t,e,n){"use strict";var o=n(2),r=n(11),i=n(18),a=n(52),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=a.b.prototype.extend();l.prototype.init=function(){this.select=document.createElement("SELECT"),Object(o.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},l.prototype.registerHooks=function(){var t=this;this.instance.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return t.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return t.refreshDimensions()})},l.prototype.prepare=function(){a.b.prototype.prepare.apply(this,arguments);var t,e=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof e?e(this.row,this.col,this.prop):e),Object(o.empty)(this.select);for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=document.createElement("OPTION");r.value=n,Object(o.fastInnerHTML)(r,t[n]),this.select.appendChild(r)}},l.prototype.prepareOptions=function(t){var e={};if(Array.isArray(t))for(var n=0,o=t.length;n<o;n++)e[t[n]]=t[n];else"object"==(void 0===t?"undefined":s(t))&&(e=t);return e},l.prototype.getValue=function(){return this.select.value},l.prototype.setValue=function(t){this.select.value=t};var u=function(t){var e=this,n=e.getActiveEditor();switch(t.keyCode){case i.KEY_CODES.ARROW_UP:var o=n.select.selectedIndex-1;o>=0&&(n.select[o].selected=!0),Object(r.stopImmediatePropagation)(t),t.preventDefault();break;case i.KEY_CODES.ARROW_DOWN:var a=n.select.selectedIndex+1;a<=n.select.length-1&&(n.select[a].selected=!0),Object(r.stopImmediatePropagation)(t),t.preventDefault()}};l.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",u)},l.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",u)},l.prototype.focus=function(){this.select.focus()},l.prototype.refreshValue=function(){var t=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()},l.prototype.refreshDimensions=function(){if(this.state===a.a.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close();var t,e=Object(o.outerWidth)(this.TD)+1,n=Object(o.outerHeight)(this.TD)+1,r=Object(o.offset)(this.TD),i=Object(o.offset)(this.instance.rootElement),s=Object(o.getScrollableElement)(this.TD),l=r.top-i.top-1-(s.scrollTop||0),u=r.left-i.left-1-(s.scrollLeft||0),c=this.checkEditorSection();switch(this.instance.getSettings(),c){case"top":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Object(o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelectedLast()[0]&&(l+=1),0===this.instance.getSelectedLast()[1]&&(u+=1);var h=this.select.style;t&&-1!=t?h[t[0]]=t[1]:Object(o.resetCssTransform)(this.select);var f=Object(o.getComputedStyle)(this.TD);parseInt(f.borderTopWidth,10)>0&&(n-=1),parseInt(f.borderLeftWidth,10)>0&&(e-=1),h.height=n+"px",h.minWidth=e+"px",h.top=l+"px",h.left=u+"px",h.margin="0px"}},l.prototype.getEditedCell=function(){var t;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=t&&-2!=t?t:void 0},e.a=l},function(t,e,n){"use strict";function o(t,e,n,o,i,a,s){s.className&&(e.className=e.className?e.className+" "+s.className:s.className),s.readOnly&&Object(r.addClass)(e,s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?Object(r.addClass)(e,s.invalidCellClassName):Object(r.removeClass)(e,s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&Object(r.addClass)(e,s.noWordWrapClassName),!a&&s.placeholder&&Object(r.addClass)(e,s.placeholderCellClassName)}var r=n(2);e.a=o},function(t,e,n){"use strict";function o(t,e,n,o,c,h,f){var d=(l.cloneNode(!0),u.cloneNode(!0));if(f.allowHtml?Object(s.b)("html").apply(this,arguments):Object(s.b)("text").apply(this,arguments),e.appendChild(d),Object(r.addClass)(e,"htAutocomplete"),e.firstChild||e.appendChild(document.createTextNode(String.fromCharCode(160))),!t.acArrowListener){var p=new i.a(t);t.acArrowListener=function(i){Object(r.hasClass)(i.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new a.a(n,o),e)},p.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){p.destroy()})}}var r=n(2),i=n(8),a=n(9),s=n(15),l=document.createElement("DIV");l.className="htAutocompleteWrapper";var u=document.createElement("DIV");u.className="htAutocompleteArrow",u.appendChild(document.createTextNode(String.fromCharCode(9660))),e.a=o},function(t,e,n){"use strict";function o(t,e,n,o,s,l,u){function c(t){var e=Object(v.partial)(p.isKey,t.keyCode);e("SPACE|ENTER|DELETE|BACKSPACE")&&!Object(g.isImmediatePropagationStopped)(t)&&b(function(){Object(g.stopImmediatePropagation)(t),t.preventDefault()}),e("SPACE|ENTER")&&d(),e("DELETE|BACKSPACE")&&d(!0)}function d(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRangeLast();if(n){for(var o=n.getTopLeftCorner(),r=o.row,i=o.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],c=r;c<=s;c+=1)for(var h=i;h<=l;h+=1){var f=t.getCellMeta(c,h);if("checkbox"!==f.type)return;if(!0!==f.readOnly){void 0===f.checkedTemplate&&(f.checkedTemplate=!0),void 0===f.uncheckedTemplate&&(f.uncheckedTemplate=!1);var d=t.getDataAtCell(c,h);!1===e?[f.checkedTemplate,f.checkedTemplate.toString()].includes(d)?u.push([c,h,f.uncheckedTemplate]):[f.uncheckedTemplate,f.uncheckedTemplate.toString(),null,void 0].includes(d)&&u.push([c,h,f.checkedTemplate]):u.push([c,h,f.uncheckedTemplate])}}u.length>0&&t.setDataAtCell(u)}}function b(e){var n=t.getSelectedRangeLast();if(n)for(var o=n.getTopLeftCorner(),r=n.getBottomRightCorner(),i=o.row;i<=r.row;i++)for(var a=o.col;a<=r.col;a++){var s=t.getCellMeta(i,a);if("checkbox"!==s.type)return;var l=t.getCell(i,a);if(null==l)e(i,a,s);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!s.readOnly&&e(u)}}}Object(y.b)("base").apply(this,arguments);var O=(r(t),i()),C=u.label,E=!1;if(void 0===u.checkedTemplate&&(u.checkedTemplate=!0),void 0===u.uncheckedTemplate&&(u.uncheckedTemplate=!1),Object(h.empty)(e),l===u.checkedTemplate||Object(f.equalsIgnoreCase)(l,u.checkedTemplate)?O.checked=!0:l===u.uncheckedTemplate||Object(f.equalsIgnoreCase)(l,u.uncheckedTemplate)?O.checked=!1:null===l?Object(h.addClass)(O,"noValue"):(O.style.display="none",Object(h.addClass)(O,w),E=!0),O.setAttribute("data-row",n),O.setAttribute("data-col",o),!E&&C){var S="";C.value?S="function"==typeof C.value?C.value.call(this,n,o,s,l):C.value:C.property&&(S=t.getDataAtRowProp(n,C.property));var k=a(S);"before"===C.position?k.appendChild(O):k.insertBefore(O,k.firstChild),O=k}e.appendChild(O),E&&e.appendChild(document.createTextNode("#bad-value#")),m.has(t)||(m.set(t,!0),t.addHook("beforeKeyDown",c))}function r(t){var e=b.get(t);return e||(e=new d.a(t),e.addEventListener(t.rootElement,"click",function(e){return l(e,t)}),e.addEventListener(t.rootElement,"mouseup",function(e){return s(e,t)}),e.addEventListener(t.rootElement,"change",function(e){return u(e,t)}),b.set(t,e)),e}function i(){var t=document.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function a(t){var e=document.createElement("label");return e.className="htCheckboxRendererLabel",e.appendChild(document.createTextNode(t)),e.cloneNode(!0)}function s(t,e){c(t.target)&&setTimeout(e.listen,10)}function l(t,e){if(!c(t.target))return!1;e.getCellMeta(parseInt(t.target.getAttribute("data-row"),10),parseInt(t.target.getAttribute("data-col"),10)).readOnly&&t.preventDefault()}function u(t,e){if(!c(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),o=parseInt(t.target.getAttribute("data-col"),10),r=e.getCellMeta(n,o);if(!r.readOnly){var i=null;i=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(n,o,i)}}function c(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}var h=n(2),f=n(30),d=n(8),p=n(18),v=n(34),g=n(11),y=n(15),m=new WeakMap,b=new WeakMap,w="htBadValue";e.a=o},function(t,e,n){"use strict";function o(t,e,n,o,a,s,l){Object(i.b)("base").apply(this,arguments),null!==s&&void 0!==s||(s=""),Object(r.fastInnerHTML)(e,s)}var r=n(2),i=n(15);e.a=o},function(t,e,n){"use strict";function o(t,e,n,o,r,l,u){if(Object(s.isNumeric)(l)){var c=u.numericFormat,h=c&&c.culture,f=c&&c.pattern,d=u.className||"",p=d.length?d.split(" "):[];void 0!==h&&i.a.culture(h),l=i()(l).format(f||"0"),p.indexOf("htLeft")<0&&p.indexOf("htCenter")<0&&p.indexOf("htRight")<0&&p.indexOf("htJustify")<0&&p.push("htRight"),p.indexOf("htNumeric")<0&&p.push("htNumeric"),u.className=p.join(" ")}Object(a.b)("text")(t,e,n,o,r,l,u)}var r=n(286),i=n.n(r),a=n(15),s=n(4);e.a=o},function(t,e){t.exports=n},function(t,e,n){"use strict";function o(t,e,n,o,s,l,u){Object(i.b)("text").apply(this,arguments),l=e.innerHTML;var c=u.hashLength||l.length,h=u.hashSymbol||"*",f="";Object(a.rangeEach)(c-1,function(){f+=h}),Object(r.fastInnerHTML)(e,f)}var r=n(2),i=n(15),a=n(4);e.a=o},function(t,e,n){"use strict";function o(t,e,n,o,s,l,u){Object(a.b)("base").apply(this,arguments),!l&&u.placeholder&&(l=u.placeholder);var c=Object(i.stringify)(l);if(t.getSettings().trimWhitespace||(c=c.replace(/ /g,String.fromCharCode(160))),u.rendererTemplate){Object(r.empty)(e);var h=document.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(n),e.appendChild(h)}else Object(r.fastInnerText)(e,c)}var r=n(2),i=n(14),a=n(15);e.a=o},function(t,e,n){"use strict";function o(t,e){if(null==t&&(t=""),this.allowEmpty&&""===t)return void e(!0);this.strict&&this.source?"function"==typeof this.source?this.source(t,r(t,e)):r(t,e)(this.source):e(!0)}function r(t,e){var n=t;return function(t){for(var o=!1,r=0,i=t.length;r<i;r++)if(n===t[r]){o=!0;break}e(o)}}e.a=o},function(t,e,n){"use strict";function o(t,e){var n=!0,o=Object(l.b)("date",this.instance);null==t&&(t="");var i=a()(new Date(t)).isValid()||a()(t,o.defaultDateFormat).isValid(),s=a()(t,this.dateFormat||o.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===t&&(i=!0,s=!0),i||(n=!1),!i&&s&&(n=!0),i&&!s)if(!0===this.correctFormat){var u=r(t,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,h,u,"dateValidator"),n=!0}else n=!1;e(n)}function r(t,e){var n=a()(Object(s.getNormalizedDate)(t)),o=a()(t,e),r=t.search(/[A-z]/g)>-1,i=void 0;return i=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||r?n:o,i.format(e)}e.a=o;var i=n(31),a=n.n(i),s=n(202),l=n(19)},function(t,e,n){"use strict";function o(t,e){null==t&&(t=""),e(!(!this.allowEmpty||""!==t)||""!==t&&/^-?\d*(\.|,)?\d*$/.test(t))}e.a=o},function(t,e,n){"use strict";function o(t,e){var n=!0,o=this.timeFormat||"h:mm:ss a";null===t&&(t=""),t=/^\d{3,}$/.test(t)?parseInt(t,10):t;var r=/^\d{1,2}$/.test(t);r&&(t+=":00");var s=i()(t,a,!0).isValid()?i()(t):i()(t,o),l=s.isValid(),u=i()(t,o,!0).isValid()&&!r;if(this.allowEmpty&&""===t&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(!0===this.correctFormat){var c=s.format(o),h=this.instance.runHooks("unmodifyRow",this.row),f=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,f,c,"timeValidator"),n=!0}else n=!1;e(n)}e.a=o;var r=n(31),i=n.n(r),a=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(t,e,n){"use strict";var o=n(19),r=n(15),i=n(35);e.a={editor:Object(o.a)("autocomplete"),renderer:Object(r.b)("autocomplete"),validator:Object(i.b)("autocomplete")}},function(t,e,n){"use strict";var o=n(19),r=n(15);e.a={editor:Object(o.a)("checkbox"),renderer:Object(r.b)("checkbox")}},function(t,e,n){"use strict";var o=n(19),r=n(15),i=n(35);e.a={editor:Object(o.a)("date"),renderer:Object(r.b)("autocomplete"),validator:Object(i.b)("date")}},function(t,e,n){"use strict";var o=n(19),r=n(15),i=n(35);e.a={editor:Object(o.a)("dropdown"),renderer:Object(r.b)("autocomplete"),validator:Object(i.b)("autocomplete")}},function(t,e,n){"use strict";var o=n(19),r=n(15);e.a={editor:Object(o.a)("handsontable"),renderer:Object(r.b)("autocomplete")}},function(t,e,n){"use strict";var o=n(19),r=n(15),i=n(35);e.a={editor:Object(o.a)("numeric"),renderer:Object(r.b)("numeric"),validator:Object(i.b)("numeric"),dataType:"number"}},function(t,e,n){"use strict";var o=n(19),r=n(15);n(35),e.a={editor:Object(o.a)("password"),renderer:Object(r.b)("password"),copyable:!1}},function(t,e,n){"use strict";var o=n(33),r=n(19),i=n(15);e.a={editor:Object(o.isMobileBrowser)()?Object(r.a)("mobile"):Object(r.a)("text"),renderer:Object(i.b)("text")}},function(t,e,n){"use strict";var o=n(19),r=n(15),i=n(35);e.a={editor:Object(o.a)("text"),renderer:Object(r.b)("text"),validator:Object(i.b)("time")}},function(t,e,n){"use strict";function o(t,e,n){var o=this;this.instance=t,this.priv=e,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap(),this.interval=c.a.create(function(){return o.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(t){return o.onSkipLengthCache(t)}),this.onSkipLengthCache(500)}var r=n(203),i=n.n(r),a=n(81),s=n(154),l=n(1),u=n(0),c=n(303),h=n(4),f=n(304),d=(n(13),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});o.prototype.DESTINATION_RENDERER=1,o.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,o.prototype.recursiveDuckSchema=function(t){return Object(l.duckSchema)(t)},o.prototype.recursiveDuckColumns=function(t,e,n){var o,r;if(void 0===e&&(e=0,n=""),"object"===(void 0===t?"undefined":d(t))&&!Array.isArray(t))for(r in t)Object(l.hasOwnProperty)(t,r)&&(null===t[r]?(o=n+r,this.colToPropCache.push(o),this.propToColCache.set(o,e),e++):e=this.recursiveDuckColumns(t[r],e,r+"."));return e},o.prototype.createMap=function(){var t=void 0,e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new f.a;var n=this.instance.getSettings().columns;if(n){var o=this.instance.getSettings().maxCols,r=Math.min(o,n.length),i=0,a=!1,s=Object(l.deepObjectSize)(e);for("function"==typeof n&&(r=s>0?s:this.instance.countSourceCols(),a=!0),t=0;t<r;t++){var u=a?n(t):n[t];if(Object(l.isObject)(u)){if(void 0!==u.data){var c=a?i:t;this.colToPropCache[c]=u.data,this.propToColCache.set(u.data,c)}i++}}}else this.recursiveDuckColumns(e)},o.prototype.colToProp=function(t){return t=this.instance.runHooks("modifyCol",t),!isNaN(t)&&this.colToPropCache&&void 0!==this.colToPropCache[t]?this.colToPropCache[t]:t},o.prototype.propToCol=function(t){var e;return e=void 0===this.propToColCache.get(t)?t:this.propToColCache.get(t),e=this.instance.runHooks("unmodifyCol",e)},o.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},o.prototype.createRow=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments[2],r=0;if(("number"!=typeof t||t>=this.instance.countSourceRows())&&(t=this.instance.countSourceRows()),!1===this.instance.runHooks("beforeCreateRow",t,n,o))return 0;for(var i=this.instance.getSettings().maxRows,a=this.instance.countCols();r<n&&this.instance.countSourceRows()<i;)!function(){var n=null;"array"===e.instance.dataType?e.instance.getSettings().dataSchema?n=Object(l.deepClone)(e.getSchema()):(n=[],Object(h.rangeEach)(a-1,function(){return n.push(null)})):"function"===e.instance.dataType?n=e.instance.getSettings().dataSchema(t):(n={},Object(l.deepExtend)(n,e.getSchema())),t===e.instance.countSourceRows()?e.dataSource.push(n):e.spliceData(t,0,n),r++}();return this.instance.runHooks("afterCreateRow",t,r,o),this.instance.forceFullRender=!0,r},o.prototype.createCol=function(t,e,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o,r,i=this.instance.countSourceRows(),a=this.dataSource,l=0;e||(e=1),("number"!=typeof t||t>=this.instance.countCols())&&(t=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",t,e,n),r=t;for(var u=this.instance.getSettings().maxCols;l<e&&this.instance.countCols()<u;){if(o=Object(s.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){if(i>0)for(var c=0;c<i;c++)void 0===a[c]&&(a[c]=[]),a[c].push(null);else a.push([null]);this.priv.columnSettings.push(o)}else{for(var h=0;h<i;h++)a[h].splice(r,0,null);this.priv.columnSettings.splice(r,0,o)}l++,r++}return this.instance.runHooks("afterCreateCol",t,l,n),this.instance.forceFullRender=!0,l},o.prototype.removeRow=function(t,e,n){e||(e=1),"number"!=typeof t&&(t=-e),e=this.instance.runHooks("modifyRemovedAmount",e,t),t=(this.instance.countSourceRows()+t)%this.instance.countSourceRows();var o=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeRemoveRow",t,e,o,n)){var r=this.dataSource,i=void 0;i=this.filterData(t,e),i&&(r.length=0,Array.prototype.push.apply(r,i)),this.instance.runHooks("afterRemoveRow",t,e,o,n),this.instance.forceFullRender=!0}},o.prototype.removeCol=function(t,e,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countCols()+t)%this.instance.countCols();var o=this.visualColumnsToPhysical(t,e),r=o.slice(0).sort(function(t,e){return e-t});if(!1!==this.instance.runHooks("beforeRemoveCol",t,e,o,n)){for(var i=!0,a=r.length,s=this.dataSource,l=0;l<a;l++)i&&o[0]!==o[l]-l&&(i=!1);if(i)for(var u=0,c=this.instance.countSourceRows();u<c;u++)s[u].splice(o[0],e);else{for(var h=0,f=this.instance.countSourceRows();h<f;h++)for(var d=0;d<a;d++)s[h].splice(r[d],1);for(var p=0;p<a;p++)this.priv.columnSettings.splice(o[p],1)}this.instance.runHooks("afterRemoveCol",t,e,o,n),this.instance.forceFullRender=!0}},o.prototype.spliceCol=function(t,e,n){var o=arguments.length>=4?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),i=r.slice(e,e+n),a=r.slice(e+n);Object(u.extendArray)(o,a);for(var s=0;s<n;)o.push(null),s++;return Object(u.to2dArray)(o),this.instance.populateFromArray(e,t,o,null,null,"spliceCol"),i},o.prototype.spliceRow=function(t,e,n){var o=arguments.length>=4?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(t),i=r.slice(e,e+n),a=r.slice(e+n);Object(u.extendArray)(o,a);for(var s=0;s<n;)o.push(null),s++;return this.instance.populateFromArray(t,e,[o],null,null,"spliceRow"),i},o.prototype.spliceData=function(t,e,n){!1!==this.instance.runHooks("beforeDataSplice",t,e,n)&&this.dataSource.splice(t,e,n)},o.prototype.filterData=function(t,e){var n=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeDataFilter",t,e,n))return this.dataSource.filter(function(t,e){return-1==n.indexOf(e)})},o.prototype.get=function(t,e){t=this.instance.runHooks("modifyRow",t);var n=this.dataSource[t],o=this.instance.runHooks("modifyRowData",t);n=isNaN(o)?o:n;var r=null;if(n&&n.hasOwnProperty&&Object(l.hasOwnProperty)(n,e))r=n[e];else if("string"==typeof e&&e.indexOf(".")>-1){var i=e.split("."),a=n;if(!a)return null;for(var s=0,u=i.length;s<u;s++)if(void 0===(a=a[i[s]]))return null;r=a}else"function"==typeof e&&(r=e(this.dataSource.slice(t,t+1)[0]));if(this.instance.hasHook("modifyData")){var c=Object(l.createObjectPropListener)(r);this.instance.runHooks("modifyData",t,this.propToCol(e),c,"get"),c.isTouched()&&(r=c.value)}return r};var p=Object(a.cellMethodLookupFactory)("copyable",!1);o.prototype.getCopyable=function(t,e){return p.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},o.prototype.set=function(t,e,n,o){t=this.instance.runHooks("modifyRow",t,o||"datamapGet");var r=this.dataSource[t],i=this.instance.runHooks("modifyRowData",t);if(r=isNaN(i)?i:r,this.instance.hasHook("modifyData")){var a=Object(l.createObjectPropListener)(n);this.instance.runHooks("modifyData",t,this.propToCol(e),a,"set"),a.isTouched()&&(n=a.value)}if(r&&r.hasOwnProperty&&Object(l.hasOwnProperty)(r,e))r[e]=n;else if("string"==typeof e&&e.indexOf(".")>-1){var s=e.split("."),u=r,c=0,h=void 0;for(c=0,h=s.length-1;c<h;c++)void 0===u[s[c]]&&(u[s[c]]={}),u=u[s[c]];u[s[c]]=n}else"function"==typeof e?e(this.dataSource.slice(t,t+1)[0],n):r[e]=n},o.prototype.visualRowsToPhysical=function(t,e){for(var n,o=this.instance.countSourceRows(),r=(o+t)%o,i=[],a=e;r<o&&a;)n=this.instance.runHooks("modifyRow",r),i.push(n),a--,r++;return i},o.prototype.visualColumnsToPhysical=function(t,e){for(var n=this.instance.countCols(),o=(n+t)%n,r=[],i=e;o<n&&i;)r.push(this.instance.runHooks("modifyCol",o)),i--,o++;return r},o.prototype.clear=function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},o.prototype.clearLengthCache=function(){this.cachedLength=null},o.prototype.getLength=function(){var t=this,e=void 0,n=this.instance.getSettings().maxRows;e=n<0||0===n?0:n||1/0;var o=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var r=this.skipCache;this.interval.start(),o!==this.latestSourceRowsCount&&(r=!0),this.latestSourceRowsCount=o,null===this.cachedLength||r?(Object(h.rangeEach)(o-1,function(e){null===(e=t.instance.runHooks("modifyRow",e))&&--o}),this.cachedLength=o):o=this.cachedLength}else this.interval.stop();return Math.min(o,e)},o.prototype.getAll=function(){var t={row:0,col:0},e={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!=0||this.instance.countSourceRows()?this.getRange(t,e,o.prototype.DESTINATION_RENDERER):[]},o.prototype.getRange=function(t,e,n){var o,r,i,a,s,l=[],u=this.instance.getSettings().maxRows,c=this.instance.getSettings().maxCols;if(0===u||0===c)return[];var h=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(r=Math.min(Math.max(u-1,0),Math.max(t.row,e.row)),a=Math.min(Math.max(c-1,0),Math.max(t.col,e.col)),o=Math.min(t.row,e.row);o<=r;o++){s=[];var f=this.instance.runHooks("modifyRow",o);for(i=Math.min(t.col,e.col);i<=a&&null!==f;i++)s.push(h.call(this,o,this.colToProp(i)));null!==f&&l.push(s)}return l},o.prototype.getText=function(t,e){return i.a.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},o.prototype.getCopyableText=function(t,e){return i.a.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))},o.prototype.onSkipLengthCache=function(t){var e=this;this.skipCache=!0,setTimeout(function(){e.skipCache=!1},t)},o.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null},e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return"string"==typeof t&&/fps$/.test(t)&&(t=1e3/parseInt(t.replace("fps","")||0,10)),t}var i=n(42),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){var i=this;o(this,t),this.timer=null,this.func=e,this.delay=r(n),this.stopped=!0,this._then=null,this._callback=function(){return i.__callback()}}return a(t,null,[{key:"create",value:function(e,n){return new t(e,n)}}]),a(t,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=Object(i.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,Object(i.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=Object(i.requestAnimationFrame)(this._callback),this.delay){var t=Date.now(),e=t-this._then;e>this.delay&&(this._then=t-e%this.delay,this.func())}else this.func()}}]),t}()},function(t,e,n){"use strict";function o(){function t(t){return null!==t&&!n(t)&&("string"==typeof t||"number"==typeof t)}function e(t){return null!==t&&("object"==(void 0===t?"undefined":r(t))||"function"==typeof t)}function n(t){return t!==t}var o={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return t(n)?o.arrayMap[n]:e(n)?o.weakMap.get(n):void 0},set:function(n,r){if(t(n))o.arrayMap[n]=r;else{if(!e(n))throw new Error("Invalid key type");o.weakMap.set(n,r)}},delete:function(n){t(n)?delete o.arrayMap[n]:e(n)&&o.weakMap.delete(n)}}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=o},function(t,e,n){"use strict";function o(t,e,n){function o(t){n.setSelectedHeaders(!1,!1,!1);var o="function"==typeof e.settings.enterMoves?e.settings.enterMoves(event):e.settings.enterMoves;t?n.transformStart(-o.row,-o.col):n.transformStart(o.row,o.col,!0)}function c(t){t?(n.selectedHeader.cols&&n.setSelectedHeaders(n.selectedHeader.rows,!1,!1),n.transformEnd(-1,0)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(-1,0))}function h(t){t?n.transformEnd(1,0):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(1,0))}function f(t){t?n.transformEnd(0,1):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,1))}function d(t){t?(n.selectedHeader.rows&&n.setSelectedHeaders(!1,n.selectedHeader.cols,!1),n.transformEnd(0,-1)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,-1))}function p(s){var l,p;if(t.isListening()&&(t.runHooks("beforeKeyDown",s),!m&&!Object(a.isImmediatePropagationStopped)(s)&&(e.lastKeyCode=s.keyCode,n.isSelected()))){if(l=(s.ctrlKey||s.metaKey)&&!s.altKey,g&&!g.isWaiting()&&!(Object(i.isMetaKey)(s.keyCode)||Object(i.isCtrlMetaKey)(s.keyCode)||l||y.isEditorOpened()))return void y.openEditor("",s);switch(p=s.shiftKey?n.setRangeEnd:n.setRangeStart,s.keyCode){case i.KEY_CODES.A:!y.isEditorOpened()&&l&&(n.selectAll(),s.preventDefault(),Object(a.stopPropagation)(s));break;case i.KEY_CODES.ARROW_UP:y.isEditorOpened()&&!g.isWaiting()&&y.closeEditorAndSaveChanges(l),c(s.shiftKey),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_DOWN:y.isEditorOpened()&&!g.isWaiting()&&y.closeEditorAndSaveChanges(l),h(s.shiftKey),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_RIGHT:y.isEditorOpened()&&!g.isWaiting()&&y.closeEditorAndSaveChanges(l),f(s.shiftKey),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_LEFT:y.isEditorOpened()&&!g.isWaiting()&&y.closeEditorAndSaveChanges(l),d(s.shiftKey),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.TAB:n.setSelectedHeaders(!1,!1,!1);var v="function"==typeof e.settings.tabMoves?e.settings.tabMoves(s):e.settings.tabMoves;s.shiftKey?n.transformStart(-v.row,-v.col):n.transformStart(v.row,v.col,!0),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.BACKSPACE:case i.KEY_CODES.DELETE:t.emptySelectedCells(),y.prepareEditor(),s.preventDefault();break;case i.KEY_CODES.F2:y.openEditor(null,s),g&&g.enableFullEditMode(),s.preventDefault();break;case i.KEY_CODES.ENTER:y.isEditorOpened()?(g&&g.state!==u.a.WAITING&&y.closeEditorAndSaveChanges(l),o(s.shiftKey)):t.getSettings().enterBeginsEditing?(y.openEditor(null,s),g&&g.enableFullEditMode()):o(s.shiftKey),s.preventDefault(),Object(a.stopImmediatePropagation)(s);break;case i.KEY_CODES.ESCAPE:y.isEditorOpened()&&y.closeEditorAndRestoreOriginalValue(l),s.preventDefault();break;case i.KEY_CODES.HOME:n.setSelectedHeaders(!1,!1,!1),s.ctrlKey||s.metaKey?p.call(n,new r.a(0,n.selectedRange.current().from.col)):p.call(n,new r.a(n.selectedRange.current().from.row,0)),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.END:n.setSelectedHeaders(!1,!1,!1),s.ctrlKey||s.metaKey?p.call(n,new r.a(t.countRows()-1,n.selectedRange.current().from.col)):p.call(n,new r.a(n.selectedRange.current().from.row,t.countCols()-1)),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.PAGE_UP:n.setSelectedHeaders(!1,!1,!1),n.transformStart(-t.countVisibleRows(),0),s.preventDefault(),Object(a.stopPropagation)(s);break;case i.KEY_CODES.PAGE_DOWN:n.setSelectedHeaders(!1,!1,!1),n.transformStart(t.countVisibleRows(),0),s.preventDefault(),Object(a.stopPropagation)(s)}}}var v,g,y=this,m=!1;v=new l.a(t),this.destroyEditor=function(t){this.closeEditor(t)},this.getActiveEditor=function(){return g},this.prepareEditor=function(){var e,n,o,r,i,a,l;if(g&&g.isWaiting())return void this.closeEditor(!1,!1,function(t){t&&y.prepareEditor()});e=t.selection.selectedRange.current().highlight.row,n=t.selection.selectedRange.current().highlight.col,o=t.colToProp(n),r=t.getCell(e,n),i=t.getSourceDataAtCell(t.runHooks("modifyRow",e),n),a=t.getCellMeta(e,n),l=t.getCellEditor(a),l?(g=Object(s.b)(l,t),g.prepare(e,n,o,r,i,a)):g=void 0},this.isEditorOpened=function(){return g&&g.isOpened()},this.openEditor=function(t,e){g&&!g.cellProperties.readOnly?g.beginEditing(t,e):g&&g.cellProperties.readOnly&&e&&e.keyCode===i.KEY_CODES.ENTER&&o()},this.closeEditor=function(t,e,n){g?g.finishEditing(t,e,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},function(){function e(t,e,n){"TD"===n.nodeName&&(y.openEditor(null,t),g&&g.enableFullEditMode())}t.addHook("afterDocumentKeyDown",p),v.addEventListener(document.documentElement,"keydown",function(e){m||t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",e),t.addHook("afterDestroy",function(){m=!0})}()}var r=n(9),i=n(18),a=n(11),s=n(19),l=n(8),u=n(52);e.a=o},function(t,e,n){"use strict";function o(t){var e=this,n=this;this.eventManager=new a.a(t),this.instance=t,this.settings=t.getSettings(),this.selectionMouseDown=!1;var o=t.rootElement.getAttribute("style");o&&t.rootElement.setAttribute("data-originalstyle",o),Object(r.addClass)(t.rootElement,"handsontable");var u=document.createElement("TABLE");Object(r.addClass)(u,"htCore"),t.getSettings().tableClassName&&Object(r.addClass)(u,t.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),u.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),u.appendChild(this.TBODY),t.table=u,t.container.insertBefore(u,t.container.firstChild),this.eventManager.addEventListener(t.rootElement,"mousedown",function(t){this.selectionMouseDown=!0,n.isTextSelectionAllowed(t.target)||(h(),t.preventDefault(),window.focus())}),this.eventManager.addEventListener(t.rootElement,"mouseup",function(t){this.selectionMouseDown=!1}),this.eventManager.addEventListener(t.rootElement,"mousemove",function(t){this.selectionMouseDown&&!n.isTextSelectionAllowed(t.target)&&(h(),t.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){t.selection.isInProgress()&&!e.shiftKey&&t.selection.finish()});var c;this.isMouseDown=function(){return c},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){t.selection.isInProgress()&&Object(s.isLeftClick)(e)&&t.selection.finish(),c=!1,(Object(r.isOutsideInput)(document.activeElement)||!t.selection.isSelected()&&!Object(s.isRightClick)(e))&&t.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var o=e.target,i=e.target,a=e.x||e.clientX,s=e.y||e.clientY;if(!c&&t.rootElement){if(i===t.view.wt.wtTable.holder){var l=Object(r.getScrollbarWidth)();if(document.elementFromPoint(a+l,s)!==t.view.wt.wtTable.holder||document.elementFromPoint(a,s+l)!==t.view.wt.wtTable.holder)return}else for(;i!==document.documentElement;){if(null===i){if(e.isTargetWebComponent)break;return}if(i===t.rootElement)return;i=i.parentNode}("function"==typeof n.settings.outsideClickDeselects?n.settings.outsideClickDeselects(o):n.settings.outsideClickDeselects)?t.deselectCell():t.destroyEditor()}}),this.eventManager.addEventListener(u,"selectstart",function(t){n.settings.fragmentSelection||Object(r.isInput)(t.target)||t.preventDefault()});var h=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},f={debug:function(){return n.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:u,preventOverflow:function(){return e.settings.preventOverflow},stretchH:function(){return n.settings.stretchH},data:t.getDataAtCell,totalRows:function(){return t.countRows()},totalColumns:function(){return t.countCols()},fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},fixedRowsBottom:function(){return n.settings.fixedRowsBottom},minSpareRows:function(){return n.settings.minSpareRows},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var e=[];return t.hasRowHeaders()&&e.push(function(t,e){n.appendRowHeader(t,e)}),t.runHooks("afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return t.hasColHeaders()&&e.push(function(t,e){n.appendColHeader(t,e)}),t.runHooks("afterGetColumnHeaderRenderers",e),e},columnWidth:t.getColWidth,rowHeight:t.getRowHeight,cellRenderer:function(t,e,o){var r=n.instance.getCellMeta(t,e),i=n.instance.colToProp(e),a=n.instance.getDataAtRowProp(t,i);n.instance.hasHook("beforeValueRender")&&(a=n.instance.runHooks("beforeValueRender",a)),n.instance.runHooks("beforeRenderer",o,t,e,i,a,r),n.instance.getCellRenderer(r)(n.instance,o,t,e,i,a,r),n.instance.runHooks("afterRenderer",o,t,e,i,a,r)},selections:n.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,o,r,i){var a={row:!1,column:!1,cells:!1};if(t.listen(),n.activeWt=i,c=!0,t.runHooks("beforeOnCellMouseDown",e,o,r,a),!Object(s.isImmediatePropagationStopped)(e)){var u=t.getSelectedRangeLast(),h=t.selection,f=h.selectedHeader;if(e.shiftKey&&u)o.row>=0&&o.col>=0&&!a.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(o)):(f.cols||f.rows)&&o.row>=0&&o.col>=0&&!a.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(new l.a(o.row,o.col))):f.cols&&o.row<0&&!a.column?h.setRangeEnd(new l.a(u.to.row,o.col)):f.rows&&o.col<0&&!a.row?h.setRangeEnd(new l.a(o.row,u.to.col)):(!f.cols&&!f.rows&&o.col<0||f.cols&&o.col<0)&&!a.row?(h.setSelectedHeaders(!0,!1),h.setRangeStartOnly(new l.a(u.from.row,0)),h.setRangeEnd(new l.a(o.row,t.countCols()-1))):(!f.cols&&!f.rows&&o.row<0||f.rows&&o.row<0)&&!a.column&&(h.setSelectedHeaders(!1,!0),h.setRangeStartOnly(new l.a(0,u.from.col)),h.setRangeEnd(new l.a(t.countRows()-1,o.col)));else{var d=!0;if(u){var p=u.from,v=u.to,g=!h.inInSelection(o);if(o.row<0&&f.cols){var y=Math.min(p.col,v.col),m=Math.max(p.col,v.col);d=o.col<y||o.col>m}else if(o.col<0&&f.rows){var b=Math.min(p.row,v.row),w=Math.max(p.row,v.row);d=o.row<b||o.row>w}else d=g}var O=Object(s.isRightClick)(e),C=Object(s.isLeftClick)(e)||"touchstart"===e.type;o.row<0&&o.col>=0&&!a.column?(h.setSelectedHeaders(!1,!0),(C||O&&d)&&(h.setRangeStartOnly(new l.a(0,o.col)),h.setRangeEnd(new l.a(Math.max(t.countRows()-1,0),o.col),!1))):o.col<0&&o.row>=0&&!a.row?(h.setSelectedHeaders(!0,!1),(C||O&&d)&&(h.setRangeStartOnly(new l.a(o.row,0)),h.setRangeEnd(new l.a(o.row,Math.max(t.countCols()-1,0)),!1))):o.col>=0&&o.row>=0&&!a.cells?(C||O&&d)&&(h.setSelectedHeaders(!1,!1),h.setRangeStart(o)):o.col<0&&o.row<0&&(o.row=0,o.col=0,h.setSelectedHeaders(!1,!1,!0),h.setRangeStart(o))}t.runHooks("afterOnCellMouseDown",e,o,r),n.activeWt=n.wt}},onCellMouseOut:function(e,o,r,i){n.activeWt=i,t.runHooks("beforeOnCellMouseOut",e,o,r),Object(s.isImmediatePropagationStopped)(e)||(t.runHooks("afterOnCellMouseOut",e,o,r),n.activeWt=n.wt)},onCellMouseOver:function(e,o,r,i){var a={row:!1,column:!1,cell:!1};n.activeWt=i,t.runHooks("beforeOnCellMouseOver",e,o,r,a),Object(s.isImmediatePropagationStopped)(e)||(Object(s.isLeftClick)(e)&&c&&(t.selection.selectedHeader.cols&&!a.column?t.selection.setRangeEnd(new l.a(t.countRows()-1,o.col),!1):t.selection.selectedHeader.rows&&!a.row?t.selection.setRangeEnd(new l.a(o.row,t.countCols()-1),!1):a.cell||t.selection.setRangeEnd(o)),t.runHooks("afterOnCellMouseOver",e,o,r),n.activeWt=n.wt)},onCellMouseUp:function(e,o,r,i){n.activeWt=i,t.runHooks("beforeOnCellMouseUp",e,o,r),t.runHooks("afterOnCellMouseUp",e,o,r),n.activeWt=n.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(t,e){n.beforeRender(t,e)},onDraw:function(t){n.onDraw(t)},onScrollVertically:function(){t.runHooks("afterScrollVertically")},onScrollHorizontally:function(){t.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,n){t.runHooks("beforeDrawBorders",e,n)},onBeforeTouchScroll:function(){t.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){t.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){return t.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:function(e){return t.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,o){return t.runHooks("modifyGetCellCoords",e,n,o)},viewportRowCalculatorOverride:function(e){var o=t.countRows(),r=n.settings.viewportRowRenderingOffset;if("auto"===r&&n.settings.fixedRowsTop&&(r=10),"number"==typeof r&&(e.startRow=Math.max(e.startRow-r,0),e.endRow=Math.min(e.endRow+r,o-1)),"auto"===r){var i=e.startRow+e.endRow-e.startRow,a=Math.ceil(i/o*12);e.startRow=Math.max(e.startRow-a,0),e.endRow=Math.min(e.endRow+a,o-1)}t.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var o=t.countCols(),r=n.settings.viewportColumnRenderingOffset;if("auto"===r&&n.settings.fixedColumnsLeft&&(r=10),"number"==typeof r&&(e.startColumn=Math.max(e.startColumn-r,0),e.endColumn=Math.min(e.endColumn+r,o-1)),"auto"===r){var i=e.startColumn+e.endColumn-e.startColumn,a=Math.ceil(i/o*12);e.startRow=Math.max(e.startColumn-a,0),e.endColumn=Math.min(e.endColumn+a,o-1)}t.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return n.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.runHooks("modifyColumnHeaderHeight");return n.settings.columnHeaderHeight||e}};t.runHooks("beforeInitWalkontable",f),this.wt=new l.e(f),this.activeWt=this.wt,Object(i.isChrome)()||Object(i.isSafari)()||this.eventManager.addEventListener(t.rootElement,"wheel",function(t){t.preventDefault();var e=parseInt(Object(r.getComputedStyle)(document.body)["font-size"],10),o=n.wt.wtOverlays.scrollableElement,i=t.wheelDeltaY||t.deltaY,a=t.wheelDeltaX||t.deltaX;switch(t.deltaMode){case 0:o.scrollLeft+=a,o.scrollTop+=i;break;case 1:o.scrollLeft+=a*e,o.scrollTop+=i*e}}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&Object(s.stopPropagation)(t)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&Object(s.stopPropagation)(t)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})}var r=n(2),i=n(33),a=n(8),s=n(11),l=n(9),u=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();o.prototype.isTextSelectionAllowed=function(t){if(Object(r.isInput)(t))return!0;var e=Object(r.isChildOf)(t,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())},o.prototype.isSelectedOnlyCell=function(){var t=this.instance.getSelectedLast()||[],e=u(t,4),n=e[0],o=e[1],r=e[2],i=e[3];return void 0!==n&&n===r&&o===i},o.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},o.prototype.beforeRender=function(t,e){t&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,e)},o.prototype.onDraw=function(t){t&&this.instance.runHooks("afterRender",this.instance.forceFullRender)},o.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},o.prototype.getCellAtCoords=function(t,e){var n=this.wt.getCell(t,e);return n<0?null:n},o.prototype.scrollViewport=function(t){this.wt.scrollViewport(t)},o.prototype.appendRowHeader=function(t,e){if(e.firstChild){var n=e.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=document.createElement("div"),i=document.createElement("span");o.className="relative",i.className="rowHeader",this.updateCellHeader(i,t,this.instance.getRowHeader),o.appendChild(i),e.appendChild(o)}this.instance.runHooks("afterGetRowHeader",t,e)},o.prototype.appendColHeader=function(t,e){if(e.firstChild){var n=e.firstChild;Object(r.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader):(Object(r.empty)(e),this.appendColHeader(t,e))}else{var o=document.createElement("div"),i=document.createElement("span");o.className="relative",i.className="colHeader",this.updateCellHeader(i,t,this.instance.getColHeader),o.appendChild(i),e.appendChild(o)}this.instance.runHooks("afterGetColHeader",t,e)},o.prototype.updateCellHeader=function(t,e,n){var o=e,i=this.wt.wtOverlays.getParentOverlay(t)||this.wt;t.parentNode&&(Object(r.hasClass)(t,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(e):Object(r.hasClass)(t,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(e))),o>-1?Object(r.fastInnerHTML)(t,n(e)):(Object(r.fastInnerText)(t,String.fromCharCode(160)),Object(r.addClass)(t,"cornerHeader"))},o.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth(),n=e-t;return n>0?n:0},o.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight(),n=e-t;return n>0?n:0},o.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},o.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()},e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(0),a=n(4),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];o(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return s(t,[{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.data;return t&&(e=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),e}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return Object(i.arrayEach)(this.data,function(o){var i=e.colToProp(t);o="string"==typeof i?Object(r.getProperty)(o,i):o[i],n.push(o)}),n}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,e){var n=null,o=this.hot.runHooks("modifyRowData",t),i=isNaN(o)?o:this.data[t];if(i){var a=this.colToProp(e);n="string"==typeof a?Object(r.getProperty)(i,a):"function"==typeof a?a(this.data.slice(t,t+1)[0]):i[a]}return n}},{key:"getByRange",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Math.min(t.row,e.row),i=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col),u=[];return Object(a.rangeEach)(r,s,function(t){var e=n.getAtRow(t),r=void 0;"array"===n.dataType?r=e.slice(i,l+1):"object"===n.dataType&&(r=o?[]:{},Object(a.rangeEach)(i,l,function(t){var i=n.colToProp(t);o?r.push(e[i]):r[i]=e[i]})),u.push(r)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&("array"===this.dataType?t=this.data[0].length:"object"===this.dataType&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}()},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r,i=n(3);e.a=(r={languageCode:"en-US"},o(r,i.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),o(r,i.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),o(r,i.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),o(r,i.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),o(r,i.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),o(r,i.CONTEXTMENU_ITEMS_UNDO,"Undo"),o(r,i.CONTEXTMENU_ITEMS_REDO,"Redo"),o(r,i.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),o(r,i.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),o(r,i.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),o(r,i.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),o(r,i.CONTEXTMENU_ITEMS_BORDERS,"Borders"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),o(r,i.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),o(r,i.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),o(r,i.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),o(r,i.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),o(r,i.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),o(r,i.CONTEXTMENU_ITEMS_COPY,"Copy"),o(r,i.CONTEXTMENU_ITEMS_CUT,"Cut"),o(r,i.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),o(r,i.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),o(r,i.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),o(r,i.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),o(r,i.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),o(r,i.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),o(r,i.FILTERS_CONDITIONS_NONE,"None"),o(r,i.FILTERS_CONDITIONS_EMPTY,"Is empty"),o(r,i.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),o(r,i.FILTERS_CONDITIONS_EQUAL,"Is equal to"),o(r,i.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),o(r,i.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),o(r,i.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),o(r,i.FILTERS_CONDITIONS_CONTAINS,"Contains"),o(r,i.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),o(r,i.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),o(r,i.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),o(r,i.FILTERS_CONDITIONS_LESS_THAN,"Less than"),o(r,i.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),o(r,i.FILTERS_CONDITIONS_BETWEEN,"Is between"),o(r,i.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),o(r,i.FILTERS_CONDITIONS_AFTER,"After"),o(r,i.FILTERS_CONDITIONS_BEFORE,"Before"),o(r,i.FILTERS_CONDITIONS_TODAY,"Today"),o(r,i.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),o(r,i.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),o(r,i.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),o(r,i.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),o(r,i.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),o(r,i.FILTERS_LABELS_CONJUNCTION,"And"),o(r,i.FILTERS_LABELS_DISJUNCTION,"Or"),o(r,i.FILTERS_BUTTONS_SELECT_ALL,"Select all"),o(r,i.FILTERS_BUTTONS_CLEAR,"Clear"),o(r,i.FILTERS_BUTTONS_OK,"OK"),o(r,i.FILTERS_BUTTONS_CANCEL,"Cancel"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r)},function(t,e,n){"use strict";function o(){return l()}n.d(e,"a",function(){return o});var r=n(47),i=n(310),a=Object(r.a)("phraseFormatters"),s=a.register,l=a.getValues;!function(t,e){s("pluralize",e)}(0,i.a)},function(t,e,n){"use strict";function o(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}e.a=o},function(t,e,n){"use strict";var o=(n(209),n(317));n.d(e,"a",function(){return o.a})},function(t,e,n){"use strict";function o(t,e){return h(t)(e)}n.d(e,"a",function(){return o});var r=n(47),i=n(313),a=n(314),s=n(315),l=n(316),u=Object(r.a)("highlight/types"),c=u.register,h=u.getItem;c("area",i.a),c("cell",a.a),c("fill",s.a),c("header",l.a)},function(t,e,n){"use strict";function o(t){var e=t.layerLevel,n=t.multipleSelectionHandlesVisible,o=t.areaCornerVisible;return new r.c({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:o,multipleSelectionHandlesVisible:n}})}var r=n(9);e.a=o},function(t,e,n){"use strict";function o(t){return new r.c({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t.cellCornerVisible,multipleSelectionHandlesVisible:t.multipleSelectionHandlesVisible}})}var r=n(9);e.a=o},function(t,e,n){"use strict";function o(){return new r.c({className:"fill",border:{width:1,color:"#ff0000"}})}var r=n(9);e.a=o},function(t,e,n){"use strict";function o(t){return new r.c({className:"highlight",highlightHeaderClassName:t.headerClassName,highlightRowClassName:t.rowClassName,highlightColumnClassName:t.columnClassName})}var r=n(9);e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(209),i=n(318),a=n(9),s=n(208),l=n(1),u=n(14),c=(n(2),n(0)),h=n(21),f=n(319),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function(){function t(e,n){var a=this;o(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedHeader={cols:!1,rows:!1,corner:!1},this.selectedRange=new i.a,this.highlight=new r.d({headerClassName:e.currentHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return a.isCellCornerVisible.apply(a,arguments)},areaCornerVisible:function(){return a.isAreaCornerVisible.apply(a,arguments)}}),this.transformation=new f.a(this.selectedRange,{countRows:function(){return a.tableProps.countRows()},countCols:function(){return a.tableProps.countCols()},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["beforeModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["afterModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["beforeModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["afterModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["insertRowRequire"].concat(e))}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runLocalHooks.apply(a,["insertColRequire"].concat(e))})}return d(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"setSelectedHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.selectedHeader.rows=t,this.selectedHeader.cols=e,this.selectedHeader.corner=n}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],o="multiple"===this.settings.selectionMode,r=Object(u.isUndefined)(n)?Object(s.a)():n;this.runLocalHooks("beforeSetRangeStart",t),(!o||o&&!r)&&this.selectedRange.clear(),this.selectedRange.add(t),this.setRangeEnd(t,null,e)}},{key:"setRangeStartOnly",value:function(t,e){var n="multiple"===this.settings.selectionMode,o=Object(u.isUndefined)(e)?Object(s.a)():e;this.runLocalHooks("beforeSetRangeStartOnly",t),(!n||n&&!o)&&this.selectedRange.clear(),this.selectedRange.add(t)}},{key:"setRangeEnd",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var o=this.selectedRange.current();"single"!==this.settings.selectionMode&&o.setTo(new a.a(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(r.b)&&this.highlight.getCell().add(this.selectedRange.current().highlight);var i=this.selectedRange.size()-1;i<this.highlight.layerLevel&&(Object(c.arrayEach)(this.highlight.getAreas(),function(t){t.clear()}),Object(c.arrayEach)(this.highlight.getHeaders(),function(t){t.clear()})),this.highlight.useLayerLevel(i);var s=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader();s.clear(),l.clear(),this.highlight.isEnabledFor(r.a)&&(this.isMultiple()||i>=1)&&(s.add(o.from).add(o.to),1===i&&(this.highlight.useLayerLevel(i-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(i))),this.highlight.isEnabledFor(r.c)&&("single"===this.settings.selectionMode?l.add(o.highlight):l.add(o.from).add(o.to)),this.runLocalHooks("afterSetRangeEnd",t,e,n)}}},{key:"isMultiple",value:function(){var t=Object(l.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e,n,o){this.setRangeStart(this.transformation.transformStart(t,e,n),o,!1)}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e),!0,!1)}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(t){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return t===this.selectedRange.ranges.length-1&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.selectedRange.clear(),this.highlight.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){"single"!==this.settings.selectionMode&&(this.setSelectedHeaders(!0,!0,!0),this.highlight.clear(),this.setRangeStart(new a.a(0,0)),this.setRangeEnd(new a.a(this.tableProps.countRows()-1,this.tableProps.countCols()-1),!1))}}]),t}();Object(l.mixin)(p,h.a),e.a=p},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(9),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){o(this,t),this.ranges=[]}return i(t,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(new r.b(t)),this}},{key:"add",value:function(t){return this.ranges.push(new r.b(t)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some(function(e){return e.includes(t)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.size()+t-1,n=void 0;return e>=0&&(n=this.ranges[e]),n}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(9),i=n(1),a=n(21),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(){function t(e,n){o(this,t),this.range=e,this.options=n}return s(t,[{key:"transformStart",value:function(t,e,n){var o=new r.a(t,e);this.runLocalHooks("beforeTransformStart",o);var i=this.options.countRows(),a=this.options.countCols(),s=this.options.fixedRowsBottom(),l=this.options.minSpareRows(),u=this.options.minSpareCols(),c=this.options.autoWrapRow(),h=this.options.autoWrapCol(),f=this.range.current().highlight;f.row+t>i-1?n&&l>0&&!(s&&f.row>=i-s-1)?(this.runLocalHooks("insertRowRequire",i),i=this.options.countRows()):h&&(o.row=1-i,o.col=f.col+o.col==a-1?1-a:1):h&&f.row+o.row<0&&f.col+o.col>=0&&(o.row=i-1,o.col=f.col+o.col==0?a-1:-1),f.col+o.col>a-1?n&&u>0?(this.runLocalHooks("insertColRequire",i),a=this.options.countCols()):c&&(o.row=f.row+o.row==i-1?1-i:1,o.col=1-a):c&&f.col+o.col<0&&f.row+o.row>=0&&(o.row=f.row+o.row==0?i-1:-1,o.col=a-1);var d=new r.a(f.row+o.row,f.col+o.col),p=0,v=0;return d.row<0?(p=-1,d.row=0):d.row>0&&d.row>=i&&(p=1,d.row=i-1),d.col<0?(v=-1,d.col=0):d.col>0&&d.col>=a&&(v=1,d.col=a-1),this.runLocalHooks("afterTransformStart",d,p,v),d}},{key:"transformEnd",value:function(t,e){var n=new r.a(t,e);this.runLocalHooks("beforeTransformEnd",n);var o=this.options.countRows(),i=this.options.countCols(),a=this.range.current(),s=new r.a(a.to.row+n.row,a.to.col+n.col),l=0,u=0;return s.row<0?(l=-1,s.row=0):s.row>0&&s.row>=o&&(l=1,s.row=o-1),s.col<0?(u=-1,s.col=0):s.col>0&&s.col>=i&&(u=1,s.col=i-1),this.runLocalHooks("afterTransformEnd",s,l,u),s}}]),t}();Object(i.mixin)(l,a.a),e.a=l},function(t,e,n){"use strict";function o(t){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n=this.first(),o=n.data("handsontable");if("string"!=typeof e){var r=e||{};return o?o.updateSettings(r):(o=new t.Core(n[0],r),n.data("handsontable",o),o.init()),n}var i=[],a=void 0;if(arguments.length>1)for(var s=1,l=arguments.length;s<l;s++)i.push(arguments[s]);if(o){if(void 0===o[e])throw new Error("Handsontable do not provide action: "+e);a=o[e].apply(o,i),"destroy"===e&&n.removeData()}return a})}e.a=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(322),r=n(324),i=n(325),a=n(327),s=n(328),l=n(331),u=n(335),c=n(338),h=n(345),f=n(346),d=n(347),p=n(351),v=n(356),g=n(357),y=n(362),m=n(363),b=n(370),w=n(371),O=n(374),C=n(375),E=n(376),S=n(7);n.d(e,"AutoColumnSize",function(){return r.a}),n.d(e,"AutoFill",function(){return i.a}),n.d(e,"AutoRowSize",function(){return a.a}),n.d(e,"ColumnSorting",function(){return s.a}),n.d(e,"Comments",function(){return l.a}),n.d(e,"ContextMenu",function(){return u.a}),n.d(e,"CopyPaste",function(){return c.a}),n.d(e,"CustomBorders",function(){return h.a}),n.d(e,"DragToScroll",function(){return f.a}),n.d(e,"ManualColumnFreeze",function(){return d.a}),n.d(e,"ManualColumnMove",function(){return p.a}),n.d(e,"ManualColumnResize",function(){return v.a}),n.d(e,"ManualRowMove",function(){return g.a}),n.d(e,"ManualRowResize",function(){return y.a}),n.d(e,"MergeCells",function(){return m.a}),n.d(e,"MultipleSelectionHandles",function(){return b.a}),n.d(e,"ObserveChanges",function(){return w.a}),n.d(e,"PersistentState",function(){return o.a}),n.d(e,"Search",function(){return O.a}),n.d(e,"TouchScroll",function(){return C.a}),n.d(e,"UndoRedo",function(){return E.a}),n.d(e,"Base",function(){return S.a})},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(6),l=n(323),u=n(13),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};u.a.getSingleton().register("persistentStateSave"),u.a.getSingleton().register("persistentStateLoad"),u.a.getSingleton().register("persistentStateReset");var f=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.storage=void 0,n}return i(e,t),c(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new l.a(this.hot.rootElement.id)),this.addHook("persistentStateSave",function(e,n){return t.saveValue(e,n)}),this.addHook("persistentStateLoad",function(e,n){return t.loadValue(e,n)}),this.addHook("persistentStateReset",function(){return t.resetValue()}),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(s.d)("persistentState",f),e.a=f},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return i(t,[{key:"saveValue",value:function(t,e){window.localStorage.setItem(this.prefix+"_"+t,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){t=void 0===t?e:t;var n=window.localStorage.getItem(this.prefix+"_"+t);return null===n?void 0:JSON.parse(n)}},{key:"reset",value:function(t){window.localStorage.removeItem(this.prefix+"_"+t)}},{key:"resetAll",value:function(){var t=this;Object(r.arrayEach)(this.savedKeys,function(e,n){window.localStorage.removeItem(t.prefix+"_"+t.savedKeys[n])}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=window.localStorage.getItem(this.prefix+"__persistentStateKeys"),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){window.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=n(42),u=n(2),c=n(155),h=n(1),f=n(4),d=n(6),p=n(210),v=n(30),g=n(9),y=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},b=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),w=new WeakMap,O=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return w.set(n,{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new c.a(n.hot),n.samplesGenerator=new p.a(function(t,e){return n.hot.getCellMeta(t,e).spanned?"":n.hot.getDataAtCell(t,e)}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",function(t,e,o){return n.onBeforeColumnResize(t,e,o)}),n}return i(e,t),b(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),b(e,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().autoColumnSize;n&&null!=n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("modifyColWidth",function(e,n){return t.getColumnWidth(n,e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"number"==typeof t&&(t={from:t,to:t}),"number"==typeof n&&(n={from:n,to:n}),Object(f.rangeEach)(t.from,t.to,function(t){(o||void 0===e.widths[t]&&!e.hot._getColWidthFromSettings(t))&&e.samplesGenerator.generateColumnSamples(t,n).forEach(function(t,n){return e.ghostTable.addColumn(n,t)})}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(t,n){e.widths[t]=n}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,r=this.hot.countCols()-1,i=null;this.inProgress=!0,this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,o=this.getSyncCalculationLimit()+1),o<r?function a(){if(!t.hot)return Object(l.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateColumnsWidth({from:o,to:Math.min(o+e.CALCULATION_STEP,r)},n),o=o+e.CALCULATION_STEP+1,o<r?i=Object(l.requestAnimationFrame)(a):(Object(l.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoColumnSize,e=t&&Object(h.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=t&&Object(h.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&Object(u.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return Object(h.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,Object(v.isPercentValue)(t)?t=Object(f.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e;return void 0===o&&(o=this.widths[t],n&&"number"==typeof o&&(o=Math.max(o,g.d.DEFAULT_WIDTH))),o}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getFirstVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getLastVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=w.get(this),n=e.cachedColumnHeaders;return Object(s.arrayReduce)(t,function(t,e,o){var r=n.length;return(r-1<o||n[o]!==e)&&t.push(o),r-1<o?n.push(e):n[o]=e,t},[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?Object(s.arrayEach)(e,function(e){t.widths[e]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!Object(s.arrayFilter)(this.widths,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){t.hot&&t.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(t){var e=this;this.clearCache(Object(s.arrayMap)(t,function(t){var n=y(t,2);return e.hot.propToCol(n[1])}))}},{key:"onBeforeColumnResize",value:function(t,e,n){return n&&(this.calculateColumnsWidth(t,void 0,!0),e=this.getColumnWidth(t,void 0,!1)),e}},{key:"onAfterInit",value:function(){w.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(d.d)("autoColumnSize",O),e.a=O},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(13),l=n(2),u=n(8),c=n(6),h=n(9),f=n(326),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};s.a.getSingleton().register("modifyAutofillRange"),s.a.getSingleton().register("beforeAutofill");var v=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new u.a(n),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}return i(e,t),d(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(e){return t.onAfterCellCornerMouseDown(e)}),this.addHook("afterOnCellCornerDblClick",function(e){return t.onCellCornerDblClick(e)}),this.addHook("beforeOnCellMouseOver",function(e,n,o){return t.onBeforeCellMouseOver(n)}),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(t.from.row,t.from.col,t.to.row,t.to.col)}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var e=this.getCornersOfSelectedCells();t=this.hot.runHooks("modifyAutofillRange",t,e);var n=Object(f.c)(e,t),o=n.directionOfDrag,r=n.startOfDragCoords,i=n.endOfDragCoords;if(r&&r.row>-1&&r.col>-1){var a=this.getSelectionData();this.hot.runHooks("beforeAutofill",r,i,a);var s=Object(f.b)(r,i,a,o),l=a;if(["up","left"].indexOf(o)>-1){l=[];var u=null,c=null;if("up"===o){u=i.row-r.row+1,c=u%a.length;for(var h=0;h<u;h++)l.push(a[(h+(a.length-c))%a.length])}else{u=i.col-r.col+1,c=u%a[0].length;for(var d=0;d<a.length;d++){l.push([]);for(var p=0;p<u;p++)l[d].push(a[d][(p+(a[d].length-c))%a[d].length])}}}this.hot.populateFromArray(r.row,r.col,l,i.row,i.col,this.pluginName+".fill",null,o,s),this.setSelection(t)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast().getTopLeftCorner(),n=this.hot.getSelectedRangeLast().getBottomRightCorner(),o=void 0;if(this.directions.includes(f.a.vertical)&&(n.row<t.row||e.row>t.row))o=new h.a(t.row,n.col);else{if(!this.directions.includes(f.a.horizontal))return;o=new h.a(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(o)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.alter("insert_row",void 0,1,t.pluginName+".fill"),t.addingStarted=!1},200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e=this.hot.getData(),n=this.hot.countRows(),o=void 0,r=t[2]+1;r<n;r++){for(var i=t[1];i<=t[3];i++)if(e[r][i])return-1;var a=e[r][t[1]-1],s=e[r][t[3]+1];(a||s)&&(o=r)}return o}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(new h.a(t[0],t[1])).add(new h.a(e,t[3]))}},{key:"setSelection",value:function(t){this.hot.selection.setRangeStart(new h.a(t[0],t[1])),this.hot.selection.setRangeEnd(new h.a(t[2],t[3]))}},{key:"selectAdjacent",value:function(){var t=this.getCornersOfSelectedCells(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=Object(l.offset)(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+Object(l.outerHeight)(this.hot.table),n=Object(l.offset)(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+Object(l.outerWidth)(this.hot.table);return t.clientY>e&&t.clientX<=n}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=Object(f.d)(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(c.d)("autofill",v),e.a=v},function(t,e,n){"use strict";function o(t,e,n,o){var r=n.length,i=n?n[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(-1!==["down","up"].indexOf(o)){for(var u=[],c=0;c<=l;c++){var h=parseInt(n[0][c],10),f=parseInt(n[r-1][c],10);u.push(("down"===o?f-h:h-f)/(r-1)||0)}a.push(u)}if(-1!==["right","left"].indexOf(o))for(var d=0;d<=s;d++){var p=parseInt(n[d][0],10),v=parseInt(n[d][i-1],10),g=("right"===o?v-p:p-v)/(i-1)||0;a.push([g])}return a}function r(t,e){var n=void 0,o=void 0,r=void 0;return e[0]===t[0]&&e[1]<t[1]?(r="left",n=new l.a(e[0],e[1]),o=new l.a(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",n=new l.a(e[0],t[3]+1),o=new l.a(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",n=new l.a(e[0],e[1]),o=new l.a(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",n=new l.a(t[2]+1,e[1]),o=new l.a(e[2],e[3])),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:o}}function i(t){var e={};return!0===t?(e.directions=Object.keys(u),e.autoInsertRow=!0):Object(a.isObject)(t)?(e.autoInsertRow=!!Object(s.isDefined)(t.autoInsertRow)&&t.direction!==u.horizontal&&t.autoInsertRow,e.directions=Object(s.isDefined)(t.direction)?[t.direction]:Object.keys(u)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}n.d(e,"a",function(){return u}),e.b=o,e.c=r,e.d=i;var a=n(1),s=n(14),l=n(9),u={horizontal:"horizontal",vertical:"vertical"}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=n(42),u=n(2),c=n(155),h=n(1),f=n(4),d=n(6),p=n(210),v=n(30),g=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.heights=[],n.ghostTable=new c.a(n.hot),n.samplesGenerator=new p.a(function(t,e){return t>=0?n.hot.getDataAtCell(t,e):-1===t?n.hot.getColHeader(e):null}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",function(t,e,o){return n.onBeforeRowResize(t,e,o)}),n}return i(e,t),y(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),y(e,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||Object(h.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeColumnMove",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return t.clearCache()}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("beforeRowMove",function(e,n){return t.onBeforeRowMove(e,n)}),this.addHook("modifyRowHeight",function(e,n){return t.getRowHeight(n,e)}),this.addHook("modifyColumnHeaderHeight",function(){return t.getColumnHeaderHeight()}),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"number"==typeof t&&(t={from:t,to:t}),"number"==typeof n&&(n={from:n,to:n}),null!==this.hot.getColHeader(0)&&this.ghostTable.addColumnHeadersRow(this.samplesGenerator.generateRowSamples(-1,n).get(-1)),Object(f.rangeEach)(t.from,t.to,function(t){(o||void 0===e.heights[t])&&e.samplesGenerator.generateRowSamples(t,n).forEach(function(t,n){e.ghostTable.addRow(n,t)})}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(t,n){e.heights[t]=n}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,r=this.hot.countRows()-1,i=null;this.inProgress=!0,this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,o=this.getSyncCalculationLimit()+1),o<r?function a(){if(!t.hot)return Object(l.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateRowsHeight({from:o,to:Math.min(o+e.CALCULATION_STEP,r)},n),o=o+e.CALCULATION_STEP+1,o<r?i=Object(l.requestAnimationFrame)(a):(Object(l.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&Object(h.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=t&&Object(h.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(u.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return Object(h.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,Object(v.isPercentValue)(t)?t=Object(f.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e;return void 0!==this.heights[t]&&this.heights[t]>(e||0)&&(n=this.heights[t]),n}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(t){var e=this;"number"==typeof t&&(t={from:t,to:t}),Object(f.rangeEach)(Math.min(t.from,t.to),Math.max(t.from,t.to),function(t){e.heights[t]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!Object(s.arrayFilter)(this.heights,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,t);var e=this.hot.getSettings().fixedRowsBottom;if(e){var n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-e,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){return n&&(this.calculateRowsHeight(t,void 0,!0),e=this.getRowHeight(t)),e}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){t.hot&&t.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(d.d)("autoRowSize",m),e.a=m},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(31),l=n.n(s),u=n(2),c=n(0),h=n(14),f=n(1),d=n(7),p=n(6),v=n(329),g=n(13),y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),b=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};g.a.getSingleton().register("beforeColumnSort"),g.a.getSingleton().register("afterColumnSort");var w=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.sortIndicators=[],n.lastSortedColumn=null,n.sortEmptyCells=!1,n}return a(e,t),m(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSorting}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.setPluginOptions();var n=this;this.hot.sortIndex=[],this.hot.sort=function(){var t=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(n,o(t))},void 0===this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(e){return t.sort()}),this.addHook("afterUntrimRow",function(e){return t.sort()}),this.addHook("modifyRow",function(e){return t.translateRow(e)}),this.addHook("unmodifyRow",function(e){return t.untranslateRow(e)}),this.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(e,n){return t.getColHeader(e,n)}),this.addHook("afterOnCellMouseDown",function(e,n){return t.onAfterOnCellMouseDown(e,n)}),this.addHook("afterCreateRow",function(){n.afterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){n.afterRemoveRow.apply(n,arguments)}),this.addHook("afterInit",function(){return t.sortBySettings()}),this.addHook("afterLoadData",function(){t.hot.sortIndex=[],t.hot.view&&t.sortBySettings()}),this.hot.view&&this.sortBySettings(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.sort=void 0,b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"onAfterUpdateSettings",value:function(){this.sortBySettings()}},{key:"sortBySettings",value:function(){var t=this.hot.getSettings().columnSorting,e=this.loadSortingState(),n=void 0,o=void 0;void 0===e?(n=t.column,o=t.sortOrder):(n=e.sortColumn,o=e.sortOrder),"number"==typeof n&&(this.lastSortedColumn=n,this.sortByColumn(n,o))}},{key:"setSortingColumn",value:function(t,e){if(void 0===t)return this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0);this.hot.sortOrder=this.hot.sortColumn===t&&void 0===e?!1===this.hot.sortOrder?void 0:!this.hot.sortOrder:void 0===e||e,this.hot.sortColumn=t}},{key:"sortByColumn",value:function(t,e){this.setSortingColumn(t,e),void 0!==this.hot.sortColumn&&(!1!==this.hot.runHooks("beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder)&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),this.hot.runHooks("afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState())}},{key:"saveSortingState",value:function(){var t={};void 0!==this.hot.sortColumn&&(t.sortColumn=this.hot.sortColumn),void 0!==this.hot.sortOrder&&(t.sortOrder=this.hot.sortOrder),(Object(f.hasOwnProperty)(t,"sortColumn")||Object(f.hasOwnProperty)(t,"sortOrder"))&&this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"loadSortingState",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","columnSorting",t),t.value}},{key:"updateOrderClass",value:function(){var t=void 0;!0===this.hot.sortOrder?t="ascending":!1===this.hot.sortOrder&&(t="descending"),this.sortOrderClass=t}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.updateSettings({observeChanges:!0})},0))}},{key:"defaultSort",value:function(t,e){return function(n,o){return"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),n[1]===o[1]?0:Object(h.isEmpty)(n[1])?Object(h.isEmpty)(o[1])?0:e.columnSorting.sortEmptyCells&&t?-1:1:Object(h.isEmpty)(o[1])?Object(h.isEmpty)(n[1])?0:e.columnSorting.sortEmptyCells&&t?1:-1:isNaN(n[1])&&!isNaN(o[1])?t?1:-1:!isNaN(n[1])&&isNaN(o[1])?t?-1:1:(isNaN(n[1])||isNaN(o[1])||(n[1]=parseFloat(n[1]),o[1]=parseFloat(o[1])),n[1]<o[1]?t?-1:1:n[1]>o[1]?t?1:-1:0)}}},{key:"dateSort",value:function(t,e){return function(n,o){if(n[1]===o[1])return 0;if(Object(h.isEmpty)(n[1]))return Object(h.isEmpty)(o[1])?0:e.columnSorting.sortEmptyCells&&t?-1:1;if(Object(h.isEmpty)(o[1]))return Object(h.isEmpty)(n[1])?0:e.columnSorting.sortEmptyCells&&t?1:-1;var r=l()(n[1],e.dateFormat),i=l()(o[1],e.dateFormat);return r.isValid()?i.isValid()?i.isAfter(r)?t?-1:1:i.isBefore(r)?t?1:-1:0:-1:1}}},{key:"numericSort",value:function(t,e){return function(n,o){var r=parseFloat(n[1]),i=parseFloat(o[1]);if(r===i||isNaN(r)&&isNaN(i))return 0;if(e.columnSorting.sortEmptyCells){if(Object(h.isEmpty)(n[1]))return t?-1:1;if(Object(h.isEmpty)(o[1]))return t?1:-1}return isNaN(r)?1:isNaN(i)?-1:r<i?t?-1:1:r>i?t?1:-1:0}}},{key:"sort",value:function(){if(void 0===this.hot.sortOrder)return void(this.hot.sortIndex.length=0);var t=this.hot.getCellMeta(0,this.hot.sortColumn),e=this.hot.countEmptyRows(),n=void 0,o=void 0;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,void 0===t.columnSorting.sortEmptyCells&&(t.columnSorting={sortEmptyCells:this.sortEmptyCells}),o=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-e;for(var r=0,i=o;r<i;r++)this.hot.sortIndex.push([r,this.hot.getDataAtCell(r,this.hot.sortColumn)]);if(t.sortFunction)n=t.sortFunction;else switch(t.type){case"date":n=this.dateSort;break;case"numeric":n=this.numericSort;break;default:n=this.defaultSort}Object(v.a)(this.hot.sortIndex,n(this.hot.sortOrder,t));for(var a=this.hot.sortIndex.length;a<this.hot.countRows();a++)this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}},{key:"updateSortIndicator",value:function(){void 0!==this.hot.sortOrder&&(this.sortIndicators[this.hot.sortColumn]=this.hot.getCellMeta(0,this.hot.sortColumn).sortIndicator)}},{key:"translateRow",value:function(t){return this.hot.sortingEnabled&&void 0!==this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[t]?this.hot.sortIndex[t][0]:t}},{key:"untranslateRow",value:function(t){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var e=0;e<this.hot.sortIndex.length;e++)if(this.hot.sortIndex[e][0]==t)return e}},{key:"getColHeader",value:function(t,e){if(t<0||!e.parentNode)return!1;var n=e.querySelector(".colHeader"),o=(e.getAttribute("colspan"),e.parentNode.parentNode.childNodes),r=Array.prototype.indexOf.call(o,e.parentNode);r-=o.length,n&&(this.hot.getSettings().columnSorting&&t>=0&&-1===r&&Object(u.addClass)(n,"columnSorting"),Object(u.removeClass)(n,"descending"),Object(u.removeClass)(n,"ascending"),this.sortIndicators[t]&&t===this.hot.sortColumn&&("ascending"===this.sortOrderClass?Object(u.addClass)(n,"ascending"):"descending"===this.sortOrderClass&&Object(u.addClass)(n,"descending")))}},{key:"isSorted",value:function(){return void 0!==this.hot.sortColumn}},{key:"afterCreateRow",value:function(t,e){if(this.isSorted()){for(var n=0;n<this.hot.sortIndex.length;n++)this.hot.sortIndex[n][0]>=t&&(this.hot.sortIndex[n][0]+=e);for(var o=0;o<e;o++)this.hot.sortIndex.splice(t+o,0,[t+o,this.hot.getSourceData()[t+o][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}}},{key:"afterRemoveRow",value:function(t,e){function n(t){return Object(c.arrayReduce)(o,function(e,n){return t>n&&e++,e},0)}if(this.isSorted()){var o=this.hot.sortIndex.splice(t,e);o=Object(c.arrayMap)(o,function(t){return t[0]}),this.hot.sortIndex=Object(c.arrayMap)(this.hot.sortIndex,function(t,e){var o=n(t[0]);return o&&(t[0]-=o),t}),this.saveSortingState()}}},{key:"setPluginOptions",value:function(){var t=this.hot.getSettings().columnSorting;this.sortEmptyCells="object"===(void 0===t?"undefined":y(t))&&(t.sortEmptyCells||!1)}},{key:"onAfterOnCellMouseDown",value:function(t,e){e.row>-1||Object(u.hasClass)(t.realTarget,"columnSorting")&&(e.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=e.col,this.sortByColumn(e.col))}}]),e}(d.a);Object(p.d)("columnSorting",w),e.a=w},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(Math.abs(i-n)<=1)return[];var s=Math.ceil((n+i)/2);return o(t,e,n,s),o(t,e,s,i),r(t,e,n,s,i)}function r(t,e,n,o,r){for(var a=new i.a,s=new i.a,l=o-n,u=r-o,c=Math.max(l,u),h=r-n,f=0;f<c;f+=1)f<l&&a.push(t[n+f]),f<u&&s.push(t[o+f]);for(var d=0;d<h;)t[n+d]=a.first&&s.first?e(a.first.data,s.first.data)>0?s.shift().data:a.shift().data:a.first?a.shift().data:s.shift().data,d+=1;return t}e.a=o;var i=n(330),a=function(t,e){var n=t.toString(),o=e.toString();return n===o?0:n<o?-1:1}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function t(e){o(this,t),this.data=e,this.next=null,this.prev=null};e.a=function(){function t(){o(this,t),this.first=null,this.last=null}return r(t,[{key:"push",value:function(t){var e=new i(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.last;this.last=e,e.prev=n,n.next=e}}},{key:"unshift",value:function(t){var e=new i(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.first;this.first=e,e.next=n,n.prev=e}}},{key:"inorder",value:function(t){for(var e=this.first;e;)t(e),e=e.next}},{key:"remove",value:function(t){if(null===this.first)return!1;for(var e=this.first,n=void 0,o=void 0;e;){if(e.data===t)return n=e.next,o=e.prev,n&&(n.prev=o),o&&(o.next=n),e===this.first&&(this.first=n),e===this.last&&(this.last=o),!0;e=e.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,e=this.first;;){if(null===t)return!1;if(null===(t=t.next))return!1;if(t=t.next,e=e.next,t===e)return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(null===this.first)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){function t(e,n){n&&(t(n,n.next),n.next=e)}if(this.first){t(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var t=this.first.next,e=this.first,n=void 0;t;)n=t.next,t.next=e,e.prev=t,e=t,t=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=e,this.last=n}}}]),t}()},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(2),l=n(1),u=n(8),c=n(9),h=n(6),f=n(7),d=n(332),p=n(23),v=n(333),g=n(3),y=n(334),m=(n.n(y),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),b=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},w=new WeakMap,O=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,w.set(n,{tempEditorDimensions:{},cellBelowCursor:null}),n}return a(e,t),m(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new d.a),this.eventManager||(this.eventManager=new u.a(this)),this.displaySwitch||(this.displaySwitch=new v.a(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)}),this.addHook("afterRenderer",function(e,n,o,r,i,a){return t.onAfterRenderer(e,a)}),this.addHook("afterScrollHorizontally",function(){return t.hide()}),this.addHook("afterScrollVertically",function(){return t.hide()}),this.addHook("afterBeginEditing",function(e){return t.onAfterBeginEditing(e)}),this.displaySwitch.addLocalHook("hide",function(){return t.hide()}),this.displaySwitch.addLocalHook("show",function(e,n){return t.showAtCell(e,n)}),this.registerListeners(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this;this.eventManager.addEventListener(document,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(document,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(document,"mouseup",function(e){return t.onMouseUp(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(e){return t.onEditorBlur(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(e){return t.onEditorMouseDown(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(e){return t.onEditorMouseUp(e)})}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Object(s.closest)(t.target,"TD","TBODY");return!!(e&&Object(s.hasClass)(e,"htCommentCell")&&Object(s.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e),this.updateCommentMeta(this.range.from.row,this.range.from.col,o({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new c.a(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new c.a(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){return this.getCommentMeta(this.range.from.row,this.range.from.col,"value")}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,"value")}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t.comment?t.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new c.a(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var t=Object(s.getScrollableElement)(this.hot.view.wt.wtTable.TABLE),e=this.hot.view.wt.wtTable.getCell(this.range.from),n=this.range.from.row,o=this.range.from.col,r=Object(s.offset)(e),i=this.hot.view.wt.wtTable.getStretchedColumnWidth(o),a=r.top<0?0:r.top,l=r.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&t!==window&&(a-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&t!==window&&(l-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var u=l+i,c=a,h=this.getCommentMeta(n,o,"style"),f=this.getCommentMeta(n,o,"readOnly");h?this.editor.setSize(h.width,h.height):this.editor.resetSize(),this.editor.setReadOnlyState(f),this.editor.setPosition(u,c)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,"value")&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var o=this.hot.getCellMeta(t,e).comment,r=void 0;o?(r=Object(l.deepClone)(o),Object(l.deepExtend)(r,n)):r=n,this.hot.setCellMeta(t,e,"comment",r)}},{key:"getCommentMeta",value:function(t,e,n){var o=this.hot.getCellMeta(t,e);if(o.comment)return o.comment[n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=Object(s.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=w.get(this);if(e.cellBelowCursor=document.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||Object(s.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var n=this.hot.view.wt.wtTable.getCoords(t.target),o={from:new c.a(n.row,n.col)};this.displaySwitch.show(o)}else Object(s.isChildOf)(t.target,document)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(t){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e.comment&&e.comment.value&&Object(s.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(t){this.setComment()}},{key:"onEditorMouseDown",value:function(t){w.get(this).tempEditorDimensions={width:Object(s.outerWidth)(t.target),height:Object(s.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=w.get(this),n=Object(s.outerWidth)(t.target),r=Object(s.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,o({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout(function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){this.contextMenuEvent=!0;for(var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to,o=e.row;o<=n.row;o++)for(var r=e.col;r<=n.col;r++)this.removeCommentAtCell(o,r,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){this.contextMenuEvent=!0;for(var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to,r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++){var a=!!this.getCommentMeta(r,i,"readOnly");this.updateCommentMeta(r,i,o({},"readOnly",!a))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.hot.getTranslatedPhrase(e.checkSelectionCommentsConsistency()?g.CONTEXTMENU_ITEMS_EDIT_COMMENT:g.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return e.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return Object(p.b)(this.getSelectedRangeLast(),function(e,n){var o=t.getCellMeta(e,n).comment;if(o&&(o=o.readOnly),o)return!0})&&(e=Object(p.k)(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return e.hot.selection.selectedHeader.corner||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if(Object(l.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(t,e){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(f.a);Object(h.d)("comments",O),e.a=O},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){o(this,t),this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return i(t,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),i(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left=t+"px",this.editorStyle.top=e+"px"}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width=t+"px",n.style.height=e+"px"}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t||"",this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=document.querySelector("."+t.CLASS_EDITOR_CONTAINER),n=void 0,o=void 0;return e||(e=document.createElement("div"),Object(r.addClass)(e,t.CLASS_EDITOR_CONTAINER),document.body.appendChild(e)),n=document.createElement("div"),Object(r.addClass)(n,t.CLASS_EDITOR),o=document.createElement("textarea"),Object(r.addClass)(o,t.CLASS_INPUT),n.appendChild(o),e.appendChild(n),n}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+t.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(34),i=n(1),a=n(21),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(){function t(e){o(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return s(t,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")},250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Object(r.debounce)(function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)},e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();Object(i.mixin)(l,a.a),e.a=l},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(13),l=n(0),u=n(211),c=n(8),h=n(212),f=n(156),d=n(6),p=n(11),v=n(2),g=n(43),y=n(337),m=(n.n(y),function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}),b=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();s.a.getSingleton().register("afterContextMenuDefaultOptions"),s.a.getSingleton().register("afterContextMenuShow"),s.a.getSingleton().register("afterContextMenuHide"),s.a.getSingleton().register("afterContextMenuExecute");var w=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new c.a(n),n.commandExecutor=new u.a(n.hot),n.itemsFactory=null,n.menu=null,n}return i(e,t),b(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[g.j,g.k,g.l,g.c,g.d,g.l,g.i,g.h,g.l,g.m,g.g,g.l,g.f,g.l,g.a]}}]),b(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new h.a(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,o={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this);var r=function(){if(t.hot){t.hot.runHooks("afterContextMenuDefaultOptions",o),t.itemsFactory.setPredefinedItems(o.items);var e=t.itemsFactory.getItems(n);t.menu=new f.a(t.hot,{className:"htContextMenu",keepInViewport:!0}),t.hot.runHooks("beforeContextMenuSetItems",e),t.menu.setMenuItems(e),t.menu.addLocalHook("afterOpen",function(){return t.onMenuAfterOpen()}),t.menu.addLocalHook("afterClose",function(){return t.onMenuAfterClose()}),t.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.apply(t,n)}),Object(l.arrayEach)(e,function(e){return t.commandExecutor.registerCommand(e.key,e)})}};this.callOnPluginsReady(function(){t.isPluginsReady?setTimeout(r,0):r()})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(e){return t.onContextMenu(e)})}},{key:"open",value:function(t){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(Object(p.pageY)(t),10)-Object(v.getWindowScrollTop)(),left:parseInt(Object(p.pageX)(t),10)-Object(v.getWindowScrollLeft)()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,e)}},{key:"onContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,o=e.colHeaders,r=t.realTarget;this.close(),Object(v.hasClass)(r,"handsontableInput")||(t.preventDefault(),Object(p.stopPropagation)(t),(n||o||function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(r)||Object(v.hasClass)(r,"current")&&Object(v.hasClass)(r,"wtBorder"))&&this.open(t))}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);w.SEPARATOR={name:g.l},Object(d.d)("contextMenu",w),e.a=w},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(11),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t);var n=Object(r.getWindowScrollTop)(),a=Object(r.getWindowScrollLeft)(),s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,f=void 0;this.type=this.getSourceType(e),"literal"===this.type?(s=parseInt(e.top,10),u=parseInt(e.left,10),h=e.height||0,f=e.width||0,l=s,c=u,s+=n,u+=a):"event"===this.type&&(s=parseInt(Object(i.pageY)(e),10),u=parseInt(Object(i.pageX)(e),10),h=e.target.clientHeight,f=e.target.clientWidth,l=s-n,c=u-a),this.top=s,this.topRelative=l,this.left=u,this.leftRelative=c,this.scrollTop=n,this.scrollLeft=a,this.cellHeight=h,this.cellWidth=f}return a(t,[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){return this.topRelative+t.offsetHeight<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight)}},{key:"fitsOnRight",value:function(t){return this.leftRelative+this.cellWidth+t.offsetWidth<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth)}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),t}()},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(13),l=n(203),u=n.n(l),c=n(9),h=n(2),f=n(0),d=n(4),p=n(6),v=n(339),g=n(340),y=n(341),m=n(8),b=n(342),w=n(344),O=(n.n(w),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),C=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),E=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};s.a.getSingleton().register("afterCopyLimit"),s.a.getSingleton().register("modifyCopyableRange"),s.a.getSingleton().register("beforeCut"),s.a.getSingleton().register("afterCut"),s.a.getSingleton().register("beforePaste"),s.a.getSingleton().register("afterPaste"),s.a.getSingleton().register("beforeCopy"),s.a.getSingleton().register("afterCopy");var S=1e3,k=1e3,T=new WeakMap,R=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new m.a(n),n.columnsLimit=k,n.copyableRanges=[],n.pasteMode="overwrite",n.rowsLimit=S,n.textarea=void 0,T.set(n,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}return i(e,t),C(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings(),o=T.get(this);this.textarea=v.a.getSingleton(),o.isFragmentSelectionEnabled=n.fragmentSelection,"object"===O(n.copyPaste)&&(this.pasteMode=n.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=n.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=n.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterSelectionEnd",function(){return t.onAfterSelectionEnd()}),this.registerEvents(),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.textarea&&this.textarea.destroy(),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),o=e.row,r=e.col,i=n.row,a=n.col,s=Math.min(i,o+this.rowsLimit-1),l=Math.min(a,r+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:o,startCol:r,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===l||this.hot.runHooks("afterCopyLimit",i-o+1,a-r+1,this.rowsLimit,this.columnsLimit)}}},{key:"getRangedCopyableData",value:function(t){var e=this,n=[],o=[],r=[];return Object(f.arrayEach)(t,function(t){Object(d.rangeEach)(t.startRow,t.endRow,function(t){-1===o.indexOf(t)&&o.push(t)}),Object(d.rangeEach)(t.startCol,t.endCol,function(t){-1===r.indexOf(t)&&r.push(t)})}),Object(f.arrayEach)(o,function(t){var o=[];Object(f.arrayEach)(r,function(n){o.push(e.hot.getCopyableData(t,n))}),n.push(o)}),u.a.stringify(n)}},{key:"getRangedData",value:function(t){var e=this,n=[],o=[],r=[];return Object(f.arrayEach)(t,function(t){Object(d.rangeEach)(t.startRow,t.endRow,function(t){-1===o.indexOf(t)&&o.push(t)}),Object(d.rangeEach)(t.startCol,t.endCol,function(t){-1===r.indexOf(t)&&r.push(t)})}),Object(f.arrayEach)(o,function(t){var o=[];Object(f.arrayEach)(r,function(n){o.push(e.hot.getCopyableData(t,n))}),n.push(o)}),n}},{key:"copy",value:function(){T.get(this).isTriggeredByCopy=!0,this.textarea.select(),document.execCommand("copy")}},{key:"cut",value:function(){T.get(this).isTriggeredByCut=!0,this.textarea.select(),document.execCommand("cut")}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new b.a;e.clipboardData.setData("text/plain",t),this.onPaste(e)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.textarea.element,"paste",function(e){return t.onPaste(e)}),this.eventManager.addEventListener(this.textarea.element,"cut",function(e){return t.onCut(e)}),this.eventManager.addEventListener(this.textarea.element,"copy",function(e){return t.onCopy(e)})}},{key:"onCopy",value:function(t){var e=T.get(this);if(this.hot.isListening()||e.isTriggeredByCopy){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCopy",n,this.copyableRanges),r="";o&&(r=u.a.stringify(n),t&&t.clipboardData?t.clipboardData.setData("text/plain",r):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",r),this.hot.runHooks("afterCopy",n,this.copyableRanges)),t.preventDefault()}}},{key:"onCut",value:function(t){var e=T.get(this);if(this.hot.isListening()||e.isTriggeredByCut){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",n,this.copyableRanges),r=void 0;o&&(r=u.a.stringify(n),t&&t.clipboardData?t.clipboardData.setData("text/plain",r):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",r),this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",n,this.copyableRanges)),t.preventDefault()}}},{key:"onPaste",value:function(t){var e=this;if(this.hot.isListening()){t&&t.preventDefault&&t.preventDefault();var n=void 0;if(t&&void 0!==t.clipboardData?this.textarea.setValue(t.clipboardData.getData("text/plain")):"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&this.textarea.setValue(window.clipboardData.getData("Text")),n=u.a.parse(this.textarea.getValue()),this.textarea.setValue(" "),0!==n.length&&this.hot.runHooks("beforePaste",n,this.copyableRanges)){var o=this.hot.getSelectedLast(),r=new c.a(o[0],o[1]),i=new c.a(o[2],o[3]),a=new c.b(r,r,i),s=a.getTopLeftCorner(),l=a.getBottomRightCorner(),h=s,d=new c.a(Math.max(l.row,n.length-1+s.row),Math.max(l.col,n[0].length-1+s.col)),p=i.row-r.row>=n.length-1,v=i.col-r.col>=n[0].length-1;this.hot.addHookOnce("afterChange",function(t){var n=t?t.length:0;if(n){var o={row:0,col:0},r=-1;Object(f.arrayEach)(t,function(e,i){var a=n>i+1?t[i+1]:null;a&&(p||(o.row+=Math.max(a[0]-e[0]-1,0)),!v&&e[1]>r&&(r=e[1],o.col+=Math.max(a[1]-e[1]-1,0)))}),e.hot.selectCell(h.row,h.col,d.row+o.row,d.col+o.col)}}),this.hot.populateFromArray(h.row,h.col,n,d.row,d.col,"CopyPaste.paste",this.pasteMode),this.hot.runHooks("afterPaste",n,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},Object(g.a)(this),Object(y.a)(this))}},{key:"onAfterSelectionEnd",value:function(){var t=T.get(this),e=this.hot.getActiveEditor();e&&void 0!==e.isOpened&&e.isOpened()||t.isFragmentSelectionEnabled&&!this.textarea.isActive()&&Object(h.getSelectionText)()||(this.setCopyableText(),this.textarea.select())}},{key:"destroy",value:function(){this.textarea&&this.textarea.destroy(),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(p.d)("CopyPaste",R),e.a=R},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function(){function t(){o(this,t),this.element=void 0,this.isAppended=!1,this.refCounter=0}return r(t,null,[{key:"getSingleton",value:function(){return a.append(),a}}]),r(t,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea"),this.element.id="HandsontableCopyPaste",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus(),this.element.select()}},{key:"setValue",value:function(t){this.element.value=t}}]),t}(),a=new i;e.a=i},function(t,e,n){"use strict";function o(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}e.a=o;var r=n(3)},function(t,e,n){"use strict";function o(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}e.a=o;var r=n(3)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(343);e.a=function t(){o(this,t),this.clipboardData=new r.a}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){o(this,t),this.data={}}return r(t,[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),t}()},function(t,e){},function(t,e,n){"use strict";function o(){}var r,i=n(13),a=n(1),s=n(0),l=n(9),u=n(3),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t){return"boolean"==typeof t&&!0===t||"object"===(void 0===t?"undefined":c(t))&&t.length>0},f=function(){h(this.getSettings().customBorders)&&(this.customBorders||(r=this,this.customBorders=new o))},d=function(t){var e=-1;return Object(s.arrayEach)(r.selection.highlight.borders,function(n,o){if(n.settings.className==t)return e=o,!1}),e},p=function(t){var e={row:t.row,col:t.col},n=new l.c(t,new l.b(e,e,e)),o=d(t.className);o>=0?r.selection.highlight.borders[o]=n:r.selection.highlight.borders.push(n)},v=function(t,e,n){var o=O(t,e);o=C(o,n),this.setCellMeta(t,e,"borders",o),p(o)},g=function(t){for(var e=t.range,n=e.from.row;n<=e.to.row;n++)for(var o=e.from.col;o<=e.to.col;o++){var r=O(n,o),i=0;n==e.from.row&&(i++,Object(a.hasOwnProperty)(t,"top")&&(r.top=t.top)),n==e.to.row&&(i++,Object(a.hasOwnProperty)(t,"bottom")&&(r.bottom=t.bottom)),o==e.from.col&&(i++,Object(a.hasOwnProperty)(t,"left")&&(r.left=t.left)),o==e.to.col&&(i++,Object(a.hasOwnProperty)(t,"right")&&(r.right=t.right)),i>0&&(this.setCellMeta(n,o,"borders",r),p(r))}},y=function(t,e){return"border_row"+t+"col"+e},m=function(){return{width:1,color:"#000"}},b=function(){return{hide:!0}},w=function(){return{width:1,color:"#000",cornerVisible:!1}},O=function(t,e){return{className:y(t,e),border:w(),row:t,col:e,top:b(),right:b(),bottom:b(),left:b()}},C=function(t,e){return Object(a.hasOwnProperty)(e,"border")&&(t.border=e.border),Object(a.hasOwnProperty)(e,"top")&&(t.top=e.top),Object(a.hasOwnProperty)(e,"right")&&(t.right=e.right),Object(a.hasOwnProperty)(e,"bottom")&&(t.bottom=e.bottom),Object(a.hasOwnProperty)(e,"left")&&(t.left=e.left),t},E=function(t){for(var e=document.querySelectorAll("."+t),n=0;n<e.length;n++)if(e[n]&&"TD"!=e[n].nodeName){var o=e[n].parentNode;o.parentNode&&o.parentNode.removeChild(o)}},S=function(t,e){var n=y(t,e);E(n),this.removeCellMeta(t,e,"borders")},k=function(t,e,n,o){var r=this.getCellMeta(t,e).borders;r&&void 0!=r.border||(r=O(t,e)),r[n]=o?b():m(),this.setCellMeta(t,e,"borders",r);var i=y(t,e);E(i),p(r)},T=function(t,e,n){var o=this;Object(s.arrayEach)(t,function(t){var r=t.start,i=t.end;if(r.row==i.row&&r.col==i.col)"noBorders"==e?S.call(o,r.row,r.col):k.call(o,r.row,r.col,e,n);else switch(e){case"noBorders":for(var a=r.col;a<=i.col;a++)for(var s=r.row;s<=i.row;s++)S.call(o,s,a);break;case"top":for(var l=r.col;l<=i.col;l++)k.call(o,r.row,l,e,n);break;case"right":for(var u=r.row;u<=i.row;u++)k.call(o,u,i.col,e);break;case"bottom":for(var c=r.col;c<=i.col;c++)k.call(o,i.row,c,e);break;case"left":for(var h=r.row;h<=i.row;h++)k.call(o,h,r.col,e)}}),this.render()},R=function(t,e){var n=!1;return Object(s.arrayEach)(t.getSelectedRange(),function(o){o.forAll(function(o,r){var i=t.getCellMeta(o,r).borders;if(i){if(!e)return n=!0,!1;if(!Object(a.hasOwnProperty)(i[e],"hide"))return n=!0,!1}})}),n},_=function(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t},j=function(t){this.getSettings().customBorders&&(t.items.push({name:"---------"}),t.items.push({key:"borders",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_TOP);return R(this,"top")&&(t=_(t)),t},callback:function(t,e){var n=R(this,"top");T.call(this,e,"top",n)}},{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return R(this,"right")&&(t=_(t)),t},callback:function(t,e){var n=R(this,"right");T.call(this,e,"right",n)}},{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return R(this,"bottom")&&(t=_(t)),t},callback:function(t,e){var n=R(this,"bottom");T.call(this,e,"bottom",n)}},{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_LEFT);return R(this,"left")&&(t=_(t)),t},callback:function(t,e){var n=R(this,"left");T.call(this,e,"left",n)}},{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(t,e){T.call(this,e,"noBorders")},disabled:function(){return!R(this)}}]}}))};i.a.getSingleton().add("beforeInit",f),i.a.getSingleton().add("afterContextMenuDefaultOptions",j),i.a.getSingleton().add("afterInit",function(){var t=this.getSettings().customBorders;if(t){for(var e=0;e<t.length;e++)t[e].range?g.call(this,t[e]):v.call(this,t[e].row,t[e].col,t[e]);this.render(),this.view.wt.draw(!0)}}),e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(8),l=n(6),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},h=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new s.a(n),n.boundaries=null,n.callback=null,n.listening=!1,n}return i(e,t),u(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return t.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return t.setupListening()}),this.registerEvents(),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,o=0;e<this.boundaries.top?o=e-this.boundaries.top:e>this.boundaries.bottom&&(o=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,o)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(document,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var t=this.hot.view.wt.wtTable.holder;t!==window&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback(function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(t){this.listening&&this.check(t.clientX,t.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(l.d)("dragToScroll",h),e.a=h},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(6),l=n(0),u=n(348),c=n(349),h=n(350),f=(n.n(h),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),d=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},p=new WeakMap,v=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p.set(n,{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}return i(e,t),f(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(e){return t.addContextMenuEntry(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("beforeColumnMove",function(e,n){return t.onBeforeColumnMove(e,n)}),d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=p.get(this);t.afterFirstUse=!1,t.moveByFreeze=!1,d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=p.get(this),n=this.hot.getSettings();e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||t<=n.fixedColumnsLeft-1||(e.moveByFreeze=!0,t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t),this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft++))}},{key:"unfreezeColumn",value:function(t){var e=p.get(this),n=this.hot.getSettings();if(e.afterFirstUse||(e.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||t>n.fixedColumnsLeft-1)){var o=this.getBestColumnReturnPosition(t);e.moveByFreeze=!0,n.fixedColumnsLeft--,this.getMovePlugin().moveColumn(t,o+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(t){var e=this.getMovePlugin(),n=this.hot.getSettings(),o=n.fixedColumnsLeft,r=e.columnsMapper.getValueByIndex(o),i=void 0;if(null===this.frozenColumnsBasePositions[t]||void 0===this.frozenColumnsBasePositions[t])for(i=e.columnsMapper.getValueByIndex(t);null!==r&&r<=i;)o++,r=e.columnsMapper.getValueByIndex(o);else{for(i=this.frozenColumnsBasePositions[t],this.frozenColumnsBasePositions[t]=void 0;null!==r&&r<=i;)o++,r=e.columnsMapper.getValueByIndex(o);o=r}return o-1}},{key:"addContextMenuEntry",value:function(t){t.items.push({name:"---------"},Object(u.a)(this),Object(c.a)(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(t,e){var n=p.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var o=this.hot.getSettings().fixedColumnsLeft,r=e<o;if(r||Object(l.arrayEach)(t,function(t,e,n){if(t<o)return r=!0,!1}),r)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(s.d)("manualColumnFreeze",v),e.a=v},function(t,e,n){"use strict";function o(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(e,n){var o=i(n,1);t.freezeColumn(o[0].start.col),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(e=!0),e}}}e.a=o;var r=n(3),i=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){"use strict";function o(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(e,n){var o=i(n,1);t.unfreezeColumn(o[0].start.col),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft)&&(e=!0),e}}}e.a=o;var r=n(3),i=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(13),l=n(0),u=n(2),c=n(4),h=n(8),f=n(6),d=n(352),p=n(353),v=n(354),g=n(9),y=n(355),m=(n.n(y),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),b=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};s.a.getSingleton().register("beforeColumnMove"),s.a.getSingleton().register("afterColumnMove"),s.a.getSingleton().register("unmodifyCol");var w=new WeakMap,O=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return w.set(n,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new d.a(n),n.eventManager=new h.a(n),n.backlight=new p.a(t),n.guideline=new v.a(t),n}return i(e,t),m(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,o,r){return t.onBeforeOnCellMouseDown(e,n,o,r)}),this.addHook("beforeOnCellMouseOver",function(e,n,o,r){return t.onBeforeOnCellMouseOver(e,n,o,r)}),this.addHook("afterScrollVertically",function(){return t.onAfterScrollVertically()}),this.addHook("modifyCol",function(e,n){return t.onModifyCol(e,n)}),this.addHook("beforeRemoveCol",function(e,n){return t.onBeforeRemoveCol(e,n)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(e,n){return t.onAfterCreateCol(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("unmodifyCol",function(e){return t.onUnmodifyCol(e)}),this.registerEvents(),Object(u.addClass)(this.hot.rootElement,"ht__manualColumnMove"),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)&&this.columnsMapper.clearMap(),Object(u.removeClass)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=this,o=w.get(this),r=this.hot.runHooks("beforeColumnMove",t,e);o.disallowMoving=!r,!1!==r&&(Object(l.arrayEach)(t,function(t,e,o){o[e]=n.columnsMapper.getValueByIndex(t)}),Object(l.arrayEach)(t,function(t,o){var r=n.columnsMapper.getIndexByValue(t);r!==e&&n.columnsMapper.moveColumn(r,e+o)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",t,e)}},{key:"changeSelection",value:function(t,e){var n=this.hot.selection,o=this.hot.countRows()-1;n.setRangeStartOnly(new g.a(0,t)),n.setRangeEnd(new g.a(o,e),!1)}},{key:"getColumnsWidth",value:function(t,e){for(var n=0,o=t;o<e;o++){var r=0;r=o<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(o)||0,n+=r}return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)?this.moveColumns(t,0):void 0!==t&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value&&(this.columnsMapper._arrayMap=t.value)}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Object(c.rangeEach)(t,e,function(t){n.push(t)}),n}},{key:"refreshPositions",value:function(){var t=w.get(this),e=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),o=this.hot.view.wt.wtTable,r=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof r.scrollX?r.scrollX:r.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn),s=t.target.eventPageX-(t.rootElementOffset-(void 0===r.scrollX?i:0)),l=o.hider.offsetWidth,u=o.TBODY.offsetLeft,c=this.backlight.getOffset().left,h=this.backlight.getSize().width,f=0;if(t.rootElementOffset+o.holder.offsetWidth+i<t.target.eventPageX&&t.coordsColumn<t.countCols&&t.coordsColumn++,t.hasRowHeaders&&(f=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(t.coordsColumn)&&(a+=i),a+=f,t.coordsColumn<0)t.target.col=t.fixedColumns>0?0:e>0?e-1:e;else if(t.target.TD.offsetWidth/2+a<=s){var d=t.coordsColumn>=t.countCols?t.countCols-1:t.coordsColumn;t.target.col=d+1,a+=t.target.TD.offsetWidth,t.target.col>n&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else(t.target.col=t.coordsColumn)<=e&&t.target.col>=t.fixedColumns&&this.hot.scrollViewportTo(void 0,e-1);t.target.col<=e&&t.target.col>=t.fixedColumns&&this.hot.scrollViewportTo(void 0,e-1);var p=s,v=a;s+h+c>=l?p=l-h-c:s+c<u+f&&(p=u+f+Math.abs(c)),a>=l-1?v=l-1:0===v?v=1:void 0!==r.scrollX&&t.coordsColumn<t.fixedColumns&&(v-=t.rootElementOffset<=r.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,v)}},{key:"updateColumnsMapper",value:function(){var t=this.hot.countSourceCols(),e=this.columnsMapper._arrayMap.length;if(0===e)this.columnsMapper.createMap(t||this.hot.getSettings().startCols);else if(e<t){var n=t-e;this.columnsMapper.insertItems(e,n)}else if(e>t){var o=t-1,r=[];Object(l.arrayEach)(this.columnsMapper._arrayMap,function(t,e){t>o&&r.push(e)}),this.columnsMapper.removeItems(r)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,o){var r=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.cols,a=this.hot.getSelectedRangeLast(),s=w.get(this),l=t.realTarget.className.indexOf("columnSorting")>-1;if(!a||!i||s.pressed||0!==t.button||l)return s.pressed=!1,s.columnsToMove.length=0,void Object(u.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui"]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));var f=a.from,d=a.to,p=Math.min(f.col,d.col),v=Math.max(f.col,d.col);if(e.row<0&&e.col>=p&&e.col<=v){o.column=!0,s.pressed=!0,s.target.eventPageX=t.pageX,s.coordsColumn=e.col,s.target.TD=n,s.target.col=e.col,s.columnsToMove=this.prepareColumnsToMoving(p,v),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=Object(u.offset)(this.hot.rootElement).left;var g=s.hasRowHeaders?-1:0,y=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,m=e.col<s.fixedColumns,b=this.hot.view.wt.wtOverlays.scrollableElement,O=b.scrollX?b.scrollX-s.rootElementOffset:0,C=t.layerX-(m?O:0),E=Math.abs(this.getColumnsWidth(p,e.col)+C);this.backlight.setPosition(y,this.getColumnsWidth(g,p)+E),this.backlight.setSize(this.getColumnsWidth(p,v+1),r.hider.offsetHeight-y),this.backlight.setOffset(null,-1*E),Object(u.addClass)(this.hot.rootElement,"on-moving--columns")}else Object(u.removeClass)(this.hot.rootElement,"after-selection--columns"),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=w.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,o){var r=this.hot.getSelectedRangeLast(),i=w.get(this);r&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Object(u.removeClass)(this.hot.rootElement,"show-ui"):Object(u.addClass)(this.hot.rootElement,"show-ui"),o.row=!0,o.column=!0,o.cell=!0,i.coordsColumn=e.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=w.get(this);t.coordsColumn=void 0,t.pressed=!1,t.backlightWidth=0,Object(u.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.selectedHeader.cols&&Object(u.addClass)(this.hot.rootElement,"after-selection--columns"),t.columnsToMove.length<1||void 0===t.target.col||t.columnsToMove.indexOf(t.target.col)>-1||(this.moveColumns(t.columnsToMove,t.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.disallowMoving||this.changeSelection(this.columnsMapper.getIndexByValue(t.columnsToMove[0]),this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1])),t.columnsToMove.length=0)}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view.wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,o=e+n;this.backlight.setPosition(o),this.backlight.setSize(null,t.hider.offsetHeight-o)}},{key:"onAfterCreateCol",value:function(t,e){this.columnsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveCol",value:function(t,e){var n=this;this.removedColumns.length=0,!1!==t&&Object(c.rangeEach)(t,t+e-1,function(t){n.removedColumns.push(n.hot.runHooks("modifyCol",t,n.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(t,e){if(e!==this.pluginName){var n=this.columnsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyCol",value:function(t){var e=this.columnsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(f.d)("ManualColumnMove",O),e.a=O},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(54),i=n(0),a=n(1),s=n(4),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(){function t(e){o(this,t),this.manualColumnMove=e}return l(t,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(s.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(i.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),t}();Object(a.mixin)(u,r.a),e.a=u},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(225),s=n(2),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"build",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),Object(s.addClass)(this._element,"ht__manualColumnMove--backlight")}}]),e}(a.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(225),s=n(2),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"build",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),Object(s.addClass)(this._element,"ht__manualColumnMove--guideline")}}]),e}(a.a)},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(2),l=n(8),u=n(11),c=n(0),h=n(4),f=n(6),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},v=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new l.a(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],Object(s.addClass)(n.handle,"manualColumnResizer"),Object(s.addClass)(n.guide,"manualColumnResizerGuide"),n}return i(e,t),d(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualColumnWidths=[];var n=this.hot.getSettings().manualColumnResize,o=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.addHook("beforeStretchingColumnWidth",function(e,n){return t.onBeforeStretchingColumnWidth(e,n)}),this.addHook("beforeColumnResize",function(e,n,o){return t.onBeforeColumnResize(e,n,o)}),this.manualColumnWidths=void 0!==o?o:Array.isArray(n)?n:[],this.bindEvents(),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualColumnResize;Array.isArray(t)?this.manualColumnWidths=t:t||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;if(!t.parentNode)return!1;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).col,o=Object(s.outerHeight)(this.currentTH);if(n>=0){var r=this.currentTH.getBoundingClientRect();if(this.currentCol=n,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var i=this.hot.getSelectedRangeLast(),a=i.from,l=i.to,u=a.col,c=l.col;u>=c&&(u=l.col,c=a.col),this.currentCol>=u&&this.currentCol<=c?Object(h.rangeEach)(u,c,function(t){return e.selectedCols.push(t)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=r.left-6,this.startWidth=parseInt(r.width,10),this.handle.style.top=r.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=o+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(s.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(s.addClass)(this.handle,"active"),Object(s.addClass)(this.guide,"active"),this.guide.style.top=e+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Object(s.removeClass)(this.handle,"active"),Object(s.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){if(t!=this.hot.rootElement){var e=t.parentNode;return"THEAD"===e.tagName||this.checkIfColumnHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!=t.tagName?"TH"==t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfColumnHeader(t.target)){var e=this.getTHFromTargetElement(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&1!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,o){var r=t.hot.runHooks("beforeColumnResize",n,t.newSize,!0);void 0!==r&&(t.newSize=r),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),o&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedCols.length>1?(Object(c.arrayEach)(this.selectedCols,function(t){n(t)}),e()):Object(c.arrayEach)(this.selectedCols,function(t){n(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(s.hasClass)(t.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=Object(u.pageX)(t),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentWidth=this.startWidth+(Object(u.pageX)(t)-this.startX),Object(c.arrayEach)(this.selectedCols,function(t){e.newSize=e.setManualSize(t,e.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(t){var e=this,n=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},o=function(t,o){e.hot.runHooks("beforeColumnResize",t,e.newSize),o&&n(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",t,e.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(this.selectedCols.length>1?(Object(c.arrayEach)(this.selectedCols,function(t){o(t)}),n()):Object(c.arrayEach)(this.selectedCols,function(t){o(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(window,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(window,"mouseup",function(e){return t.onMouseUp(e)})}},{key:"setManualSize",value:function(t,e){return e=Math.max(e,20),t=this.hot.runHooks("modifyCol",t),this.manualColumnWidths[t]=e,e}},{key:"clearManualSize",value:function(t){t=this.hot.runHooks("modifyCol",t),this.manualColumnWidths[t]=void 0}},{key:"onModifyColWidth",value:function(t,e){return this.enabled&&(e=this.hot.runHooks("modifyCol",e),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[e])?this.manualColumnWidths[e]:t}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.manualColumnWidths[e];return void 0===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),e}(a.a);Object(f.d)("manualColumnResize",v),e.a=v},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(13),l=n(0),u=n(2),c=n(4),h=n(8),f=n(6),d=n(358),p=n(359),v=n(360),g=n(9),y=n(361),m=(n.n(y),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),b=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};s.a.getSingleton().register("beforeRowMove"),s.a.getSingleton().register("afterRowMove"),s.a.getSingleton().register("unmodifyRow");var w=new WeakMap,O=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return w.set(n,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new d.a(n),n.eventManager=new h.a(n),n.backlight=new p.a(t),n.guideline=new v.a(t),n}return i(e,t),m(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,o,r){return t.onBeforeOnCellMouseDown(e,n,o,r)}),this.addHook("beforeOnCellMouseOver",function(e,n,o,r){return t.onBeforeOnCellMouseOver(e,n,o,r)}),this.addHook("afterScrollHorizontally",function(){return t.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeColumnSort",function(e,n){return t.onBeforeColumnSort(e,n)}),this.addHook("unmodifyRow",function(e){return t.onUnmodifyRow(e)}),this.registerEvents(),Object(u.addClass)(this.hot.rootElement,"ht__manualRowMove"),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualRowMove;Array.isArray(t)&&this.rowsMapper.clearMap(),Object(u.removeClass)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=this,o=w.get(this);o.disallowMoving=!1===this.hot.runHooks("beforeRowMove",t,e),o.disallowMoving||(Object(l.arrayEach)(t,function(t,e,o){o[e]=n.rowsMapper.getValueByIndex(t)}),Object(l.arrayEach)(t,function(t,o){var r=n.rowsMapper.getIndexByValue(t);r!==e&&n.rowsMapper.moveRow(r,e+o)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",t,e)}},{key:"changeSelection",value:function(t,e){var n=this.hot.selection,o=this.hot.countCols()-1;n.setRangeStartOnly(new g.a(t,0)),n.setRangeEnd(new g.a(e,o),!1)}},{key:"getRowsHeight",value:function(t,e){for(var n=0,o=t;o<e;o++)n+=this.hot.view.wt.wtTable.getRowHeight(o)||23;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,o=t.to,r=Math.min(n.row,o.row),i=Math.max(n.row,o.row);return Object(c.rangeEach)(r,i,function(t){e.push(t)}),e}},{key:"refreshPositions",value:function(){var t=w.get(this),e=t.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),o=this.hot.view.wt.wtTable.getLastVisibleRow(),r=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();e.row<r&&n>0&&this.hot.scrollViewportTo(n-1),e.row>=o&&o<i&&this.hot.scrollViewportTo(o+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=t.target.TD,l=Object(u.offset)(this.hot.rootElement),c=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row),h=t.target.eventPageY-l.top+a.holder.scrollTop,f=a.hider.offsetHeight,d=a.TBODY.offsetTop,p=this.backlight.getOffset().top,v=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(c+=a.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:s.offsetHeight/2+c<=h?(t.target.row=e.row+1,c+=0===e.row?s.offsetHeight-1:s.offsetHeight):t.target.row=e.row;var g=h,y=c;h+v+p>=f?g=f-v-p:h+p<d&&(g=d+Math.abs(p)),c>=f-1&&(y=f-1);var m=0;this.hot.view.wt.wtOverlays.topOverlay&&(m=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),e.row>=r&&y-a.holder.scrollTop<m&&this.hot.scrollViewportTo(e.row),this.backlight.setPosition(g),this.guideline.setPosition(y)}},{key:"updateRowsMapper",value:function(){var t=this.hot.countSourceRows(),e=this.rowsMapper._arrayMap.length;if(0===e)this.rowsMapper.createMap(t||this.hot.getSettings().startRows);else if(e<t){var n=t-e;this.rowsMapper.insertItems(e,n)}else if(e>t){var o=t-1,r=[];Object(l.arrayEach)(this.rowsMapper._arrayMap,function(t,e){t>o&&r.push(e)}),this.rowsMapper.removeItems(r)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(t,e){w.get(this).disallowMoving=void 0!==e}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,o){var r=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.rows,a=this.hot.getSelectedRangeLast(),s=w.get(this);if(!a||!i||s.pressed||0!==t.button)return s.pressed=!1,s.rowsToMove.length=0,void Object(u.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui"]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&c&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));var h=a.from,f=a.to,d=Math.min(h.row,f.row),p=Math.max(h.row,f.row);if(e.col<0&&e.row>=d&&e.row<=p){o.row=!0,s.pressed=!0,s.target.eventPageY=t.pageY,s.target.coords=e,s.target.TD=n,s.rowsToMove=this.prepareRowsToMoving();var v=r.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(r.hider.offsetWidth-v,this.getRowsHeight(d,p+1)),this.backlight.setOffset(-1*(this.getRowsHeight(d,e.row)+t.layerY),null),Object(u.addClass)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}else Object(u.removeClass)(this.hot.rootElement,"after-selection--rows"),s.pressed=!1,s.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=w.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,o){var r=this.hot.getSelectedRangeLast(),i=w.get(this);r&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Object(u.removeClass)(this.hot.rootElement,"show-ui"):Object(u.addClass)(this.hot.rootElement,"show-ui"),o.row=!0,o.column=!0,o.cell=!0,i.target.coords=e,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=w.get(this),e=t.target.row,n=t.rowsToMove.length;t.pressed=!1,t.backlightHeight=0,Object(u.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.selectedHeader.rows&&Object(u.addClass)(this.hot.rootElement,"after-selection--rows"),n<1||void 0===e||t.rowsToMove.indexOf(e)>-1||t.rowsToMove[n-1]===e-1||(this.moveRows(t.rowsToMove,e),this.persistentStateSave(),this.hot.render(),t.disallowMoving||this.changeSelection(this.rowsMapper.getIndexByValue(t.rowsToMove[0]),this.rowsMapper.getIndexByValue(t.rowsToMove[n-1])),t.rowsToMove.length=0)}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,o=e+n;this.backlight.setPosition(null,o),this.backlight.setSize(t.hider.offsetWidth-o)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(c.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(t,e){if(e!==this.pluginName){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t){var e=this.rowsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),b(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(f.d)("ManualRowMove",O),e.a=O},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(54),i=n(0),a=n(1),s=n(4),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(){function t(e){o(this,t),this.manualRowMove=e}return l(t,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(s.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(i.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),t}();Object(a.mixin)(u,r.a),e.a=u},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(226),s=n(2),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"build",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),Object(s.addClass)(this._element,"ht__manualRowMove--backlight")}}]),e}(a.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(226),s=n(2),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"build",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),Object(s.addClass)(this._element,"ht__manualRowMove--guideline")}}]),e}(a.a)},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(2),l=n(8),u=n(11),c=n(0),h=n(4),f=n(6),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},v=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new l.a(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],Object(s.addClass)(n.handle,"manualRowResizer"),Object(s.addClass)(n.guide,"manualRowResizerGuide"),n}return i(e,t),d(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualRowHeights=[];var n=this.hot.getSettings().manualRowResize,o=this.loadManualRowHeights();this.manualRowHeights=void 0!==o?o:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(e,n){return t.onModifyRowHeight(e,n)}),this.bindEvents(),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualRowResize;Array.isArray(t)?this.manualRowHeights=t:t||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).row,o=Object(s.outerWidth)(this.currentTH);if(n>=0){var r=this.currentTH.getBoundingClientRect();if(this.currentRow=n,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var i=this.hot.getSelectedRangeLast(),a=i.from,l=i.to,u=a.row,c=l.row;u>=c&&(u=l.row,c=a.row),this.currentRow>=u&&this.currentRow<=c?Object(h.rangeEach)(u,c,function(t){return e.selectedRows.push(t)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=r.top-6,this.startHeight=parseInt(r.height,10),this.handle.style.left=r.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=o+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(s.outerWidth)(this.handle),10),e=parseInt(this.handle.style.left,10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(s.addClass)(this.handle,"active"),Object(s.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=e+"px",this.guide.style.width=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Object(s.removeClass)(this.handle,"active"),Object(s.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){if(t!=this.hot.rootElement){var e=t.parentNode;return"TBODY"===e.tagName||this.checkIfRowHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!=t.tagName?"TH"==t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfRowHeader(t.target)){var e=this.getTHFromTargetElement(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,o){var r=t.hot.runHooks("beforeRowResize",n,t.newSize,!0);void 0!==r&&(t.newSize=r),t.setManualSize(n,t.newSize),o&&e(),t.hot.runHooks("afterRowResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedRows.length>1?(Object(c.arrayEach)(this.selectedRows,function(t){n(t)}),e()):Object(c.arrayEach)(this.selectedRows,function(t){n(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(s.hasClass)(t.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=Object(u.pageY)(t),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(Object(u.pageY)(t)-this.startY),Object(c.arrayEach)(this.selectedRows,function(t){e.newSize=e.setManualSize(t,e.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(t){var e=this,n=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},o=function(t,o){e.hot.runHooks("beforeRowResize",t,e.newSize),o&&n(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",t,e.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(this.selectedRows.length>1?(Object(c.arrayEach)(this.selectedRows,function(t){o(t)}),n()):Object(c.arrayEach)(this.selectedRows,function(t){o(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(window,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(window,"mouseup",function(e){return t.onMouseUp(e)})}},{key:"setManualSize",value:function(t,e){return t=this.hot.runHooks("modifyRow",t),this.manualRowHeights[t]=e,e}},{key:"onModifyRowHeight",value:function(t,e){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),o=n?n.heights[e]:null;e=this.hot.runHooks("modifyRow",e);var r=this.manualRowHeights[e];if(void 0!==r&&(r===o||r>(t||0)))return r}return t}}]),e}(a.a);Object(f.d)("manualRowResize",v),e.a=v},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(7),l=n(13),u=n(6),c=n(11),h=n(9),f=n(364),d=n(366),p=n(367),v=n(368),g=n(0),y=n(1),m=n(4),b=n(227),w=n(369),O=(n.n(w),function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),C=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),E=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};l.a.getSingleton().register("beforeMergeCells"),l.a.getSingleton().register("afterMergeCells"),l.a.getSingleton().register("beforeUnmergeCells"),l.a.getSingleton().register("afterUnmergeCells");var S=new WeakMap,k=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return S.set(n,{lastDesiredCoords:null}),n.mergedCellsCollection=null,n.autofillCalculations=null,n.selectionCalculations=null,n}return a(e,t),C(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new f.a(this),this.autofillCalculations=new d.a(this),this.selectionCalculations=new p.a,this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown.apply(t,arguments)}),this.addHook("modifyTransformStart",function(){return t.onModifyTransformStart.apply(t,arguments)}),this.addHook("modifyTransformEnd",function(){return t.onModifyTransformEnd.apply(t,arguments)}),this.addHook("modifyGetCellCoords",function(){return t.onModifyGetCellCoords.apply(t,arguments)}),this.addHook("beforeSetRangeEnd",function(){return t.onBeforeSetRangeEnd.apply(t,arguments)}),this.addHook("afterIsMultipleSelection",function(){return t.onAfterIsMultipleSelection.apply(t,arguments)}),this.addHook("afterRenderer",function(){return t.onAfterRenderer.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.addMergeActionsToContextMenu.apply(t,arguments)}),this.addHook("afterGetCellMeta",function(){return t.onAfterGetCellMeta.apply(t,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)}),this.addHook("modifyAutofillRange",function(){return t.onModifyAutofillRange.apply(t,arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)}),this.addHook("beforeDrawBorders",function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)}),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().mergeCells;this.clearCollections(),this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n,r=[];Object(g.arrayEach)(t,function(t){var n=new h.a(t.row,t.col),o=new h.a(t.row+t.rowspan-1,t.col+t.colspan-1),i=new h.b(n,n,o);r.push(e.mergeRange(i,!0,!0))}),r=r.filter(function(t){return!0!==t});var i=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,o(i))}}},{key:"getBulkCollectionData",value:function(t){var e,n=this.getBulkCollectionDataRange(t),r=(e=this.hot).getData.apply(e,o(n)),i=r.splice(0);return Object(g.arrayEach)(t,function(t){var e=O(t,3),o=e[0],r=e[1],a=e[2];Object(g.arrayEach)(a,function(t,e){Object(g.arrayEach)(t,function(t,a){i[o-n[0]+e][r-n[1]+a]=t})})}),[n[0],n[1],i]}},{key:"getBulkCollectionDataRange",value:function(t){var e=[0,0],n=[0,0],o=null,r=null,i=null;return Object(g.arrayEach)(t,function(t){o=t[0],r=t[1],i=t[2],e[0]=Math.min(o,e[0]),e[1]=Math.min(r,e[1]),n[0]=Math.max(o+i.length-1,n[0]),n[1]=Math.max(r+i[0].length-1,n[1])}),[].concat(e,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){return!t.isSingle()}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.canMergeRange(t))return!1;var r=t.getTopLeftCorner(),i=t.getBottomRightCorner(),a={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},s=[],l=null;return this.hot.runHooks("beforeMergeCells",t,n),Object(m.rangeEach)(0,a.rowspan-1,function(t){Object(m.rangeEach)(0,a.colspan-1,function(n){var o=null;s[t]||(s[t]=[]),0===t&&0===n?o=e.hot.getDataAtCell(a.row,a.col):e.hot.setCellMeta(a.row+t,a.col+n,"hidden",!0),s[t][n]=o})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),!this.mergedCellsCollection.add(a)||(o?l=[a.row,a.col,s]:this.hot.populateFromArray(a.row,a.col,s,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",t,a,n),l)}},{key:"mergeSelection",value:function(t){t||(t=this.hot.getSelectedRangeLast()),this.unmergeRange(t,!0),this.mergeRange(t)}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.hot.runHooks("beforeUnmergeCells",t,n);var o=this.mergedCellsCollection.getWithinRange(t);Object(g.arrayEach)(o,function(t){e.mergedCellsCollection.remove(t.row,t.col),Object(m.rangeEach)(0,t.rowspan-1,function(n){Object(m.rangeEach)(0,t.colspan-1,function(o){e.hot.removeCellMeta(t.row+n,t.col+o,"hidden")})}),e.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",t,n)}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,o){var r=new h.a(t,e),i=new h.a(n,o);this.mergeRange(new h.b(r,r,i))}},{key:"unmerge",value:function(t,e,n,o){var r=new h.a(t,e),i=new h.a(n,o);this.unmergeRange(new h.b(r,r,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&77===t.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(c.stopImmediatePropagation)(t))}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),o=0;o<e.length;o+=1)if(n.highlight.row===e[o].row&&n.highlight.col===e[o].col&&n.to.row===e[o].row+e[o].rowspan-1&&n.to.col===e[o].col+e[o].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e=S.get(this),n=this.hot.getSelectedRangeLast(),o={row:t.row,col:t.col},r=null,i=new h.a(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(e.lastDesiredCoords||(e.lastDesiredCoords=new h.a(null,null)),a){var s=new h.a(a.row,a.col),l=new h.a(a.row+a.rowspan-1,a.col+a.colspan-1);new h.b(s,s,l).includes(e.lastDesiredCoords)||(e.lastDesiredCoords=new h.a(null,null)),o.row=e.lastDesiredCoords.row?e.lastDesiredCoords.row-i.row:o.row,o.col=e.lastDesiredCoords.col?e.lastDesiredCoords.col-i.col:o.col,t.row>0?o.row=a.row+a.rowspan-1-i.row+t.row:t.row<0&&(o.row=i.row-a.row+t.row),t.col>0?o.col=a.col+a.colspan-1-i.col+t.col:t.col<0&&(o.col=i.col-a.col+t.col)}r=new h.a(n.highlight.row+o.row,n.highlight.col+o.col);var u=this.mergedCellsCollection.get(r.row,r.col);u&&(e.lastDesiredCoords=r,o={row:u.row-i.row,col:u.col-i.col}),0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),o=Object(y.clone)(t),r=this.selectionCalculations.getUpdatedSelectionRange(n,t),i=Object(y.clone)(o),a=this.mergedCellsCollection.getWithinRange(r,!0);do{i=Object(y.clone)(o),this.selectionCalculations.getUpdatedSelectionRange(n,o),Object(g.arrayEach)(a,function(t){e.selectionCalculations.snapDelta(o,n,t)})}while(o.row!==i.row||o.col!==i.col);t.row=o.row,t.col=o.col}},{key:"onModifyGetCellCoords",value:function(t,e){var n=this.mergedCellsCollection.get(t,e);return n?[n.row,n.col]:void 0}},{key:"addMergeActionsToContextMenu",value:function(t){t.items.push({name:"---------"},Object(v.a)(this))}},{key:"onAfterRenderer",value:function(t,e,n){var o=this.mergedCellsCollection.get(e,n);Object(b.a)(t,o,e,n)}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=new h.a(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!(0===e.from.row&&e.to.row===this.hot.countRows()-1||0===e.from.col&&e.to.col===this.hot.countCols()-1))do{n=!1;for(var o=0;o<this.mergedCellsCollection.mergedCells.length;o++){var r=this.mergedCellsCollection.mergedCells[o],i=r.getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var o=this.mergedCellsCollection.get(t,e);!o||o.row===t&&o.col===e||(n.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e=this,n=this.hot.countCols(),o=void 0;Object(m.rangeEach)(0,n-1,function(n){if((o=e.mergedCellsCollection.get(t.startRow,n))&&o.row<t.startRow)return t.startRow=o.row,e.onAfterViewportRowCalculatorOverride.call(e,t);if(o=e.mergedCellsCollection.get(t.endRow,n)){var r=o.row+o.rowspan-1;if(r>t.endRow)return t.endRow=r,e.onAfterViewportRowCalculatorOverride.call(e,t)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this,n=this.hot.countRows(),o=void 0;Object(m.rangeEach)(0,n-1,function(n){if((o=e.mergedCellsCollection.get(n,t.startColumn))&&o.col<t.startColumn)return t.startColumn=o.col,e.onAfterViewportColumnCalculatorOverride.call(e,t);if(o=e.mergedCellsCollection.get(n,t.endColumn)){var r=o.col+o.colspan-1;if(r>t.endColumn)return t.endColumn=r,e.onAfterViewportColumnCalculatorOverride.call(e,t)}return!0})}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return t=e;var o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?t=this.autofillCalculations.snapDragArea(e,t,n,o):t}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(n);Object(g.arrayEach)(o,function(e){n.getBottomRightCorner().row===e.getLastRow()&&n.getBottomRightCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)})}}}]),e}(s.a);Object(u.d)("mergeCells",k),e.a=k},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(365),a=n(9),s=n(4),l=n(0),u=n(227),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){r(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return c(t,[{key:"get",value:function(t,e){var n=this.mergedCells,o=!1;return Object(l.arrayEach)(n,function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e&&(o=n,1))}),o}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return Object(l.arrayEach)(e,function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e)}),n}},{key:"getWithinRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,o=[];if(!t.includesRange){var r=new a.a(t.from.row,t.from.col),i=new a.a(t.to.row,t.to.col);t=new a.b(r,r,i)}return Object(l.arrayEach)(n,function(n){var r=new a.a(n.row,n.col),i=new a.a(n.row+n.rowspan-1,n.col+n.colspan-1),s=new a.b(r,r,i);e?t.overlaps(s)&&o.push(n):t.includesRange(s)&&o.push(n)}),!!o.length&&o}},{key:"add",value:function(t){var e=this.mergedCells,n=t.row,o=t.col,r=t.rowspan,a=t.colspan,s=new i.a(n,o,r,a);return this.get(n,o)||this.isOverlapping(s)?(console.warn("The declared merged cell at ["+s.row+", "+s.col+"] overlaps with the other declared merged cell. \n    The overlapping merged cell was not added to the table, please fix your setup."),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}},{key:"remove",value:function(t,e){var n=this.mergedCells,o=this.get(t,e),r=o?this.mergedCells.indexOf(o):null;return!(!o||!1===r)&&(n.splice(r,1),o)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];Object(l.arrayEach)(e,function(e){n.push([t.hot.getCell(e.row,e.col),t.get(e.row,e.col),e.row,e.col])}),this.mergedCells.length=0,Object(l.arrayEach)(n,function(e,o){Object(s.rangeEach)(0,e.rowspan-1,function(n){Object(s.rangeEach)(0,e.colspan-1,function(o){0===o&&0===n||r.push([t.hot.getCell(e.row+n,e.col+o),null,null,null])})}),n[o][1]=null}),Object(l.arrayEach)(n,function(t){u.a.apply(void 0,o(t))}),Object(l.arrayEach)(r,function(t){u.a.apply(void 0,o(t))})}},{key:"isOverlapping",value:function(t){var e=new a.b(null,new a.a(t.row,t.col),new a.a(t.row+t.rowspan-1,t.col+t.colspan-1)),n=!1;return Object(l.arrayEach)(this.mergedCells,function(t){return!new a.b(null,new a.a(t.row,t.col),new a.a(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(n=!0,!1)}),n}},{key:"isMergedParent",value:function(t,e){var n=this.mergedCells,o=!1;return Object(l.arrayEach)(n,function(n){return n.row!==t||n.col!==e||(o=!0,!1)}),o}},{key:"shiftCollections",value:function(t,e,n){var o=this,r=[0,0];switch(t){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}Object(l.arrayEach)(this.mergedCells,function(t){t.shift(r,e)}),Object(l.arrayEach)(this.mergedCells,function(t){t.removed&&o.mergedCells.splice(o.mergedCells.indexOf(t),1)})}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(9),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n,r,i){o(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.removed=!1}return i(t,[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],o=e+Math.abs(t[0]||t[1])-1,r=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",a=Math.min(e,o),s=Math.max(e,o),l=this[i],u=this[i]+this[r]-1;if(l>=e&&(this[i]+=n),n>0)e<=u&&e>l&&(this[r]+=n);else if(n<0){if(a<=l&&s>=u)return this.removed=!0,!1;if(l>=a&&l<=s){var c=s-l+1,h=Math.abs(n)-c;this[i]-=h,this[r]-=c}else if(l<=a&&u>=s)this[r]+=n;else if(l<=a&&u>=a&&u<s){var f=u-a+1;this[r]-=f}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new r.b(new r.a(this.row,this.col),new r.a(this.row,this.col),new r.a(this.getLastRow(),this.getLastColumn()))}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(9),a=n(0),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return l(t,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}},{key:"snapDragArea",value:function(t,e,n,o){var r=e.slice(0),i=this.getAutofillSize(t,e,n),a=s(t,4),l=a[0],u=a[1],c=a[2],h=a[3],f=["up","down"].indexOf(n)>-1,d=f?c-l+1:h-u+1,p=Math.floor(i/d)*d,v=i-p,g=this.getFarthestCollection(t,e,n,o);if(g)if("down"===n){var y=g.row+g.rowspan-l-v,m=r[2]+y;m>=this.plugin.hot.countRows()?r[2]-=v:r[2]+=v?y:0}else if("right"===n){var b=g.col+g.colspan-u-v,w=r[3]+b;w>=this.plugin.hot.countCols()?r[3]-=v:r[3]+=v?b:0}else if("up"===n){var O=c-v-g.row+1,C=r[0]+O;C<0?r[0]+=v:r[0]-=v?O:0}else if("left"===n){var E=h-v-g.col+1,S=r[1]+E;S<0?r[1]+=v:r[1]-=v?E:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:o,fillSize:i,dragArea:r,cycleLength:d}),r}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),Object(r.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var o=s(t,4),r=o[0],i=o[1],a=o[2],l=o[3],u=s(e,4),c=u[0],h=u[1],f=u[2],d=u[3];switch(n){case"up":return r-c;case"down":return f-a;case"left":return i-h;case"right":return d-l;default:return null}}},{key:"getDragArea",value:function(t,e,n){var o=s(t,4),r=o[0],i=o[1],a=o[2],l=o[3],u=s(e,4),c=u[0],h=u[1],f=u[2],d=u[3];switch(n){case"up":return[c,h,r-1,l];case"down":return[a+1,i,f,l];case"left":return[c,h,a,i-1];case"right":return[r,l+1,f,d];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,o){var r=s(t,4),i=r[0],l=r[1],u=r[2],c=r[3],h=["up","down"].indexOf(n)>-1,f=h?u:c,d=h?i:l,p=this.getAutofillSize(t,e,n),v=h?u-i+1:c-l+1,g=Math.floor(p/v)*v,y=p-g,m=null,b=null,w=null;switch(n){case"up":m="includesVertically",w=f-y+1;break;case"left":m="includesHorizontally",w=f-y+1;break;case"down":m="includesVertically",w=d+y-1;break;case"right":m="includesHorizontally",w=d+y-1}return Object(a.arrayEach)(o,function(t){t[m](w)&&t.isFarther(b,n)&&(b=t)}),b}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,r=function(t,n){switch(o){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},i=0,a=null,s=1;do{for(var l=0;l<n.length;l++){if(a=n[l],i=s*this.currentFillData.cycleLength,r(a,i))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}l===n.length-1&&(s+=1)}}while(r(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(t){var e={min:null,max:null},n={min:null,max:null};return Object(a.arrayEach)(t,function(t){(null===e.min||t[0]<e.min)&&(e.min=t[0]),(null===e.max||t[0]>e.max)&&(e.max=t[0]),(null===n.min||t[1]<n.min)&&(n.min=t[1]),(null===n.max||t[1]>n.max)&&(n.max=t[1])}),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var o=this.getDragArea(t,e,n),r=s(o,4),a=r[0],l=r[1],u=r[2],c=r[3],h=new i.a(a,l),f=new i.a(u,c);return!!this.mergedCellsCollection.getWithinRange(new i.b(h,h,f),!0)}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(9),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){o(this,t)}return i(t,[{key:"snapDelta",value:function(t,e,n){var o=e.to,r=o.row+t.row,i=o.col+t.col;t.row?this.jumpOverMergedCell(t,n,r):t.col&&this.jumpOverMergedCell(t,n,i)}},{key:"jumpOverMergedCell",value:function(t,e,n){var o=t.row||t.col,r=null,i=null,a=null;t.row?(r=e.includesVertically(n),i=e.row,a=e.getLastRow()):t.col&&(r=e.includesHorizontally(n),i=e.col,a=e.getLastColumn()),0!==o&&(o>0?r&&n!==i&&(o+=a-n+1):r&&n!==a&&(o-=n-i+1),t.row?t.row=o:t.col&&(t.col=o))}},{key:"getUpdatedSelectionRange",value:function(t,e){return new r.b(t.highlight,t.from,new r.a(t.to.row+e.row,t.to.col+e.col))}}]),t}()},function(t,e,n){"use strict";function o(t){return{key:"mergeCells",name:function(){var e=this.getSelectedLast(),n=t.mergedCellsCollection.get(e[0],e[1]);return this.getTranslatedPhrase(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3]?r.CONTEXTMENU_ITEMS_UNMERGE_CELLS:r.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){t.toggleMerge(this.getSelectedRangeLast()),this.render()},disabled:function(){return this.selection.selectedHeader.corner},hidden:!1}}e.a=o;var r=n(3)},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=(n(13),n(2)),s=n(33),l=n(7),u=n(8),c=n(6),h=n(9),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),d=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},p=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.dragged=[],n.eventManager=null,n.lastSetCell=null,n}return i(e,t),f(e,[{key:"isEnabled",value:function(){return Object(s.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new u.a(this)),this.registerListeners(),d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){function t(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1==n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1==n&&(e.dragged=e.dragged.slice(-1))}var e=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var n=void 0;return Object(a.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("topLeft"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Object(a.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottomRight"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(n){return Object(a.hasClass)(n.target,"topLeftSelectionHandle-HitArea")?(t.call(e,"topLeft"),e.touchStartRange=void 0,n.preventDefault(),!1):Object(a.hasClass)(n.target,"bottomRightSelectionHandle-HitArea")?(t.call(e,"bottomRight"),e.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var n=Object(a.getWindowScrollTop)(),o=Object(a.getWindowScrollLeft)(),r=void 0,i=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0;0!==e.dragged.length&&(r=document.elementFromPoint(t.touches[0].screenX-o,t.touches[0].screenY-n))&&r!==e.lastSetCell&&("TD"!=r.nodeName&&"TH"!=r.nodeName||(i=e.hot.getCoords(r),-1==i.col&&(i.col=0),s=e.hot.getSelectedRangeLast(),l=s.getWidth(),u=s.getHeight(),c=s.getDirection(),1==l&&1==u&&e.hot.selection.setRangeEnd(i),h=e.getCurrentRangeCoords(s,i,e.touchStartRange.direction,c,e.dragged[0]),null!==h.start&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=r),t.preventDefault())})}},{key:"getCurrentRangeCoords",value:function(t,e,n,o,r){var i=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=t.getBottomLeftCorner(),l=t.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":u="topLeft"==r?{start:new h.a(e.row,t.highlight.col),end:new h.a(s.row,e.col)}:{start:new h.a(t.highlight.row,e.col),end:new h.a(e.row,i.col)};break;case"SE-NW":"bottomRight"==r&&(u={start:new h.a(a.row,e.col),end:new h.a(e.row,i.col)})}break;case"NW-SE":switch(o){case"NE-SW":"topLeft"==r?u={start:e,end:s}:u.end=e;break;case"NW-SE":"topLeft"==r?u={start:e,end:a}:u.end=e;break;case"SE-NW":"topLeft"==r?u={start:e,end:i}:u.end=e;break;case"SW-NE":"topLeft"==r?u={start:e,end:l}:u.end=e}break;case"SW-NE":switch(o){case"NW-SE":u="bottomRight"==r?{start:new h.a(e.row,i.col),end:new h.a(s.row,e.col)}:{start:new h.a(i.row,e.col),end:new h.a(e.row,a.col)};break;case"SW-NE":u="topLeft"==r?{start:new h.a(t.highlight.row,e.col),end:new h.a(e.row,a.col)}:{start:new h.a(e.row,i.col),end:new h.a(i.row,e.col)};break;case"SE-NW":"bottomRight"==r?u={start:new h.a(e.row,l.col),end:new h.a(i.row,e.col)}:"topLeft"==r&&(u={start:s,end:e})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==r&&(u.end=e);break;case"SE-NW":"topLeft"==r?u.end=e:u={start:e,end:i}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),e}(l.a);Object(c.d)("multipleSelectionHandles",p),e.a=p},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(228),l=(n.n(s),n(372)),u=n(0),c=n(6),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},d=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.observer=null,n}return i(e,t),h(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.observer||(this.observer=new l.a(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(e){return t.onDataChange(e)}),this.addHook("afterCreateRow",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return t.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return t.onAfterTableAlter()}),this.addHook("afterChange",function(e,n){return t.onAfterTableAlter(n)}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(t){var e=this;if(!this.observer.isPaused()){var n=this.pluginName+".change",o={add:function(t){isNaN(t.col)?e.hot.runHooks("afterCreateRow",t.row,1,n):e.hot.runHooks("afterCreateCol",t.col,1,n)},remove:function(t){isNaN(t.col)?e.hot.runHooks("afterRemoveRow",t.row,1,n):e.hot.runHooks("afterRemoveCol",t.col,1,n)},replace:function(t){e.hot.runHooks("afterChange",[[t.row,t.col,null,t.value]],n)}};Object(u.arrayEach)(t,function(t){o[t.op]&&o[t.op](t)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(t){var e=this;"loadData"!==t&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return e.observer.resume()}))}},{key:"onAfterLoadData",value:function(t){t||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var t=this,e=this.hot;e.pauseObservingChanges=function(){return t.observer.pause()},e.resumeObservingChanges=function(){return t.observer.resume()},e.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var t=this.hot;delete t.pauseObservingChanges,delete t.resumeObservingChanges,delete t.isPausedObservingChanges}}]),e}(a.a);e.a=d,Object(c.d)("observeChanges",d)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(228),i=n.n(r),a=n(21),s=n(1),l=n(373),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=function(){function t(e){o(this,t),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(e)}return u(t,[{key:"setObservedData",value:function(t){var e=this;this.observer&&i.a.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=i.a.observe(this.observedData,function(t){return e.onChange(t)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",Object(l.a)(t))}},{key:"destroy",value:function(){i.a.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),t}();Object(s.mixin)(c,a.a),e.a=c},function(t,e,n){"use strict";function o(t){var e=[];return t=Object(i.arrayFilter)(t,function(t){return!/[\/]length/gi.test(t.path)&&!!r(t.path)}),t=Object(i.arrayMap)(t,function(t){var e=r(t.path);return t.row=e.row,t.col=e.col,t}),t=Object(i.arrayFilter)(t,function(t){if(-1!==["add","remove"].indexOf(t.op)&&!isNaN(t.col)){if(-1!==e.indexOf(t.col))return!1;e.push(t.col)}return!0}),e.length=0,t}function r(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var n=a(e,3),o=n[1],r=n[2];return{row:parseInt(o,10),col:/^\d*$/.test(r)?parseInt(r,10):r}}e.a=o;var i=n(0),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){"use strict";function o(t){this.query=function(e,n,r){var i=t.countRows(),a=t.countCols(),s=[];n||(n=o.global.getDefaultCallback()),r||(r=o.global.getDefaultQueryMethod());for(var l=0;l<i;l++)for(var u=0;u<a;u++){var c=t.getDataAtCell(l,u),h=t.getCellMeta(l,u),f=h.search.callback||n,d=h.search.queryMethod||r,p=d(e,c);if(p){var v={row:l,col:u,data:c};s.push(v)}f&&f(t,l,u,c,p)}return s}}function r(t,e,n,r,i,a,l){var c=null!==l.search&&"object"==u(l.search)&&l.search.searchResultClass||o.global.getDefaultSearchResultClass();l.isSearchResult?Object(s.addClass)(e,c):Object(s.removeClass)(e,c)}function i(){var t=this;t.getSettings().search?t.search=new o(t):delete t.search}var a=n(13),s=n(2),l=n(15),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};o.DEFAULT_CALLBACK=function(t,e,n,o,r){t.getCellMeta(e,n).isSearchResult=r},o.DEFAULT_QUERY_METHOD=function(t,e){return!(void 0===t||null==t||!t.toLowerCase||0===t.length)&&void 0!==e&&null!=e&&-1!=e.toString().toLowerCase().indexOf(t.toLowerCase())},o.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",o.global=function(){var t=o.DEFAULT_CALLBACK,e=o.DEFAULT_QUERY_METHOD,n=o.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return e},setDefaultQueryMethod:function(t){e=t},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(t){n=t}}}();var c=Object(l.b)("base");Object(l.c)("base",function(t,e,n,o,i,a,s){c.apply(this,arguments),r.apply(this,arguments)}),a.a.getSingleton().add("afterInit",i),a.a.getSingleton().add("afterUpdateSettings",i),e.a=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(0),l=n(7),u=n(6),c=n(42),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},d=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return i(e,t),h(e,[{key:"isEnabled",value:function(){return Object(c.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterRender",function(){return t.onAfterRender()}),this.registerEvents(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",function(){return t.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return t.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,o=t.leftOverlay,r=t.topLeftCornerOverlay,i=t.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(o),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(s.arrayEach)(this.clones,function(t){Object(a.addClass)(t,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,Object(s.arrayEach)(this.clones,function(t){Object(a.removeClass)(t,"hide-tween"),Object(a.addClass)(t,"show-tween")}),setTimeout(function(){Object(s.arrayEach)(t.clones,function(t){Object(a.removeClass)(t,"show-tween")})},400),Object(s.arrayEach)(this.scrollbars,function(t){t.refresh(),t.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),e}(l.a);Object(u.d)("touchScroll",d),e.a=d},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){t&&"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&"MergeCells"!==n&&e.done(new a.ChangeAction(t))}),t.addHook("afterCreateRow",function(t,n,o){if("UndoRedo.undo"!==o&&"UndoRedo.undo"!==o&&"auto"!==o){var r=new a.CreateRowAction(t,n);e.done(r)}}),t.addHook("beforeRemoveRow",function(t,n,o,r){if("UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r){var i=e.instance.getSourceDataArray();t=(i.length+t)%i.length;var s=Object(v.deepClone)(i.slice(t,t+n));e.done(new a.RemoveRowAction(t,s))}}),t.addHook("afterCreateCol",function(t,n,o){"UndoRedo.undo"!==o&&"UndoRedo.redo"!==o&&"auto"!==o&&e.done(new a.CreateColumnAction(t,n))}),t.addHook("beforeRemoveCol",function(n,o,r,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var s=e.instance.getSourceDataArray();n=(e.instance.countCols()+n)%e.instance.countCols();var l=[],u=[],c=[];Object(p.rangeEach)(s.length-1,function(e){var r=[],i=s[e];Object(p.rangeEach)(n,n+(o-1),function(e){r.push(i[t.runHooks("modifyCol",e)])}),l.push(r)}),Object(p.rangeEach)(o-1,function(e){c.push(t.runHooks("modifyCol",n+e))}),Array.isArray(t.getSettings().colHeaders)&&Object(p.rangeEach)(o-1,function(e){u.push(t.getSettings().colHeaders[t.runHooks("modifyCol",n+e)]||null)});var h=e.instance.getPlugin("manualColumnMove"),f=h.isEnabled()?h.columnsMapper.__arrayMap:[],d=new a.RemoveColumnAction(n,c,l,u,f);e.done(d)}}),t.addHook("beforeCellAlignment",function(t,n,o,r){var i=new a.CellAlignmentAction(t,n,o,r);e.done(i)}),t.addHook("beforeFilter",function(t){e.done(new a.FiltersAction(t))}),t.addHook("beforeRowMove",function(t,n){!1!==t&&e.done(new a.RowMoveAction(t,n))}),t.addHook("beforeMergeCells",function(n,o){o||e.done(new a.MergeCells(t,n))}),t.addHook("afterUnmergeCells",function(n,o){o||e.done(new a.UnmergeCells(t,n))})}function s(){var t=this;void 0===t.getSettings().undo||t.getSettings().undo?t.undoRedo||(t.undoRedo=new a(t),c(t),t.addHook("beforeKeyDown",l),t.addHook("afterChange",u)):t.undoRedo&&(delete t.undoRedo,h(t),t.removeHook("beforeKeyDown",l),t.removeHook("afterChange",u))}function l(t){var e=this;(t.ctrlKey||t.metaKey)&&!t.altKey&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(e.undoRedo.redo(),Object(g.stopImmediatePropagation)(t)):90===t.keyCode&&(e.undoRedo.undo(),Object(g.stopImmediatePropagation)(t)))}function u(t,e){var n=this;if("loadData"===e)return n.undoRedo.clear()}function c(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function h(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var f=n(13),d=n(0),p=n(4),v=n(1),g=n(11),y=n(9),m=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();a.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},a.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop(),e=Object(v.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeUndo",e))return;this.ignoreNewActions=!0;var o=this;t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),n.runHooks("afterUndo",e)}},a.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop(),e=Object(v.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeRedo",e))return;this.ignoreNewActions=!0;var o=this;t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),n.runHooks("afterRedo",e)}},a.prototype.isUndoAvailable=function(){return this.doneActions.length>0},a.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},a.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},a.Action=function(){},a.Action.prototype.undo=function(){},a.Action.prototype.redo=function(){},a.ChangeAction=function(t){this.changes=t,this.actionType="change"},Object(v.inherit)(a.ChangeAction,a.Action),a.ChangeAction.prototype.undo=function(t,e){for(var n=Object(v.deepClone)(this.changes),o=t.countEmptyRows(!0),r=t.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;s<l;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&o===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},a.ChangeAction.prototype.redo=function(t,e){for(var n=Object(v.deepClone)(this.changes),o=0,r=n.length;o<r;o++)n[o].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.redo")},a.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Object(v.inherit)(a.CreateRowAction,a.Action),a.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),o=t.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},a.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},a.RemoveRowAction=function(t,e){this.index=t,this.data=e,this.actionType="remove_row"},Object(v.inherit)(a.RemoveRowAction,a.Action),a.RemoveRowAction.prototype.undo=function(t,e){t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterRender",e),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},a.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},a.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Object(v.inherit)(a.CreateColumnAction,a.Action),a.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},a.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},a.RemoveColumnAction=function(t,e,n,o,r){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=r.slice(0),this.actionType="remove_col"},Object(v.inherit)(a.RemoveColumnAction,a.Action),a.RemoveColumnAction.prototype.undo=function(t,e){var n=this,o=void 0,r=this.indexes.slice(0).sort(),i=function(t,e,o){return o[n.indexes.indexOf(r[e])]},a=[];Object(p.rangeEach)(this.data.length-1,function(t){a[t]=Object(d.arrayMap)(n.data[t],i)});var s=[];s=Object(d.arrayMap)(this.headers,i);var l=[];t.runHooks("beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),Object(p.rangeEach)(this.data.length-1,function(e){o=t.getSourceDataAtRow(e),Object(p.rangeEach)(r.length-1,function(t){o.splice(r[t],0,a[e][t]),l.push([e,r[t],null,a[e][t]])})}),t.getPlugin("formulas")&&t.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&Object(p.rangeEach)(s.length-1,function(e){t.getSettings().colHeaders.splice(r[e],0,s[e])}),t.getPlugin("manualColumnMove")&&(t.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),t.addHookOnce("afterRender",e),t.runHooks("afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),t.getPlugin("formulas")&&t.getPlugin("formulas").recalculateFull(),t.render()},a.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},a.CellAlignmentAction=function(t,e,n,o){this.stateBefore=t,this.range=e,this.type=n,this.alignment=o},a.CellAlignmentAction.prototype.undo=function(t,e){var n=this;t.getPlugin("contextMenu").isEnabled()&&(Object(d.arrayEach)(this.range,function(e){for(var o=e.from,r=e.to,i=o.row;i<=r.row;i++)for(var a=o.col;a<=r.col;a++)t.setCellMeta(i,a,"className",n.stateBefore[i][a]||" htLeft")}),t.addHookOnce("afterRender",e),t.render())},a.CellAlignmentAction.prototype.redo=function(t,e){var n=this;t.getPlugin("contextMenu").isEnabled()&&(Object(d.arrayEach)(this.range,function(e){var o=e.from,r=e.to;t.selectCell(o.row,o.col,r.row,r.col),t.getPlugin("contextMenu").executeCommand("alignment:"+n.alignment.replace("ht","").toLowerCase())}),t.addHookOnce("afterRender",e),t.render())},a.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Object(v.inherit)(a.FiltersAction,a.Action),a.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},a.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()},a.MergeCells=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.cellRange=n,i.rangeData=t.getData(n.from.row,n.from.col,n.to.row,n.to.col),i}return i(e,t),m(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange)}}]),e}(a.Action),a.UnmergeCells=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.cellRange=n,i}return i(e,t),m(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),e}(a.Action),a.RowMoveAction=function(t,e){this.rows=t.slice(),this.target=e},Object(v.inherit)(a.RowMoveAction,a.Action),a.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e);for(var o=this.rows[0]<this.target?-1*this.rows.length:0,r=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],i=[],a=this.rows.length+o,s=o;s<a;s+=1)i.push(this.target+s);n.moveRows(i.slice(),r),t.render(),t.selection.setRangeStartOnly(new y.a(this.rows[0],0)),t.selection.setRangeEnd(new y.a(this.rows[this.rows.length-1],t.countCols()-1))},a.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e),n.moveRows(this.rows.slice(),this.target),t.render();var o=this.rows[0]<this.target?this.target-this.rows.length:this.target;t.selection.setRangeStartOnly(new y.a(o,0)),t.selection.setRangeEnd(new y.a(o+this.rows.length-1,t.countCols()-1))};var b=f.a.getSingleton();b.add("afterInit",s),b.add("afterUpdateSettings",s),b.register("beforeUndo"),b.register("afterUndo"),b.register("beforeRedo"),b.register("afterRedo"),e.a=a},function(t,e,n){"use strict";n(378),n(383),n(384),n(386),n(388),n(393),n(422),n(435),n(438),n(439),n(442),n(447),n(451),n(455)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=(n(0),n(4)),l=n(6),u=n(379),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},f=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.bindStrategy=new u.a,n.removedRows=[],n}return i(e,t),c(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof n&&(n=u.a.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(n),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(e){return t.onModifyRowHeader(e)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(e,n){return t.onAfterRemoveRow(e,n)}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function(t,e){this.bindStrategy.createRow(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(s.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t))})}},{key:"onAfterRemoveRow",value:function(t,e){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(l.d)("bindRowsWithHeaders",f)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=(n(54),n(1),n(4)),i=n(30),a=n(380),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){o(this,t),this.strategy=null}return s(t,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),s(t,[{key:"setStrategy",value:function(t){var e=a[Object(i.toUpperCaseFirst)(t)];if(!e)throw new Error('Bind strategy "'+t+'" does not exist.');this.strategy=new e}},{key:"createMap",value:function(t){var e=this.strategy,n=void 0===t?e._arrayMap.length:t;e._arrayMap.length=0,Object(r.rangeEach)(n-1,function(t){e._arrayMap.push(t)})}},{key:"createRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.strategy.createRow.apply(this.strategy,e)}},{key:"removeRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.strategy.removeRow.apply(this.strategy,e)}},{key:"translate",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.strategy.getValueByIndex.apply(this.strategy,e)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(381),r=n(382);n.d(e,"Loose",function(){return o.a}),n.d(e,"Strict",function(){return r.a})},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(54),i=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=function(){function t(){o(this,t)}return a(t,[{key:"createRow",value:function(t,e){this.shiftItems(t,e)}},{key:"removeRow",value:function(t,e){this.unshiftItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"loose"}}]),t}();Object(i.mixin)(s,r.a),e.a=s},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(54),i=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=function(){function t(){o(this,t)}return a(t,[{key:"createRow",value:function(t,e){this.insertItems(t,e)}},{key:"removeRow",value:function(t,e){this.removeItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"strict"}}]),t}();Object(i.mixin)(s,r.a),e.a=s},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(1),s=n(0),l=n(4),u=n(2),c=n(8),h=n(6),f=n(11),d=n(7),p=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),v=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},g=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings=null,n.buttonEnabledList={},n.hiddenColumnsPlugin=null,n.nestedHeadersPlugin=null,n.collapsedSections={},n.columnHeaderLevelCount=null,n.eventManager=null,n}return i(e,t),p(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return t.onAfterRender()}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)}),this.addHook("beforeOnCellMouseDown",function(e,n,o){return t.onBeforeOnCellMouseDown(e,n,o)}),this.eventManager=new c.a(this.hot),v(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),v(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,r=function(t){t&&t.parentNode.removeChild(t)};Object(l.rangeEach)(0,t-1,function(t){var i=e.childNodes[t],a=n.childNodes[t],s=o?o.childNodes[t]:null;Object(l.rangeEach)(0,i.childNodes.length-1,function(t){var e=i.childNodes[t].querySelector(".collapsibleIndicator");r(e),a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(".collapsibleIndicator"),r(e)),o&&s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(".collapsibleIndicator"),r(e))})},!0)}}},{key:"parseSettings",value:function(){var t=this;Object(a.objectEach)(this.settings,function(e){t.buttonEnabledList[e.row]||(t.buttonEnabledList[e.row]={}),t.buttonEnabledList[e.row][e.col]=e.collapsible})}},{key:"meetsDependencies",value:function(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function(){var t=this.hot.getSettings();this.meetsDependencies()||(t.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),t.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(t,e){var n=e.parentNode,o=n.parentNode,r=-1*o.childNodes.length+Array.prototype.indexOf.call(o.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[r]||!this.buttonEnabledList[r][t]))return null;var i=document.createElement("DIV");return Object(u.addClass)(i,"collapsibleIndicator"),this.collapsedSections[r]&&!0===this.collapsedSections[r][t]?(Object(u.addClass)(i,"collapsed"),Object(u.fastInnerText)(i,"+")):(Object(u.addClass)(i,"expanded"),Object(u.fastInnerText)(i,"-")),i}},{key:"markSectionAs",value:function(t,e,n,o){switch(this.collapsedSections[e]||(this.collapsedSections[e]={}),t){case"collapsed":this.collapsedSections[e][n]=!0;break;case"expanded":this.collapsedSections[e][n]=void 0}if(o)for(var r=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e),a=this.nestedHeadersPlugin.getChildHeaders(e,n),s=r[i+1],l=1;l<a.length;l++)s&&s[a[l]].colspan>1&&this.markSectionAs(t,e+1,a[l],!0)}},{key:"expandSection",value:function(t){this.markSectionAs("expanded",t.row,t.col,!0),this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function(t){this.markSectionAs("collapsed",t.row,t.col,!0),this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.nestedHeadersPlugin.colspanArray;!0===this.settings?Object(s.arrayEach)(n,function(n,o){Object(s.arrayEach)(n,function(n,r){if(n.colspan>1){o=parseInt(o,10),r=parseInt(r,10);var i=e.nestedHeadersPlugin.levelToRowCoords(o),a=r;e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}})}):Object(a.objectEach)(this.buttonEnabledList,function(n,o){Object(a.objectEach)(n,function(n,r){o=parseInt(o,10),r=parseInt(r,10),e.markSectionAs("collapse"===t?"collapsed":"expanded",o,r,!0),e.toggleCollapsibleSection({row:o,col:r},t)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;t.row&&(t.row=parseInt(t.row,10)),t.col&&(t.col=parseInt(t.col,10));for(var o=this.hiddenColumnsPlugin.hiddenColumns,r=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(t.row),a=r[i][t.col].colspan,s=this.nestedHeadersPlugin.getChildHeaders(t.row,t.col),u=i+1,c=r[u],h=c?c[s[0]].colspan||1:1;h===a&&u<this.columnHeaderLevelCount;)u+=1,c=r[u],h=c?c[s[0]].colspan||1:1;Object(l.rangeEach)(h,a-1,function(r){var i=t.col+r;switch(e){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||o.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&o.splice(o.indexOf(i),1)}}),this.hot.render()}},{key:"onAfterGetColHeader",value:function(t,e){if(e.hasAttribute("colspan")&&e.getAttribute("colspan")>1&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,e);null!==n&&e.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(t,e){if(Object(u.hasClass)(t.target,"collapsibleIndicator"))return Object(u.hasClass)(t.target,"expanded")?(this.collapsedSections[e.row]||(this.collapsedSections[e.row]=[]),this.markSectionAs("collapsed",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"collapse")):Object(u.hasClass)(t.target,"collapsed")&&(this.markSectionAs("expanded",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"expand")),Object(f.stopImmediatePropagation)(t),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,v(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(d.a);Object(h.d)("collapsibleColumns",g)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(1),l=(n(0),n(6)),u=n(385),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},f=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.endpoints=null,n}return i(e,t),c(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new u.a(this,this.settings),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)}),this.addHook("beforeCreateRow",function(e,n,o){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,o)}),this.addHook("beforeCreateCol",function(e,n,o){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,o)}),this.addHook("beforeRemoveRow",function(){for(var e,n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(o))}),this.addHook("beforeRemoveCol",function(){for(var e,n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(o))}),this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)}),this.addHook("afterCreateRow",function(e,n,o){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,o)}),this.addHook("afterCreateCol",function(e,n,o){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,o)}),this.addHook("afterRemoveRow",function(){for(var e,n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(o))}),this.addHook("afterRemoveCol",function(){for(var e,n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(o))}),this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)}),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(t){var e=0;for(var n in t.ranges)Object(s.hasOwnProperty)(t.ranges,n)&&(e+=this.getPartialSum(t.ranges[n],t.sourceColumn));return e}},{key:"getPartialSum",value:function(t,e){var n=0,o=t[1]||t[0],r=null,i=0;do{r=this.getCellValue(o,e)||0;var a=((r+"").split(".")[1]||[]).length||1;a>i&&(i=a),n+=r||0,o--}while(o>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=null;for(var o in t.ranges)if(Object(s.hasOwnProperty)(t.ranges,o)){var r=this.getPartialMinMax(t.ranges[o],t.sourceColumn,e);if(null===n&&null!==r&&(n=r),null!==r)switch(e){case"min":n=Math.min(n,r);break;case"max":n=Math.max(n,r)}}return null===n?"Not enough data":n}},{key:"getPartialMinMax",value:function(t,e,n){var o=null,r=t[1]||t[0],i=void 0;do{if(i=this.getCellValue(r,e)||null,null===o)o=i;else if(null!==i)switch(n){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i)}r--}while(r>=t[0]);return o}},{key:"countEmpty",value:function(t,e){var n=void 0,o=0,r=t[1]||t[0];do{n=this.getCellValue(r,e),n||o++,r--}while(r>=t[0]);return o}},{key:"countEntries",value:function(t){var e=0,n=t.ranges;for(var o in n)if(Object(s.hasOwnProperty)(n,o)){var r=void 0===n[o][1]?1:n[o][1]-n[o][0]+1,i=this.countEmpty(n[o],t.sourceColumn);e+=r,e-=i}return e}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,e){var n=this.endpoints.getVisualRowIndex(t),o=this.endpoints.getVisualColumnIndex(e),r=this.hot.getSourceDataAtCell(t,e);if((this.hot.getCellMeta(n,o).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof r&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+t+", "+e+") is not in a numeric format. Cannot do the calculation.");return r}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onBeforeRowMove",value:function(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}]),e}(a.a);Object(l.d)("columnSummary",f)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=(n(1),n(53)),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=Object(i.a)(this.hot)}return s(t,[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[];return t||"function"!=typeof this.settings?(t||(t=this.settings),Object(r.arrayEach)(t,function(t){var o={};e.assignSetting(t,o,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,o,"reversedRowCoords",!1),e.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,o,"sourceColumn",t.destinationColumn),e.assignSetting(t,o,"type","sum"),e.assignSetting(t,o,"forceNumeric",!1),e.assignSetting(t,o,"suppressDataTypeErrors",!0),e.assignSetting(t,o,"suppressDataTypeErrors",!0),e.assignSetting(t,o,"customFunction",null),e.assignSetting(t,o,"readOnly",!0),e.assignSetting(t,o,"roundFloat",!1),n.push(o)}),n):void(this.settingsType="function")}},{key:"assignSetting",value:function(t,e,n,o){if("ranges"===n&&void 0===t[n])return void(e[n]=o);if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(o instanceof Error)throw o;e[n]=o}else e[n]="destinationRow"===n&&e.reversedRowCoords?this.hot.countRows()-t[n]-1:t[n]}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n,o,i){if("function"===this.settingsType){var a=t.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();Object(r.arrayEach)(s,function(o,r,i){"row"===a&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===a&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,o,i){var a=this,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType)return void this.hot.addHookOnce("beforeRender",function t(){return a.hot.removeHook("beforeRender",t),a.refreshAllEndpoints(!0)});var l=t.indexOf("row")>-1?"row":"col",u=t.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),h=0===t.indexOf("move_row"),f=e;Object(r.arrayEach)(c,function(t,e,o){"row"===l&&t.destinationRow>=f&&(t.alterRowOffset=u*n),"col"===l&&t.destinationColumn>=f&&(t.alterColumnOffset=u*n)}),this.resetAllEndpoints(c,!h),h?Object(r.arrayEach)(c,function(t,e,n){a.extendEndpointRanges(t,f,o[0],o.length),a.recreatePhysicalRanges(t),a.clearOffsetInformation(t)}):Object(r.arrayEach)(c,function(t,e,n){a.shiftEndpointCoordinates(t,f)}),s&&this.refreshAllEndpoints(!0)}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,o){Object(r.arrayEach)(t.ranges,function(t,r){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=o:n<t[0]&&(t[0]-=o):n>=t[0]&&n<=t[1]&&(t[1]-=o,e<=t[0]&&(t[0]++,t[1]++)))})}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,o=[],i=[];Object(r.arrayEach)(n,function(t){var n=[];if(t[1])for(var o=t[0];o<=t[1];o++)n.push(e.recordTranslator.toPhysicalRow(o));else n.push(e.recordTranslator.toPhysicalRow(t[0]));i.push(n)}),Object(r.arrayEach)(i,function(t){var e=[];Object(r.arrayEach)(t,function(n,r){0===r?e.push(n):t[r]!==t[r-1]+1&&(e.push(t[r-1]),o.push(e),e=[],e.push(n)),r===t.length-1&&(e.push(n),o.push(e))})}),t.ranges=o}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(r.arrayEach)(t.ranges,function(n,o){Object(r.arrayEach)(n,function(o,r){o>=e&&(n[r]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.cellsToSetCache=[],t||(t=this.getAllEndpoints()),Object(r.arrayEach)(t,function(t){e.resetEndpointValue(t,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(t){var e=this;this.cellsToSetCache=[],Object(r.arrayEach)(this.getAllEndpoints(),function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],Object(r.arrayEach)(t,function(t,o,i){(t[2]||"")+""!=t[3]+""&&Object(r.arrayEach)(e.getAllEndpoints(),function(t,r){e.hot.propToCol(i[o][1])===t.sourceColumn&&-1===n.indexOf(r)&&n.push(r)})}),Object(r.arrayEach)(n,function(t){e.refreshEndpoint(e.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,o=t.alterColumnOffset||0,r=this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),i=a(r,2),s=i[0],l=i[1],u=this.hot.getCellMeta(s,l);u.readOnly=!1,u.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(e?n:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(e?o:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=-1*t.alterRowOffset||0,r=-1*t.alterColumnOffset||0,i=this.getVisualRowIndex(t.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+o),t.destinationColumn+r);if(i>this.hot.countRows()||t.destinationColumn>this.hot.countCols())return void this.throwOutOfBoundsWarning();"init"!==e&&a.readOnly===t.readOnly||(a.readOnly=t.readOnly,a.className="columnSummaryResult"),t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(i,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"getVisualRowIndex",value:function(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=(n(1),n(211)),u=n(8),c=n(2),h=n(212),f=n(156),d=n(6),p=n(13),v=n(11),g=n(43),y=n(387),m=(n.n(y),function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}),b=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();p.a.getSingleton().register("afterDropdownMenuDefaultOptions"),p.a.getSingleton().register("afterDropdownMenuShow"),p.a.getSingleton().register("afterDropdownMenuHide"),p.a.getSingleton().register("afterDropdownMenuExecute");var w=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new u.a(n),n.commandExecutor=new l.a(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}return i(e,t),b(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[g.c,g.d,g.l,g.h,g.l,g.b,g.l,g.f,g.l,g.a]}}]),b(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new h.a(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().dropdownMenu,o={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",o),t.itemsFactory.setPredefinedItems(o.items);var e=t.itemsFactory.getItems(n);t.menu&&t.menu.destroy(),t.menu=new f.a(t.hot,{className:"htDropdownMenu",keepInViewport:!0}),t.hot.runHooks("beforeDropdownMenuSetItems",e),t.menu.setMenuItems(e),t.menu.addLocalHook("afterOpen",function(){return t.onMenuAfterOpen()}),t.menu.addLocalHook("afterClose",function(){return t.onMenuAfterClose()}),t.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.apply(t,n)}),Object(s.arrayEach)(e,function(e){return t.commandExecutor.registerCommand(e.key,e)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,e)}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(Object(v.stopPropagation)(t),Object(c.hasClass)(t.target,"changeType")&&!this.menu.isOpened()){var e=t.target.getBoundingClientRect();this.open({left:e.left,top:e.top+t.target.offsetHeight+3,width:e.width,height:e.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var o=n.parentNode.childNodes,r=Array.prototype.indexOf.call(o,n);if(!(t<0||r!==o.length-1)){var i=e.querySelector(".changeType");if(!this.enabled||!i){if(!this.enabled)return void(i&&i.parentNode.removeChild(i));var a=document.createElement("button");a.className="changeType",a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}}}}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);w.SEPARATOR={name:g.l},Object(d.d)("dropdownMenu",w)},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=(n(1),n(6)),l=n(389),u=n(390),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),c(e,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){return this._createTypeFormatter(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).export()}},{key:"exportAsBlob",value:function(t){return this._createBlob(this._createTypeFormatter(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._createTypeFormatter(t,e),o=this._createBlob(n),r=window.URL||window.webkitURL,i=document.createElement("a"),a=n.options.filename+"."+n.options.fileExtension;if(void 0!==i.download){var s=r.createObjectURL(o);i.style.display="none",i.setAttribute("href",s),i.setAttribute("download",a),document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i),setTimeout(function(){r.revokeObjectURL(s)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,a)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!u.a[t])throw new Error('Export format type "'+t+'" is not supported.');return Object(u.b)(t,new l.a(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:t.options.mimeType+";charset="+t.options.encoding})),e}}]),e}(a.a);Object(s.d)("exportFile",h)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=(n(0),n(1),n(4)),i=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.hot=e,this.options={}}return a(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,o=e.startCol,i=e.endRow,a=e.endCol,s=this.options,l=[];return Object(r.rangeEach)(n,i,function(e){var n=[];!s.exportHiddenRows&&t._isHiddenRow(e)||(Object(r.rangeEach)(o,a,function(o){!s.exportHiddenColumns&&t._isHiddenColumn(o)||n.push(t.hot.getDataAtCell(e,o))}),l.push(n))}),l}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),o=n.startRow,i=n.endRow,a=this.hot.getRowHeader();Object(r.rangeEach)(o,i,function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(a[n])})}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),o=n.startCol,i=n.endCol,a=this.hot.getColHeader();Object(r.rangeEach)(o,i,function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(a[n])})}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=i(this.options.range,4),o=n[0],r=void 0===o?0:o,a=n[1],s=void 0===a?0:a,l=n[2],u=void 0===l?e:l,c=n[3],h=void 0===c?t:c;return r=Math.max(r,0),s=Math.max(s,0),u=Math.min(u,e),h=Math.min(h,t),{startRow:r,startCol:s,endRow:u,endCol:h}}},{key:"_isHiddenRow",value:function(t){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",t)}},{key:"_isHiddenColumn",value:function(t){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",t)}}]),t}()},function(t,e,n){"use strict";function o(t,e,n){return"function"==typeof i[t]?new i[t](e,n):null}n.d(e,"a",function(){return i}),e.b=o;var r=n(391),i=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},"csv",r.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(0),s=n(14),l=n(392),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=String.fromCharCode(13),h=String.fromCharCode(34),f=String.fromCharCode(10);e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"export",value:function(){var t=this,e=this.options,n=this.dataProvider.getData(),o=this.dataProvider.getColumnHeaders(),r=o.length>0,i=this.dataProvider.getRowHeaders(),s=i.length>0,l="\ufeff";return r&&(o=Object(a.arrayMap)(o,function(e){return t._escapeCell(e,!0)}),s&&(l+=e.columnDelimiter),l+=o.join(e.columnDelimiter),l+=e.rowDelimiter),Object(a.arrayEach)(n,function(n,o){o>0&&(l+=e.rowDelimiter),s&&(l+=t._escapeCell(i[o])+e.columnDelimiter),l+=n.map(function(e){return t._escapeCell(e)}).join(e.columnDelimiter)}),l}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=Object(s.stringify)(t),""!==t&&(e||t.indexOf(c)>=0||t.indexOf(h)>=0||t.indexOf(f)>=0||t.indexOf(this.options.columnDelimiter)>=0)&&(t=t.replace(new RegExp('"',"g"),'""'),t='"'+t+'"'),t}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}}]),e}(l.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=(n(0),n(1)),i=(n(4),n(30)),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n){o(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return a(t,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),a(t,[{key:"_mergeOptions",value:function(e){var n=Object(r.clone)(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Object(r.extend)(Object(r.clone)(t.DEFAULT_OPTIONS),n),n=Object(r.extend)(n,e),n.filename=Object(i.substitute)(n.filename,{YYYY:o.getFullYear(),MM:(o.getMonth()+1+"").padStart(2,"0"),DD:(o.getDate()+"").padStart(2,"0")}),n}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=n(61),u=n(4),c=n(8),h=n(2),f=n(6),d=n(43),p=n(3),v=n(394),g=n(414),y=n(416),m=n(419),b=n(237),w=n(238),O=n(420),C=n(63),E=n(157),S=n(421),k=(n.n(S),function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),T=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),R=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},_=function(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The filter conditions have been applied properly, but couldnât be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldnât be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."]),j=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new c.a(n),n.trimRowsPlugin=null,n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}return i(e,t),T(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var n=function(e){return e.addLocalHook("accept",function(){return t.onActionBarSubmit("accept")}),e.addLocalHook("cancel",function(){return t.onActionBarSubmit("cancel")}),e.addLocalHook("change",function(n){return t.onComponentChange(e,n)}),e},o=function(){return t.hot.getTranslatedPhrase(p.FILTERS_DIVS_FILTER_BY_CONDITION)+":"},r=function(){return t.hot.getTranslatedPhrase(p.FILTERS_DIVS_FILTER_BY_VALUE)+":"};if(!this.components.get("filter_by_condition")){var i=new v.a(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1});i.addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),this.components.set("filter_by_condition",n(i))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new g.a(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var a=new v.a(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0});a.addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),this.components.set("filter_by_condition2",n(a))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new y.a(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new m.a(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new b.a),this.conditionUpdateObserver||(this.conditionUpdateObserver=new O.a(this.conditionCollection,function(e){return t.getDataMapAtColumn(e)}),this.conditionUpdateObserver.addLocalHook("update",function(e){return t.updateComponents(e)})),this.components.forEach(function(t){t.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(e){return t.onBeforeDropdownMenuSetItems(e)}),this.addHook("afterDropdownMenuDefaultOptions",function(e){return t.onAfterDropdownMenuDefaultOptions(e)}),this.addHook("afterDropdownMenuShow",function(){return t.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return t.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(e,n){return t.onAfterChange(e)}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),R(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(t){t.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll()),R(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:E.c;this.conditionCollection.addCondition(this.t.toPhysicalColumn(t),{command:{key:e},args:n},o)}},{key:"removeConditions",value:function(t){this.conditionCollection.removeConditions(this.t.toPhysicalColumn(t))}},{key:"clearConditions",value:function(t){void 0===t?this.conditionCollection.clean():this.conditionCollection.clearConditions(this.t.toPhysicalColumn(t))}},{key:"filter",value:function(){var t=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(e){var r=[];this.trimRowsPlugin.trimmedRows.length=0,n=Object(s.arrayMap)(t.filter(),function(t){return t.meta.visualRow});var i=Object(C.a)(n);Object(u.rangeEach)(this.hot.countSourceRows()-1,function(t){i(t)||r.push(t)}),this.trimRowsPlugin.trimRows(r),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",o)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var t=this.hot.getSelectedLast()||[],e=k(t,2),n=e[0],o=e[1];void 0!==n&&void 0!==o&&this.hot.selectCell(n,o)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.t.toVisualColumn(t),o=[];return Object(s.arrayEach)(this.hot.getSourceDataAtCol(n),function(t,r){var i=e.hot.getCellMeta(r,n);o.push({meta:{row:i.row,col:i.col,visualCol:i.visualCol,visualRow:i.visualRow,type:i.type,instance:i.instance,dateFormat:i.dateFormat},value:Object(C.c)(t)})}),o}},{key:"onAfterChange",value:function(t){var e=this;t&&Object(s.arrayEach)(t,function(t){var n=k(t,2),o=n[1],r=e.hot.propToCol(o);e.updateValueComponentCondition(r)})}},{key:"updateValueComponentCondition",value:function(t){var e=this.hot.getDataAtCol(t);this.conditionUpdateObserver.updateStatesAtColumn(t,Object(C.d)(e))}},{key:"onAfterDropdownMenuShow",value:function(){var t=this.getSelectedColumn(),e=t&&t.physicalIndex;this.components.forEach(function(t){!t.isHidden()&&t.setState&&t.restoreState(e)})}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(t){var e=Object(s.arrayMap)(t,function(t){return t.key});this.components.forEach(function(t){t[-1===e.indexOf(t.getMenuItemDescriptor().key)?"hide":"show"]()}),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:d.l}),this.components.forEach(function(e){t.items.push(e.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(t,e,n,o){var r=t;return r===E.d&&e.command.key!==E.b&&n.command.key!==E.b&&o.command.key!==E.b?r=E.e:o.command.key!==E.b&&(e.command.key!==E.b&&n.command.key!==E.b||(r=E.c)),r}},{key:"onActionBarSubmit",value:function(t){if("accept"===t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex,o=this.components.get("filter_by_condition").getState(),r=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,r,i);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(n),o.command.key===E.b&&r.command.key===E.b&&i.command.key===E.b?this.conditionCollection.removeConditions(n):(o.command.key!==E.b&&(this.conditionCollection.addCondition(n,o,a),r.command.key!==E.b&&this.conditionCollection.addCondition(n,r,a)),i.command.key!==E.b&&this.conditionCollection.addCondition(n,i,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(n),this.components.get("filter_by_value").saveState(n),this.saveHiddenRowsCache(n),this.trimRowsPlugin.trimmedRows.length=0,this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(t,e){t===this.components.get("filter_by_condition")&&(e.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))),t.constructor!==v.a||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.t.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Object(h.addClass)(e,"htFiltersActive"):Object(h.removeClass)(e,"htFiltersActive")}},{key:"onTableClick",value:function(t){var e=Object(h.closest)(t.target,"TH");if(e){var n=this.hot.getCoords(e).col;this.lastSelectedColumn={visualIndex:n,physicalIndex:this.t.toPhysicalColumn(n)}}}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(t){t.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin()),R(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var t=this;return new w.a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection,function(e){return t.getDataMapAtColumn(e)})}},{key:"updateComponents",value:function(t){if(this.dropdownMenuPlugin.enabled){var e=t.editedConditionStack.conditions,n=t.editedConditionStack.column,o=e.filter(function(t){return t.name===E.a}),r=e.filter(function(t){return t.name!==E.a}),i=this.conditionCollection.columnTypes[n];2===o.length||3===r.length?console.warn(Object(l.a)(_)):(r.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),n),this.components.get("filter_by_condition").updateState(r[0],n),this.components.get("filter_by_condition2").updateState(r[1],n),this.components.get("filter_by_value").updateState(t),this.components.get("filter_operators").updateState(i,n))}}},{key:"showComponentForParticularColumn",value:function(t,e){this.hiddenRowsCache.has(e)?this.removeIndexesFromHiddenRowsCache(e,this.getIndexesOfComponents(t)):this.hiddenRowsCache.set(e,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(t,e){var n=this.hiddenRowsCache.get(t);Object(s.arrayEach)(e,function(t){n.includes(t)&&n.splice(n.indexOf(t),1)})}},{key:"hideComponentForParticularColumn",value:function(t,e){this.hiddenRowsCache.has(e)?this.addIndexesToHiddenRowsCache(e,this.getIndexesOfComponents(t)):this.hiddenRowsCache.set(e,this.getIndexesOfComponents(t))}},{key:"addIndexesToHiddenRowsCache",value:function(t,e){var n=this.hiddenRowsCache.get(t);Object(s.arrayEach)(e,function(t){-1===n.indexOf(t)&&n.push(t)})}},{key:"getIndexesOfComponents",value:function(){for(var t=this.dropdownMenuPlugin.menu,e=[],n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return Object(s.arrayEach)(o,function(n){Object(s.arrayEach)(t.menuItems,function(t,o){t.key===n.getMenuItemDescriptor().key&&e.push(o)})}),e}},{key:"changeComponentsVisibility",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdownMenuPlugin.menu,n=e.hotMenu,o=n.getPlugin("hiddenRows"),r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,i);t?o.showRows(s):o.hideRows(s),n.render()}},{key:"initHiddenRowsCache",value:function(){var t=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var e=t.lastSelectedColumn.physicalIndex;t.hiddenRowsCache.has(e)||t.hiddenRowsCache.set(e,t.getIndexesOfComponents(t.components.get("filter_operators"),t.components.get("filter_by_condition2"))),t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:t.hiddenRowsCache.get(e)}})})}},{key:"saveHiddenRowsCache",value:function(t){this.hiddenRowsCache.set(t,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}}]),e}(a.a);Object(f.d)("filters",j)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(11),l=n(0),u=n(18),c=n(1),h=n(3),f=n(84),d=n(157),p=n(159),v=n(413),g=n(10),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.id=n.id,i.name=n.name,i.addSeparator=n.addSeparator,i.elements.push(new v.a(i.hot)),i.elements.push(new p.a(i.hot,{placeholder:h.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),i.elements.push(new p.a(i.hot,{placeholder:h.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),i.registerHooks(),i}return i(e,t),y(e,[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",function(e){return t.onConditionSelect(e)}),this.getSelectElement().addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),Object(l.arrayEach)(this.getInputElements(),function(e){e.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})})}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=Object(c.clone)(t.command);n.name.startsWith(h.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Object(l.arrayEach)(t.args,function(t,o){if(o>n.inputsCount-1)return!1;var r=e.getInputElement(o);r.setValue(t),r[n.inputsCount>o?"show":"hide"](),o||setTimeout(function(){return r.focus()},10)})}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||Object(g.b)(d.b),e=[];return Object(l.arrayEach)(this.getInputElements(),function(n,o){t.inputsCount>o&&e.push(n.getValue())}),{command:t,args:e}}},{key:"updateState",value:function(t,e){this.setCachedState(e,{command:t?Object(g.b)(t.name):Object(g.b)(d.b),args:t?t.args:[]}),t||Object(l.arrayEach)(this.getInputElements(),function(t){return t.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof v.a})[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter(function(t){return t instanceof p.a})}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,o,r,i,s){Object(a.addClass)(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Object(a.addClass)(n.parentNode,"border");var u=document.createElement("div");return Object(a.addClass)(u,"htFiltersMenuLabel"),u.textContent=s,n.appendChild(u),Object(l.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"reset",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),n=t&&t.visualIndex,o=this.hot.getDataType.apply(this.hot,this.hot.getSelectedLast()||[0,n]),r=Object(d.f)(o);Object(l.arrayEach)(this.getInputElements(),function(t){return t.hide()}),this.getSelectElement().setItems(r),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"reset",this).call(this),this.getSelectElement().setValue(r[0])}},{key:"onConditionSelect",value:function(t){Object(l.arrayEach)(this.getInputElements(),function(e,n){e[t.inputsCount>n?"show":"hide"](),n||setTimeout(function(){return e.focus()},10)}),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){Object(u.isKey)(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Object(s.stopImmediatePropagation)(t)):Object(u.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(s.stopImmediatePropagation)(t))}}]),e}(f.a)},function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r,i=(n(0),n(1)),a=function(t,e){return t._states["state_"+e]},s=function(t,e,n){t._states["state_"+e]=n},l=(r={},o(r,"_states",{}),o(r,"getCachedState",function(t){return a(this,t)}),o(r,"setCachedState",function(t,e){s(this,t,e)}),o(r,"saveState",function(t){s(this,t,this.getState())}),o(r,"restoreState",function(t){this.setState(a(this,t))}),o(r,"hasSavedState",function(t){return void 0!==a(this,t)}),o(r,"clearState",function(t){s(this,t)}),o(r,"clearStates",function(){this._states={}}),r);Object(i.defineGetter)(l,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1}),e.a=l},function(t,e,n){"use strict";function o(){return!0}n.d(e,"a",function(){return a});var r=n(3),i=n(10),a="none";Object(i.c)(a,o,{name:r.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},function(t,e,n){"use strict";function o(t,e){return!Object(i.a)(a.a,e)(t)}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=n(229),s="not_empty";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},function(t,e,n){"use strict";function o(t,e){return!Object(i.a)(a.a,e)(t)}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=n(230),s="neq";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=a(e,1),o=n[0];return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="gt";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=a(e,1),o=n[0];return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="gte";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=a(e,1),o=n[0];return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="lt";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=a(e,1),o=n[0];return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="lte";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t,e){return!Object(i.a)(a.a,e)(t)}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=n(231),s="not_between";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=s(e,1),o=n[0];return Object(i.stringify)(t.value).toLowerCase().startsWith(Object(i.stringify)(o))}n.d(e,"a",function(){return l});var r=n(3),i=n(14),a=n(10),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="begins_with";Object(a.c)(l,o,{name:r.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=s(e,1),o=n[0];return Object(i.stringify)(t.value).toLowerCase().endsWith(Object(i.stringify)(o))}n.d(e,"a",function(){return l});var r=n(3),i=n(14),a=n(10),s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="ends_with";Object(a.c)(l,o,{name:r.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t,e){return!Object(i.a)(a.a,e)(t)}n.d(e,"a",function(){return s});var r=n(3),i=n(10),a=n(234),s="not_contains";Object(i.c)(s,o,{name:r.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";function o(t){var e=i()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(i()().subtract(-1,"days").startOf("day"),"d")}n.d(e,"a",function(){return l});var r=n(31),i=n.n(r),a=n(3),s=n(10),l="date_tomorrow";Object(s.c)(l,o,{name:a.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(t,e,n){"use strict";function o(t){var e=i()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(i()().startOf("day"),"d")}n.d(e,"a",function(){return l});var r=n(31),i=n.n(r),a=n(3),s=n(10),l="date_today";Object(s.c)(l,o,{name:a.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(t,e,n){"use strict";function o(t){var e=i()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(i()().subtract(1,"days").startOf("day"),"d")}n.d(e,"a",function(){return l});var r=n(31),i=n.n(r),a=n(3),s=n(10),l="date_yesterday";Object(s.c)(l,o,{name:a.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues;return(0,a(e,1)[0])(t.value)}n.d(e,"a",function(){return s});var r=(n(3),n(10)),i=n(63),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="by_value";Object(r.c)(s,o,{name:"By value",inputsCount:0,inputValuesDecorator:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:inputValues,e=a(t,1),n=e[0];return[Object(i.a)(n)]},showOperators:!1})},function(t,e,n){"use strict";function o(){return!0}var r=(n(3),n(10));Object(r.c)("true",o,{name:"True"})},function(t,e,n){"use strict";function o(){return!1}var r=(n(3),n(10));Object(r.c)("false",o,{name:"False"})},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(156),s=n(1),l=n(0),u=n(3),c=n(43),h=n(65),f=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},d=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=new WeakMap;e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object(s.extend)(e.DEFAULTS,n)));return p.set(i,{}),i.menu=null,i.items=[],i.registerHooks(),i}return i(e,t),d(e,null,[{key:"DEFAULTS",get:function(){return Object(s.clone)({className:"htUISelect",wrapIt:!1})}}]),d(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",function(e){return t.onClick(e)})}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return Object(l.arrayEach)(t,function(t){"string"==typeof t.name&&t.name.startsWith(u.FILTERS_CONDITIONS_NAMESPACE)&&(t.name=e.menu.hot.getTranslatedPhrase(t.name))}),t}},{key:"build",value:function(){var t=this;f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),this.menu=new a.a(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var n=new h.a(this.hot,{className:"htUISelectCaption"}),o=new h.a(this.hot,{className:"htUISelectDropdown"}),r=p.get(this);r.caption=n,r.captionElement=n.element,r.dropdown=o,Object(l.arrayEach)([n,o],function(e){return t._element.appendChild(e.element)}),this.menu.addLocalHook("select",function(e){return t.onMenuSelect(e)}),this.menu.addLocalHook("afterClose",function(){return t.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=void 0;t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(u.FILTERS_CONDITIONS_NONE),p.get(this).captionElement.textContent=t,f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:t.left-5,top:t.top,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==c.l&&(this.options.value=t,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(t){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=p.get(this),n=t.caption,o=t.dropdown;n&&n.destroy(),o&&o.destroy(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(h.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(0),l=n(61),u=n(84),c=n(64),h=n(158),f=n(235),d=n(236),p=n(415),v=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),g=function(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["Radio button with index "," doesn't exist."],["Radio button with index "," doesn't exist."]);e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.id=n.id,i.name=n.name,i.buildOperatorsElement(),i}return i(e,t),v(e,[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,o,r,i,l){return Object(a.addClass)(n.parentNode,"htFiltersMenuOperators"),Object(s.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=[h.a,f.a];Object(s.arrayEach)(e,function(n){var o=new p.a(t.hot,{name:"operator",label:{htmlFor:n,textContent:Object(c.b)(n)},value:n,checked:n===e[0],id:n});o.addLocalHook("change",function(e){return t.onRadioInputChange(e)}),t.elements.push(o)})}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error(Object(l.a)(g,t));Object(s.arrayEach)(this.elements,function(e,n){e.setChecked(n===t)})}},{key:"getActiveOperationId",value:function(){var t=this.elements.find(function(t){return t instanceof p.a&&t.isChecked()});return t?t.getValue():h.a}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&Object(s.arrayEach)(this.elements,function(e){e.setChecked(e.getValue()===t)})}},{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.a,e=arguments[1];t===d.a&&(t=f.a),this.setCachedState(e,t)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(t){this.setState(t.realTarget.value)}}]),e}(u.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(1),s=n(65),l=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=new WeakMap;e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object(a.extend)(e.DEFAULTS,n)));return c.set(i,{}),i}return i(e,t),u(e,null,[{key:"DEFAULTS",get:function(){return Object(a.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),u(e,[{key:"build",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this);var t=c.get(this);t.input=this._element.firstChild;var n=document.createElement("label");n.textContent=this.options.label.textContent,n.htmlFor=this.options.label.htmlFor,t.label=n,this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=c.get(this);t.input.checked=this.options.checked,t.label.textContent=this.hot.getTranslatedPhrase(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){this.options.checked=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],this.update()}},{key:"focus",value:function(){this.isBuilt()&&c.get(this).input.focus()}}]),e}(s.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(11),l=n(0),u=n(18),c=n(3),h=n(63),f=n(84),d=n(417),p=n(157),v=n(10),g=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.id=n.id,i.name=n.name,i.elements.push(new d.a(i.hot)),i.registerHooks(),i}return i(e,t),y(e,[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})}},{key:"setState",value:function(t){if(this.reset(),t&&t.command.key===p.a){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0])}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?p.b:p.a},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){var e=this,n=function(t,n,o,r,i){var a=Object(l.arrayFilter)(n,function(t){return t.name===p.a}),s=g(a,1),u=s[0],f={},d=e.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS);if(u){var y=Object(l.arrayMap)(r(t,i),function(t){return t.value});y=Object(h.d)(y),o&&(u.args[0]=o);var m=[],b=Object(h.b)(y,u.args[0],d,function(t){t.checked&&m.push(t.value)});f.args=[m],f.command=Object(v.b)(p.a),f.itemsSnapshot=b}else f.args=[],f.command=Object(v.b)(p.b);e.setCachedState(t,f)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof d.a})[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,o,r,i,s){Object(a.addClass)(n.parentNode,"htFiltersMenuValue");var u=document.createElement("div");return Object(a.addClass)(u,"htFiltersMenuLabel"),u.textContent=s,n.appendChild(u),Object(l.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS),n=Object(h.d)(this._getColumnVisibleValues()),o=Object(h.b)(n,n,t);this.getMultipleSelectElement().setItems(o),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(t){Object(u.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(s.stopImmediatePropagation)(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=t&&t.visualIndex;return Object(l.arrayMap)(this.hot.getDataAtCol(e),function(t){return Object(h.c)(t)})}}]),e}(f.a)},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){var n=Object(b.a)(e);return Object(h.arrayMap)(t,function(t){return t.checked=n(t.value),t})}function l(t){var e=[];return Object(h.arrayEach)(t,function(t){t.checked&&e.push(t.value)}),e}var u=n(2),c=n(1),h=n(0),f=n(18),d=n(34),p=n(3),v=n(11),g=n(65),y=n(159),m=n(418),b=n(63),w=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},O=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),C=new WeakMap;e.a=function(t){function e(t,n){r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object(c.extend)(e.DEFAULTS,n)));return C.set(o,{}),o.searchInput=new y.a(o.hot,{placeholder:p.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new m.a(o.hot,{textContent:p.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),o.clearAllUI=new m.a(o.hot,{textContent:p.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return a(e,t),O(e,null,[{key:"DEFAULTS",get:function(){return Object(c.clone)({className:"htUIMultipleSelect",value:[]})}}]),O(e,[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)}),this.searchInput.addLocalHook("input",function(e){return t.onInput(e)}),this.selectAllUI.addLocalHook("click",function(e){return t.onSelectAllClick(e)}),this.clearAllUI.addLocalHook("click",function(e){return t.onClearAllClick(e)})}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return[].concat(o(this.items))}},{key:"getValue",value:function(){return l(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;w(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this);var n=document.createElement("div"),o=new g.a(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(n);var r=function(e){t._element&&(t.itemsBox&&t.itemsBox.destroy(),Object(u.addClass)(e,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(e,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,o,r,i){t.title=i.instance.getDataAtRowProp(e,i.label.property)},autoWrapCol:!0,colWidths:150,height:110,width:168,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(e){return t.onItemsBoxBeforeKeyDown(e)}}),t.itemsBox.init())};r(n),setTimeout(function(){return r(n)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(s(this.items,this.options.value)),w(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,w(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e=t.target.value.toLowerCase(),n=void 0;n=""===e?[].concat(o(this.items)):Object(h.arrayFilter)(this.items,function(t){return(t.value+"").toLowerCase().indexOf(e)>=0}),this.itemsBox.loadData(n)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this),Object(d.partial)(f.isKey,t.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Object(v.stopImmediatePropagation)(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(t){var e=Object(d.partial)(f.isKey,t.keyCode);e("ESCAPE")&&this.runLocalHooks("keydown",t,this),e("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(Object(v.stopImmediatePropagation)(t),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(t){t.preventDefault(),Object(h.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!0}),this.itemsBox.render()}},{key:"onClearAllClick",value:function(t){t.preventDefault(),Object(h.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!1}),this.itemsBox.render()}}]),e}(g.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(1),s=n(65),l=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=new WeakMap;e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object(a.extend)(e.DEFAULTS,n)));return c.set(i,{}),i}return i(e,t),u(e,null,[{key:"DEFAULTS",get:function(){return Object(a.clone)({href:"#",tagName:"a"})}}]),u(e,[{key:"build",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),c.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(c.get(this).link.textContent=this.hot.getTranslatedPhrase(this.options.textContent))}}]),e}(s.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(0),l=n(3),u=n(84),c=n(159),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.id=n.id,i.name=n.name,i.elements.push(new c.a(i.hot,{type:"button",value:l.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:e.BUTTON_OK})),i.elements.push(new c.a(i.hot,{type:"button",value:l.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:e.BUTTON_CANCEL})),i.registerHooks(),i}return i(e,t),h(e,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),h(e,[{key:"registerHooks",value:function(){var t=this;Object(s.arrayEach)(this.elements,function(e){e.addLocalHook("click",function(e,n){return t.onButtonClick(e,n)})})}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,o,r,i,l){return Object(a.addClass)(n.parentNode,"htFiltersMenuActionBar"),Object(s.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,n){n.options.identifier===e.BUTTON_OK?this.accept():this.cancel()}}]),e}(u.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(1),a=n(34),s=n(21),l=n(237),u=n(238),c=n(63),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return[]};o(this,t),this.conditionCollection=e,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(t){return n._onConditionBeforeModify(t)}),this.conditionCollection.addLocalHook("afterAdd",function(t){return n.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("afterClear",function(t){return n.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return h(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,Object(r.arrayEach)(this.changes,function(e){t.updateStatesAtColumn(e)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));var o=this.conditionCollection.exportAllConditions(),i=this.conditionCollection.orderStack.indexOf(t);-1===i&&(i=this.latestEditedColumnPosition);var s=o.slice(0,i),h=o.slice(i);h.length&&h[0].column===t&&h.shift();var f=Object(a.curry)(function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=new l.a;t=[].concat(t,o),i.importAllConditions(t);var a=n.columnDataFactory(e),s=void 0;s=i.isEmpty()?a:new u.a(i,function(t){return n.columnDataFactory(t)}).filter(),s=Object(r.arrayMap)(s,function(t){return t.meta.visualRow});var h=Object(c.a)(s);return Object(r.arrayFilter)(a,function(t){return h(t.meta.visualRow)})})(s);this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:[].concat(this.conditionCollection.getConditions(t))},dependentConditionStacks:h,filteredRowsFactory:f,conditionArgsChange:e})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var t=this;Object(r.arrayEach)(this.latestOrderStack,function(e){t.updateStatesAtColumn(e)})}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),Object(i.objectEach)(this,function(e,n){t[n]=null})}}]),t}();Object(i.mixin)(f,s.a),e.a=f},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=n(1),u=n(8),c=n(6),h=n(36),f=n(423),d=n(432),p=n(433),v=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),y=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},m=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new u.a(n),n.dataProvider=new d.a(n.hot),n.sheet=new f.a(n.hot,n.dataProvider),n.undoRedoSnapshot=new p.a(n.sheet),n._skipRendering=!1,n}return i(e,t),g(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().formulas;Object(l.isObject)(n)&&Object(l.isObject)(n.variables)&&Object(l.objectEach)(n.variables,function(e,n){return t.setVariable(n,e)}),this.addHook("afterColumnSort",function(){return t.onAfterColumnSort.apply(t,arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell.apply(t,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell.apply(t,arguments)}),this.addHook("beforeColumnSort",function(){return t.onBeforeColumnSort.apply(t,arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol.apply(t,arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow.apply(t,arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol.apply(t,arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow.apply(t,arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate.apply(t,arguments)}),this.addHook("beforeValueRender",function(){return t.onBeforeValueRender.apply(t,arguments)}),this.addHook("modifyData",function(){return t.onModifyData.apply(t,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return t.onSheetAfterRecalculate.apply(t,arguments)}),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(t,e){var n=this.sheet.getCellAt(t,e);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(t,e){return null!==this.sheet.getCellAt(t,e)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(t,e){this.sheet.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.sheet.getVariable(t)}},{key:"onSheetAfterRecalculate",value:function(t,e){if(this._skipRendering)return void(this._skipRendering=!1);var n=this.hot;Object(s.arrayEach)(t,function(t){var e=t.row,o=t.column;n.validateCell(n.getDataAtCell(e,o),n.getCellMeta(e,o),function(){})}),n.render()}},{key:"onModifyData",value:function(t,e,n,o){"get"===o&&this.hasComputedCellValue(t,e)?n.value=this.getCellValue(t,e):"set"===o&&Object(h.b)(n.value)&&(n.value=Object(h.d)(n.value))}},{key:"onBeforeValueRender",value:function(t){return Object(h.c)(t)&&(t=Object(h.e)(t)),t}},{key:"onBeforeValidate",value:function(t,e,n,o){var r=this.hot.propToCol(n);return this.hasComputedCellValue(e,r)&&(t=this.getCellValue(e,r)),t}},{key:"onAfterSetDataAtCell",value:function(t,e){var n=this;"loadData"!==e&&(this.dataProvider.clearChanges(),Object(s.arrayEach)(t,function(t){var e=v(t,4),o=e[0],r=e[1],i=e[2],a=e[3];r=n.hot.propToCol(r),o=n.t.toPhysicalRow(o),Object(h.b)(a)&&(a=Object(h.d)(a)),n.dataProvider.collectChanges(o,r,a),i!==a&&n.sheet.applyChanges(o,r,a)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_row",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(t,e){this.undoRedoSnapshot.save("row",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_row",t,e)}},{key:"onBeforeCreateCol",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_column",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(t,e){this.undoRedoSnapshot.save("column",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_column",t,e)}},{key:"onBeforeColumnSort",value:function(t,e){this.sheet.alterManager.prepareAlter("column_sorting",t,e)}},{key:"onAfterColumnSort",value:function(t,e){this.sheet.alterManager.triggerAlter("column_sorting",t,e)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(c.d)("formulas",m)},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(66),a=(n.n(i),n(0)),s=(n(4),n(21)),l=n(53),u=n(1),c=n(44),h=n(424),f=n(36),d=n(425),p=n(426),v=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),g=3,y=function(){function t(e,n){var o=this;r(this,t),this.hot=e,this.t=Object(l.a)(this.hot),this.dataProvider=n,this.parser=new i.Parser,this.matrix=new d.a(this.t),this.alterManager=new p.a(this),this._processingCell=null,this._state=g,this.parser.on("callCellValue",function(){return o._onCallCellValue.apply(o,arguments)}),this.parser.on("callRangeValue",function(){return o._onCallRangeValue.apply(o,arguments)}),this.alterManager.addLocalHook("afterAlter",function(){return o._onAfterAlter.apply(o,arguments)})}return v(t,[{key:"recalculate",value:function(){switch(this._state){case g:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var t=this,e=this.matrix.getOutOfDateCells();Object(a.arrayEach)(e,function(e){var n=t.dataProvider.getSourceDataAtCell(e.row,e.column);Object(f.b)(n)&&t.parseExpression(e,n.substr(1))}),this._state=1,this.runLocalHooks("afterRecalculate",e,"optimized")}},{key:"recalculateFull",value:function(){var t=this,e=this.dataProvider.getSourceDataByRange();this.matrix.reset(),Object(a.arrayEach)(e,function(e,n){Object(a.arrayEach)(e,function(e,o){Object(f.b)(e)&&t.parseExpression(new c.a(n,o),e.substr(1))})}),this._state=1,this.runLocalHooks("afterRecalculate",e,"full")}},{key:"setVariable",value:function(t,e){this.parser.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.parser.getVariable(t)}},{key:"applyChanges",value:function(t,e,n){this.matrix.remove({row:t,column:e}),Object(f.b)(n)&&this.parseExpression(new c.a(t,e),n.substr(1));var r=this.getCellDependencies.apply(this,o(this.t.toVisual(t,e)));Object(a.arrayEach)(r,function(t){t.setState(c.a.STATE_OUT_OFF_DATE)}),this._state=2}},{key:"parseExpression",value:function(t,e){t.setState(c.a.STATE_COMPUTING),this._processingCell=t;var n=this.parser.parse(Object(f.d)(e)),o=n.error,r=n.result;Object(f.b)(r)?this.parseExpression(t,r.substr(1)):(t.setValue(r),t.setError(o),t.setState(c.a.STATE_UP_TO_DATE)),this.matrix.add(t),this._processingCell=null}},{key:"getCellAt",value:function(t,e){return this.matrix.getCellAt(t,e)}},{key:"getCellDependencies",value:function(t,e){return this.matrix.getDependencies({row:t,column:e})}},{key:"_onCallCellValue",value:function(t,e){var n=t.row,o=t.column,r=new h.a(n,o);if(!this.dataProvider.isInDataRange(r.row,r.column))throw Error(i.ERROR_REF);this.matrix.registerCellRef(r),this._processingCell.addPrecedent(r);var a=this.dataProvider.getRawDataAtCell(n.index,o.index);if(Object(i.error)(a)){var s=this.matrix.getCellAt(n.index,o.index);if(s&&s.hasError())throw Error(a)}if(Object(f.b)(a)){var l=this.parser.parse(a.substr(1)),u=l.error,c=l.result;if(u)throw Error(u);e(c)}else e(a)}},{key:"_onCallRangeValue",value:function(t,e,n){var o=t.row,r=t.column,s=this,l=e.row,u=e.column,c=this.dataProvider.getRawDataByRange(o.index,r.index,l.index,u.index),d=function(t,e){return Object(a.arrayMap)(t,function(t,n){var a=o.index+e,l=r.index+n,u=new h.a(a,l);if(!s.dataProvider.isInDataRange(u.row,u.column))throw Error(i.ERROR_REF);if(s.matrix.registerCellRef(u),s._processingCell.addPrecedent(u),Object(i.error)(t)){var c=s.matrix.getCellAt(u.row,u.column);if(c&&c.hasError())throw Error(t)}if(Object(f.b)(t)){var d=s.parser.parse(t.substr(1)),p=d.error,v=d.result;if(p)throw Error(p);t=v}return t})};n(Object(a.arrayMap)(c,function(t,e){return d(t,e)}))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}]),t}();Object(u.mixin)(y,s.a),e.a=y},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(66),s=(n.n(a),n(239)),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),l(e,[{key:"toString",value:function(){return Object(a.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),e}(s.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=n(44),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.t=e,this.data=[],this.cellReferences=[]}return a(t,[{key:"getCellAt",value:function(t,e){var n=null;return Object(r.arrayEach)(this.data,function(o){if(o.row===t&&o.column===e)return n=o,!1}),n}},{key:"getOutOfDateCells",value:function(){return Object(r.arrayFilter)(this.data,function(t){return t.isState(i.a.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(t){Object(r.arrayFilter)(this.data,function(e){return e.isEqual(t)}).length||this.data.push(t)}},{key:"remove",value:function(t){var e=Array.isArray(t),n=function(t,n){var o=!1;return e?Object(r.arrayEach)(n,function(e){if(t.isEqual(e))return o=!0,!1}):o=t.isEqual(n),o};this.data=Object(r.arrayFilter)(this.data,function(e){return!n(e,t)})}},{key:"getDependencies",value:function(t){var e=this,n=function(t){return Object(r.arrayReduce)(e.data,function(e,n){return n.hasPrecedent(t)&&-1===e.indexOf(n)&&e.push(n),e},[])};return function t(o){var i=n(o);return i.length&&Object(r.arrayEach)(i,function(n){n.hasPrecedents()&&(i=i.concat(t(e.t.toVisual(n))))}),i}(t)}},{key:"registerCellRef",value:function(t){Object(r.arrayFilter)(this.cellReferences,function(e){return e.isEqual(t)}).length||this.cellReferences.push(t)}},{key:"removeCellRefsAtRange",value:function(t,e){var n=t.row,o=t.column,i=e.row,a=e.column,s=[],l=function(t){return void 0===n||t.row>=n&&t.row<=i},u=function(t){return void 0===o||t.column>=o&&t.column<=a};return this.cellReferences=Object(r.arrayFilter)(this.cellReferences,function(t){return!l(t)||!u(t)||(s.push(t),!1)}),s}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){d.has(t)||d.set(t,{prepare:e.prepare||v,operate:e.operate||v})}var i=(n(0),n(1)),a=n(21),s=n(427),l=n(428),u=n(429),c=n(430),h=n(431),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),d=new Map;r(s.OPERATION_NAME,s),r(l.OPERATION_NAME,l),r(u.OPERATION_NAME,u),r(c.OPERATION_NAME,c),r(h.OPERATION_NAME,h);var p=function(){function t(e){o(this,t),this.sheet=e,this.hot=e.hot,this.dataProvider=e.dataProvider,this.matrix=e.matrix}return f(t,[{key:"prepareAlter",value:function(t){if(!d.has(t))throw Error('Alter operation "'+t+'" not exist.');for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];d.get(t).prepare.apply(this,n)}},{key:"triggerAlter",value:function(t){if(!d.has(t))throw Error('Alter operation "'+t+'" not exist.');for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];d.get(t).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}]),t}();Object(i.mixin)(p,a.a),e.a=p;var v=function(){}},function(t,e,n){"use strict";function o(){var t=this.matrix,e=this.dataProvider;c=new WeakMap,Object(i.arrayEach)(t.data,function(t){c.set(t,e.t.toVisualRow(t.row))})}function r(){var t=this.matrix,e=this.dataProvider;t.cellReferences.length=0,Object(i.arrayEach)(t.data,function(t){t.setState(s.a.STATE_OUT_OFF_DATE),t.clearPrecedents();var n=t.row,o=t.column,r=e.getSourceDataAtCell(n,o);if(Object(a.b)(r)){var i=c.get(t),u=new l.a(r);u.translate({row:e.t.toVisualRow(n)-i}),e.updateSourceData(n,o,u.toString())}}),c=null}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"OPERATION_NAME",function(){return u}),e.prepare=o,e.operate=r;var i=n(0),a=n(36),s=n(44),l=n(67),u="column_sorting",c=void 0},function(t,e,n){"use strict";function o(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.matrix,u=this.dataProvider,c=[0,e];Object(i.arrayEach)(o.cellReferences,function(e){e.column>=t&&e.translateTo.apply(e,c)}),Object(i.arrayEach)(o.data,function(o){var i=o.row,h=o.column;if(o.column>=t&&(o.translateTo.apply(o,c),o.setState(s.a.STATE_OUT_OFF_DATE)),n){var f=o.row,d=o.column,p=u.getSourceDataAtCell(f,d);if(Object(a.b)(p)){var v=Object(a.a)("column",t),g=new l.a(p);g.useCustomModifier(r),g.translate({column:e},v({row:i,column:h})),u.updateSourceData(f,d,g.toString())}}})}function r(t,e,n,o){var r=t.start,i=t.end,a=r[e].index,s=i[e].index,l=n,u=n;return o>a&&(l=0),o>s&&(u=0),[l,u,!1]}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"OPERATION_NAME",function(){return u}),e.operate=o;var i=n(0),a=n(36),s=n(44),l=n(67),u="insert_column"},function(t,e,n){"use strict";function o(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.matrix,u=this.dataProvider,c=[e,0];Object(i.arrayEach)(o.cellReferences,function(e){e.row>=t&&e.translateTo.apply(e,c)}),Object(i.arrayEach)(o.data,function(o){var i=o.row,h=o.column;if(o.row>=t&&(o.translateTo.apply(o,c),o.setState(s.a.STATE_OUT_OFF_DATE)),n){var f=o.row,d=o.column,p=u.getSourceDataAtCell(f,d);if(Object(a.b)(p)){var v=Object(a.a)("row",t),g=new l.a(p);g.useCustomModifier(r),g.translate({row:e},v({row:i,column:h})),u.updateSourceData(f,d,g.toString())}}})}function r(t,e,n,o){var r=t.start,i=t.end,a=r[e].index,s=i[e].index,l=n,u=n;return o>a&&(l=0),o>s&&(u=0),[l,u,!1]}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"OPERATION_NAME",function(){return u}),e.operate=o;var i=n(0),a=n(36),s=n(44),l=n(67),u="insert_row"},function(t,e,n){"use strict";function o(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=-e;var o=this.matrix,u=this.dataProvider,c=this.sheet,h=[0,e],f=Math.abs(e)-1,d=o.removeCellRefsAtRange({column:t},{column:t+f}),p=[];Object(i.arrayEach)(o.data,function(e){Object(i.arrayEach)(d,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(s.a.STATE_OUT_OFF_DATE),Object(i.arrayEach)(c.getCellDependencies(e.row,e.column),function(t){t.setState(s.a.STATE_OUT_OFF_DATE)}))}),e.column>=t&&e.column<=t+f&&p.push(e)}),o.remove(p),Object(i.arrayEach)(o.cellReferences,function(e){e.column>=t&&e.translateTo.apply(e,h)}),Object(i.arrayEach)(o.data,function(o){var i=o.row,c=o.column;if(o.column>=t&&(o.translateTo.apply(o,h),o.setState(s.a.STATE_OUT_OFF_DATE)),n){var f=o.row,d=o.column,p=u.getSourceDataAtCell(f,d);if(Object(a.b)(p)){var v=Object(a.a)("column",t),g=new l.a(p);g.useCustomModifier(r),g.translate({column:e},v({row:i,column:c})),u.updateSourceData(f,d,g.toString())}}})}function r(t,e,n,o){var r=t.start,i=t.end,a=t.type,s=r[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,h=n,f=!1;return s>=o&&l<=o+u&&(f=!0),f||"cell"!==a||o>=s&&(c=0,h=0),f||"range"!==a||(o>=s&&(c=0),o>l?h=0:l<=o+u&&(h-=Math.min(l-(o+u),0))),s+c<0&&(c-=s+c),[c,h,f]}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"OPERATION_NAME",function(){return u}),e.operate=o;var i=n(0),a=n(36),s=n(44),l=n(67),u="remove_column"},function(t,e,n){"use strict";function o(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=-e;var o=this.matrix,u=this.dataProvider,c=this.sheet,h=[e,0],f=Math.abs(e)-1,d=o.removeCellRefsAtRange({row:t},{row:t+f}),p=[];Object(i.arrayEach)(o.data,function(e){Object(i.arrayEach)(d,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(s.a.STATE_OUT_OFF_DATE),Object(i.arrayEach)(c.getCellDependencies(e.row,e.column),function(t){t.setState(s.a.STATE_OUT_OFF_DATE)}))}),e.row>=t&&e.row<=t+f&&p.push(e)}),o.remove(p),Object(i.arrayEach)(o.cellReferences,function(e){e.row>=t&&e.translateTo.apply(e,h)}),Object(i.arrayEach)(o.data,function(o){var i=o.row,c=o.column;if(o.row>=t&&(o.translateTo.apply(o,h),o.setState(s.a.STATE_OUT_OFF_DATE)),n){var f=o.row,d=o.column,p=u.getSourceDataAtCell(f,d);if(Object(a.b)(p)){var v=Object(a.a)("row",t),g=new l.a(p);g.useCustomModifier(r),g.translate({row:e},v({row:i,column:c})),u.updateSourceData(f,d,g.toString())}}})}function r(t,e,n,o){var r=t.start,i=t.end,a=t.type,s=r[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,h=n,f=!1;return s>=o&&l<=o+u&&(f=!0),f||"cell"!==a||o>=s&&(c=0,h=0),f||"range"!==a||(o>=s&&(c=0),o>l?h=0:l<=o+u&&(h-=Math.min(l-(o+u),0))),s+c<0&&(c-=s+c),[c,h,f]}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"OPERATION_NAME",function(){return u}),e.operate=o;var i=n(0),a=n(36),s=n(44),l=n(67),u="remove_row"},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),a=n(4),s=n(1),l=n(53),u=(n(36),function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){r(this,t),this.hot=e,this.changes={},this.t=Object(l.a)(this.hot)}return c(t,[{key:"collectChanges",value:function(t,e,n){this.changes[this._coordId(t,e)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(t,e){return t>=0&&t<this.hot.countRows()&&e>=0&&e<this.hot.countCols()}},{key:"getDataAtCell",value:function(t,e){var n=this._coordId.apply(this,o(this.t.toPhysical(t,e)));return Object(s.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(t,e)}},{key:"getDataByRange",value:function(t,e,n,r){var a=this,l=this.hot.getData(t,e,n,r);return Object(i.arrayEach)(l,function(n,r){Object(i.arrayEach)(n,function(n,i){var u=a._coordId.apply(a,o(a.t.toPhysical(r+t,i+e)));Object(s.hasOwnProperty)(a.changes,u)&&(l[r][i]=a.changes[u])})}),l}},{key:"getSourceDataAtCell",value:function(t,e){var n=this._coordId(t,e);return Object(s.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(t,e)}},{key:"getSourceDataByRange",value:function(t,e,n,o){return this.hot.getSourceDataArray(t,e,n,o)}},{key:"getRawDataAtCell",value:function(t,e){return this.getSourceDataAtCell.apply(this,o(this.t.toPhysical(t,e)))}},{key:"getRawDataByRange",value:function(t,e,n,o){var r=this,i=[];return Object(a.rangeEach)(t,n,function(t){var n=[];Object(a.rangeEach)(e,o,function(e){var o=r.t.toPhysical(t,e),i=u(o,2),a=i[0],l=i[1],c=r._coordId(a,l);n.push(Object(s.hasOwnProperty)(r.changes,c)?r.changes[c]:r.getSourceDataAtCell(a,l))}),i.push(n)}),i}},{key:"updateSourceData",value:function(t,e,n){this.hot.getSourceData()[t][this.hot.colToProp(e)]=n}},{key:"_coordId",value:function(t,e){return t+":"+e}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),i=(n(4),n(434)),a=n(44),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.sheet=e,this.stack=new i.a}return s(t,[{key:"save",value:function(t,e,n){var o=this.sheet,i=o.matrix,a=o.dataProvider,s=[];Object(r.arrayEach)(i.data,function(o){var r=o.row,i=o.column;if(o[t]<e||o[t]>e+(n-1)){var l=a.getSourceDataAtCell(r,i);s.push({row:r,column:i,value:l})}}),this.stack.push({axis:t,index:e,amount:n,changes:s})}},{key:"restore",value:function(){var t=this.sheet,e=t.matrix,n=t.dataProvider,o=this.stack.pop(),i=o.axis,s=o.index,l=o.amount,u=o.changes;u&&Object(r.arrayEach)(u,function(t){t[i]>s+(l-1)&&(t[i]-=l);var o=t.row,r=t.column,u=t.value;n.getSourceDataAtCell(o,r)!==u&&(n.updateSourceData(o,r,u),e.getCellAt(o,r).setState(a.a.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];o(this,t),this.items=e}return r(t,[{key:"push",value:function(){var t;(t=this.items).push.apply(t,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(1),l=n(81),u=n(6),c=n(7),h=n(240),f=n(436),d=n(241),p=n(437),v=(n.n(p),function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),g=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),y=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},m=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings={},n.dateCalculator=null,n.currentYear=null,n.monthList=[],n.monthHeadersArray=[],n.weekHeadersArray=[],n.rangeBars={},n.rangeList={},n.nestedHeadersPlugin=null,n.hotSource=null,n.overallWeekSectionCount=null,n.initialSettings=null,n.dataFeed=null,n.colorData={},n.rangeBarMeta=Object.create(null),n}return i(e,t),g(e,[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new h.a(this.currentYear,this.settings.allowSplitWeeks),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return t.onAfterInit()}),Object(a.addClass)(this.hot.rootElement,"ganttChart"),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),Object(a.removeClass)(this.hot.rootElement,"ganttChart"),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var t=this.settings.dataSource;t.instance?this.loadData(t.instance,t.startDateColumn,t.endDateColumn,t.additionalData,t.asyncUpdates):this.loadData(t)}}},{key:"loadData",value:function(t,e,n,o,r){t.length>1&&this.hot.alter("insert_row",0,t.length-1,this.pluginName+".loadData"),this.dataFeed=new f.a(this.hot,t,e,n,o,r),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(t){return this.rangeList[t]}},{key:"generateHeaderSet",value:function(t){var e=this,n=this.settings.weekHeaderGenerator,o=[];return Object(s.objectEach)(this.monthList,function(r,i){var a=r.daysBeforeFullWeeks>0?1:0,s=r.daysAfterFullWeeks>0?1:0,l=r.fullWeeks+(e.settings.allowSplitWeeks?a+s:0),u=parseInt(i,10),c=e.settings.allowSplitWeeks,h="";if("months"===t)o.push({label:r.name,colspan:l});else if("weeks"===t)for(var f=0;f<l;f++){var d=null,p=null;if(c||1!==r.fullWeeks){var g=e.getWeekColumnRange(r,u,f),y=v(g,2);d=y[0],p=y[1]}else{var m=e.getWeekColumnRange(r,u,f,!0),b=v(m,2);d=b[0],p=b[1]}h=d===p?d:d+" -  "+p,o.push(n?n.call(e,d,p):h),e.dateCalculator.addDaysToCache(u,o.length-1,d,p)}}),o}},{key:"getWeekColumnRange",value:function(t,e,n,o){var r=this.settings.allowSplitWeeks,i=t.daysBeforeFullWeeks>0?1:0,a=t.daysAfterFullWeeks>0?1:0,s=t.fullWeeks+(this.settings.allowSplitWeeks?i+a:0),l=null,u=null;return o?0===e?(u=this.monthList[e+1].daysBeforeFullWeeks,l=d.a-(d.b-u)+1):e===this.monthList.length-1?(u=d.b-this.monthList[e-1].daysAfterFullWeeks,l=this.monthList[e-1].days-this.monthList[e-1].daysAfterFullWeeks+1):(u=this.monthList[e+1].daysBeforeFullWeeks,l=this.monthList[e-1].days-(d.b-u)+1):r&&i&&0===n?(l=n+1,u=t.daysBeforeFullWeeks):r&&a&&n===s-1?(l=t.days-t.daysAfterFullWeeks+1,u=t.days):(l=null,l=r?t.daysBeforeFullWeeks+(n-i)*d.b+1:t.daysBeforeFullWeeks+n*d.b+1,u=l+d.b-1),[l,u]}},{key:"generateMonthHeaders",value:function(){return this.generateHeaderSet("months")}},{key:"generateWeekHeaders",value:function(){return this.generateHeaderSet("weeks")}},{key:"generateDayHeaders",value:function(){return this.generateHeaderSet("days")}},{key:"assignGanttSettings",value:function(){var t=this;this.initialSettings=Object(s.deepClone)(this.hot.getSettings());var e={data:Object(l.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(e,n,o,r,i,a,s){return t.uniformBackgroundRenderer(e,n,o,r,i,a,s)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(e),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(t,e,n,o){this.rangeBarMeta[t]||(this.rangeBarMeta[t]={}),this.rangeBarMeta[t][e]||(this.rangeBarMeta[t][e]={}),this.rangeBarMeta[t][e][n]=o}},{key:"applyRangeBarMetaCache",value:function(){var t=this;Object(s.objectEach)(this.rangeBarMeta,function(e,n){Object(s.objectEach)(e,function(e,o){Object(s.objectEach)(e,function(e,r){t.hot.setCellMeta(n,o,r,e)})})})}},{key:"addRangeBar",value:function(t,e,n,o){var r=this,i=this.dateCalculator.dateToColumn(e),a=this.dateCalculator.dateToColumn(n);return!(!this.dateCalculator.isValidRangeBarData(e,n)||null==i||null==a)&&(this.rangeBars[t]||(this.rangeBars[t]={}),this.rangeBars[t][i]={barLength:a-i+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(e)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},Object(s.objectEach)(o,function(e,n){r.rangeBars[t][i].additionalData[n]=e}),this.colorData[t]&&(this.rangeBars[t][i].colors=this.colorData[t]),this.rangeList[t]=[t,i],this.renderRangeBar(t,i,a,o),[t,i])}},{key:"getRangeBarData",value:function(t,e){var n=this.getRangeBarCoordinates(t);if(!n)return!1;var o=this.rangeBars[n[0]][n[1]];return!(!o||t!==n[0]||!(e===n[1]||e>n[1]&&e<n[1]+o.barLength))&&o}},{key:"updateRangeBarData",value:function(t,e,n){var o=this.getRangeBarData(t,e);Object(s.objectEach)(n,function(t,e){o[e]!==t&&(o[e]=t)})}},{key:"renderRangeBar",value:function(t,e,n,o){for(var r=this.rangeBars[t][e],i=e;i<=n;i++){var a=this.hot.getCellMeta(t,i),s=(a.className||"")+" rangeBar";(i===e&&r.partialStart||i===n&&r.partialEnd)&&(s+=" partial"),i===n&&(s+=" last"),this.hot.setCellMeta(t,i,"originalClassName",a.className),this.hot.setCellMeta(t,i,"className",s),this.hot.setCellMeta(t,i,"additionalData",r.additionalData),this.cacheRangeBarMeta(t,i,"originalClassName",a.className),this.cacheRangeBarMeta(t,i,"className",s),this.cacheRangeBarMeta(t,i,"additionalData",r.additionalData)}}},{key:"removeRangeBarByDate",value:function(t,e){this.removeRangeBarByColumn(t,this.dateCalculator.dateToColumn(e))}},{key:"removeRangeBarByColumn",value:function(t,e){var n=this,o=this.rangeBars[t][e];o&&(this.unrenderRangeBar(t,e,e+o.barLength-1),this.rangeBars[t][e]=null,Object(s.objectEach)(this.rangeList,function(o,r){r=parseInt(r,10),JSON.stringify(o)===JSON.stringify([t,e])&&(n.rangeList[r]=null)}))}},{key:"removeAllRangeBars",value:function(){var t=this;Object(s.objectEach)(this.rangeBars,function(e,n){Object(s.objectEach)(e,function(e,o){t.removeRangeBarByColumn(n,o)})})}},{key:"unrenderRangeBar",value:function(t,e,n){for(var o=e;o<=n;o++){var r=this.hot.getCellMeta(t,o);this.hot.setCellMeta(t,o,"className",r.originalClassName),this.hot.setCellMeta(t,o,"originalClassName",void 0),this.cacheRangeBarMeta(t,o,"className",r.originalClassName),this.cacheRangeBarMeta(t,o,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(t,e,n,o,r,i,a){var l=this.getRangeBarData(n,o),u=this.getRangeBarCoordinates(n);a.className&&(e.className=a.className);var c="";Object(s.objectEach)(a.additionalData,function(t,e){c+=e+": "+t+"\n"}),c=c.replace(/\n$/,""),e.title=c,e.style.background=l&&l.colors?o===u[1]&&l.partialStart||o===u[1]+l.barLength-1&&l.partialEnd?l.colors[1]:l.colors[0]:""}},{key:"setRangeBarColors",value:function(t){var e=this;this.colorData=t,Object(s.objectEach)(t,function(t,n){var o=e.getRangeBarCoordinates(n);o&&e.updateRangeBarData(o[0],o[1],{colors:t})}),this.hot.render()}},{key:"setYear",value:function(t){this.hot.updateSettings({ganttChart:Object(s.extend)(this.hot.getSettings().ganttChart,{startYear:t})})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){if(this.internalUpdateSettings)return void this.applyRangeBarMetaCache();y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(c.a);Object(u.d)("ganttChart",m)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(1),i=n(0),a=(n(240),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}());e.a=function(){function t(e,n,r,i,a,s){o(this,t),this.data=n,this.chartInstance=e,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(n,r,i,a,s||!1)}return a(t,[{key:"applyData",value:function(t,e,n,o,r){"[object Array]"===Object.prototype.toString.call(t)?this.loadData(t):t.guid&&this.bindWithHotInstance(t,e,n,o,r)}},{key:"bindWithHotInstance",value:function(t,e,n,o,r){this.hotSource={instance:t,startColumn:e,endColumn:n,additionalData:o,asyncUpdates:r},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(t){var e=this;if(!this.hotSource.asyncUpdates)return void t.call(this);this.asyncStart(),setTimeout(function(){t.call(e),e.asyncEnd()},0)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var t=this;this.sourceHooks={afterLoadData:function(e){return t.onAfterSourceLoadData(e)},afterChange:function(e,n){return t.onAfterSourceChange(e,n)},afterColumnSort:function(e,n){return t.onAfterColumnSort(e,n)}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(t){this.sourceHooks.afterLoadData&&t.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&t.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&t.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(t){var e={},n=this.hotSource,o=void 0,i=[];void 0===t?o=n.instance.getData(0,0,n.instance.countRows()-1,n.instance.countCols()-1):(o=[],o[t]=n.instance.getDataAtRow(t));for(var a=t||0,s=o.length;a<(t?t+1:s);a++)!function(t,a){e={};var s=o[t];if(null===s[n.startColumn]||""===s[n.startColumn])return"continue";Object(r.objectEach)(n.additionalData,function(t,n){e[n]=s[t]}),i.push([t,s[n.startColumn],s[n.endColumn],e,t])}(a);return i}},{key:"updateFromSource",value:function(t){var e=this,n=this.getDataFromSource(t);!t&&isNaN(t)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),Object(i.arrayEach)(n,function(t){t=e.trimRangeIfNeeded(t),e.chartPlugin.addRangeBar.apply(e.chartPlugin,t)})}},{key:"loadData",value:function(t){var e=this;Object(i.arrayEach)(t,function(t,n){t=e.trimRangeIfNeeded(t),e.chartPlugin.addRangeBar(n,t.startDate,t.endDate,t.additionalData)})}},{key:"trimRangeIfNeeded",value:function(t){var e=null;e=t[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"};var n=new Date(t[e.startDate]),o=new Date(t[e.endDate]);if("string"==typeof n||"string"==typeof o)return!1;var r=n.getFullYear(),i=o.getFullYear();return r<this.chartPlugin.currentYear&&i>=this.chartPlugin.currentYear&&(t[e.startDate]="01/01/"+this.chartPlugin.currentYear),i>this.chartPlugin.currentYear&&r<=this.chartPlugin.currentYear&&(t[e.endDate]="12/31/"+this.chartPlugin.currentYear),t}},{key:"onAfterSourceChange",value:function(t,e){var n=this;this.asyncCall(function(){if(t){for(var e={},o=0,i=t.length;o<i;o++){var a=t[o],s=parseInt(a[0],10),l=parseInt(a[1],10);e[s]||(e[s]={}),e[s][l]=[a[2],a[3]]}Object(r.objectEach)(e,function(t,e){e=parseInt(e,10),n.chartPlugin.getRangeBarCoordinates(e)&&n.chartPlugin.removeRangeBarByColumn(e,n.chartPlugin.rangeList[e][1]),n.updateFromSource(e)})}})}},{key:"onAfterSourceLoadData",value:function(t){var e=this;this.asyncCall(function(t){e.chartPlugin.removeAllRangeBars(),e.updateFromSource()})}},{key:"onAfterColumnSort",value:function(t,e){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars(),n.updateFromSource()})}}]),t}()},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(6),l=n(4),u=n(7),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},f=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings=null,n}return i(e,t),c(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetHeader(e,n)}),this.addHook("afterGetRowHeader",function(e,n){return t.onAfterGetHeader(e,n)}),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;Object(l.rangeEach)(0,t-1,function(t){var r=e.childNodes[t],i=n.childNodes[t],a=o?o.childNodes[t]:null;Object(l.rangeEach)(0,r.childNodes.length-1,function(t){r.childNodes[t].removeAttribute("title"),i&&i.childNodes[t]&&i.childNodes[t].removeAttribute("title"),o&&a&&a.childNodes[t]&&a.childNodes[t].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(t,e){var n=e.querySelector("span"),o="THEAD"===e.parentNode.parentNode.nodeName;(o&&this.settings.columns||!o&&this.settings.rows)&&(this.settings.onlyTrimmed?Object(a.outerWidth)(n)>=Object(a.outerWidth)(e)&&0!==Object(a.outerWidth)(n)&&e.setAttribute("title",n.textContent):e.setAttribute("title",n.textContent))}},{key:"destroy",value:function(){this.settings=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(u.a);Object(s.d)("headerTooltips",f)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(4),l=n(0),u=n(1),c=n(6),h=n(7),f=n(9),d=n(440),p=n(441),v=(n.n(p),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),g=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},y=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings=[],n.columnHeaderLevelCount=0,n.colspanArray=[],n.ghostTable=new d.a(n),n}return i(e,t),v(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(e){return t.onAfterGetColumnHeaderRenderers(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(e,n,o){return t.onAfterOnCellMouseDown(e,n,o)}),this.addHook("beforeOnCellMouseOver",function(e,n,o,r){return t.onBeforeOnCellMouseOver(e,n,o,r)}),this.addHook("afterViewportColumnCalculatorOverride",function(e){return t.onAfterViewportColumnCalculatorOverride(e)}),this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this),this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,r=0;r<t;r++){var i=e.childNodes[r];if(!i)break;for(var a=n.childNodes[r],s=o?o.childNodes[r]:null,l=0,u=i.childNodes.length;l<u;l++)i.childNodes[l].removeAttribute("colspan"),a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan"),o&&s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan")}}},{key:"checkForFixedColumnsCollision",value:function(){var t=this,e=this.hot.getSettings().fixedColumnsLeft;Object(l.arrayEach)(this.colspanArray,function(n,o){t.getNestedParent(o,e)!==e&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})}},{key:"checkForOverlappingHeaders",value:function(){var t=this;Object(l.arrayEach)(this.colspanArray,function(e,n){Object(l.arrayEach)(t.colspanArray[n],function(e,o){if(e.colspan>1){var r=t.levelToRowCoords(n),i=t.getChildHeaders(r,o);if(i.length>0){var a=0;return Object(l.arrayEach)(i,function(e,n){a+=t.getColspan(r+1,e)}),a>e.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1}}})})}},{key:"setupColspanArray",value:function(){function t(t,e){t[e]||(t[e]=[])}var e=this;Object(u.objectEach)(this.settings,function(n,o){Object(u.objectEach)(n,function(n,r,i){if(t(e.colspanArray,o),void 0===i[r].colspan)e.colspanArray[o].push({label:i[r]||"",colspan:1,hidden:!1});else{var a=i[r].colspan||1;e.colspanArray[o].push({label:i[r].label||"",colspan:a,hidden:!1}),e.fillColspanArrayWithDummies(a,o)}})})}},{key:"fillColspanArrayWithDummies",value:function(t,e){var n=this;Object(s.rangeEach)(0,t-2,function(t){n.colspanArray[e].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(t){var e=this;return function(n,o){if(o.removeAttribute("colspan"),Object(a.removeClass)(o,"hiddenHeader"),e.colspanArray[t][n]&&e.colspanArray[t][n].colspan){var r=e.colspanArray[t][n].colspan,i=e.hot.getSettings().fixedColumnsLeft||0,s=e.hot.view.wt.wtOverlays.topLeftCornerOverlay,l=e.hot.view.wt.wtOverlays.leftOverlay,u=!!s&&s.clone.wtTable.THEAD.contains(o),c=!!l&&l.clone.wtTable.THEAD.contains(o);r>1&&o.setAttribute("colspan",u||c?Math.min(r,i-n):r),(u||c&&n===i-1)&&Object(a.addClass)(o,"overlayEdge")}e.colspanArray[t][n]&&e.colspanArray[t][n].hidden&&Object(a.addClass)(o,"hiddenHeader"),Object(a.empty)(o);var h=document.createElement("DIV");Object(a.addClass)(h,"relative");var f=document.createElement("SPAN");Object(a.addClass)(f,"colHeader"),Object(a.fastInnerHTML)(f,e.colspanArray[t][n]?e.colspanArray[t][n].label||"":""),h.appendChild(f),o.appendChild(h),e.hot.runHooks("afterGetColHeader",n,o)}}},{key:"getColspan",value:function(t,e){var n=this.colspanArray[this.rowCoordsToLevel(t)][e];return n?n.colspan:1}},{key:"levelToRowCoords",value:function(t){return t-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(t){return t+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(t,e){if(t<0)return!1;var n=this.colspanArray[t][e]?this.colspanArray[t][e].colspan:1,o=!!this.colspanArray[t][e]&&this.colspanArray[t][e].hidden;if(n>1||1===n&&!1===o)return e;var r=e-1;do{if(this.colspanArray[t][r].colspan>1)break;r--}while(e>=0);return r}},{key:"getChildHeaders",value:function(t,e){var n=this.rowCoordsToLevel(t),o=this.colspanArray[n+1],r=this.getNestedParent(n,e),i=this.colspanArray[n][e].colspan,a=[];return o?(Object(s.rangeEach)(r,r+i-1,function(t){o[t]&&o[t].colspan>1&&(i-=o[t].colspan-1),o[t]&&!o[t].hidden&&-1===a.indexOf(t)&&a.push(t)}),a):a}},{key:"fillTheRemainingColspans",value:function(){var t=this;Object(u.objectEach)(this.settings,function(e,n){Object(s.rangeEach)(t.colspanArray[n].length-1,t.hot.countCols()-1,function(o){t.colspanArray[n].push({label:e[o]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var t=this,e=this.hot.getSelectedLast();if(void 0!==e){var n=this.hot.view.wt.wtOverlays,o=this.hot.selection.selectedHeader.cols,r=Math.min(e[1],e[3]),i=Math.max(e[1],e[3]),u=o?-1:this.columnHeaderLevelCount-1;Object(s.rangeEach)(r,i,function(e){for(var s=t.columnHeaderLevelCount-1;s>-1;s--)!function(s){var c=t.getNestedParent(s,e),h=n.topOverlay?n.topOverlay.clone.wtTable.getColumnHeader(c,s):void 0,f=n.topLeftCornerOverlay?n.topLeftCornerOverlay.clone.wtTable.getColumnHeader(c,s):void 0,d=[h,f],p=t.getColspan(s-t.columnHeaderLevelCount,c),v=c>=r&&c+p-1<=i;Object(l.arrayEach)(d,function(t,e,n){if(void 0===t)return!1;!o&&s<u||o&&!v?Object(a.hasClass)(t,"ht__highlight")&&Object(a.removeClass)(t,"ht__highlight"):Object(a.hasClass)(t,"ht__highlight")||Object(a.addClass)(t,"ht__highlight")})}(s)})}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this,n=t.startColumn;Object(s.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),function(o){var r=e.getNestedParent(o,t.startColumn);if(r<t.startColumn){var i=Math.min(n,r);n=i}}),t.startColumn=n}},{key:"onAfterOnCellMouseDown",value:function(t,e,n){if(e.row<0){var o=this.getColspan(e.row,e.col),r=e.col+o-1;if(o>1){var i=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new f.a(i,r))}}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,o){if(e.row<0&&e.col>=0&&this.hot.view.isMouseDown()){var r=this.hot.getSelectedRangeLast(),i=r.from,a=r.to,s=this.getColspan(e.row,e.col),l=e.col+s-1,u=!1;if(i.col<=a.col?(e.col<i.col&&l===a.col||e.col<i.col&&l<i.col||e.col<i.col&&l>=i.col&&l<a.col)&&(u=!0):(e.col<a.col&&l>i.col||e.col>i.col||e.col<=a.col&&l>i.col||e.col>a.col&&l>i.col)&&(u=!0),u){var c=[a.col,i.col];i.col=c[0],a.col=c[1]}s>1&&(o.column=!0,o.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),i.col===a.col&&(l<=i.col&&e.col<i.col?(this.hot.selection.setRangeStartOnly(new f.a(i.row,a.col)),this.hot.selection.setRangeEnd(new f.a(a.row,e.col))):(this.hot.selection.setRangeStartOnly(new f.a(i.row,e.col<i.col?e.col:i.col)),this.hot.selection.setRangeEnd(new f.a(a.row,l>a.col?l:a.col)))),i.col<a.col&&(this.hot.selection.setRangeStartOnly(new f.a(i.row,e.col<i.col?e.col:i.col)),this.hot.selection.setRangeEnd(new f.a(a.row,l))),i.col>a.col&&(this.hot.selection.setRangeStartOnly(new f.a(i.row,i.col)),this.hot.selection.setRangeEnd(new f.a(a.row,e.col))))}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){if(t){t.length=0;for(var e=this.colspanArray.length,n=e-1;n>=0;n--)t.push(this.headerRendererFactory(n));t.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.widthsCache[e];return t>n?t:n}},{key:"destroy",value:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(h.a);Object(c.d)("nestedHeaders",y)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e){o(this,t),this.nestedHeaders=e,this.container=void 0,this.widthsCache=[]}return a(t,[{key:"buildWidthsMapper",value:function(){this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length,n=0;n<e;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(t){for(var e=document,n=e.createDocumentFragment(),o=e.createElement("table"),a=!1,s=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.colspanArray.length,u=this.nestedHeaders.hot.countCols(),c=l-1,h=0;h<l;h++){var f=e.createElement("tr");a=!1;for(var d=0;d<u;d++){var p=e.createElement("th"),v=Object(i.clone)(this.nestedHeaders.colspanArray[h][d]);v&&!v.hidden&&(h===c&&(v.colspan>1&&(a=!0),s&&(v.label+='<button class="changeType"></button>')),Object(r.fastInnerHTML)(p,v.label),p.colSpan=v.colspan,f.appendChild(p))}o.appendChild(f)}if(a){for(var g=e.createElement("tr"),y=0;y<u;y++)g.appendChild(e.createElement("th"));o.appendChild(g)}n.appendChild(o),t.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),t}()},function(t,e){},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(7),l=n(6),u=n(4),c=n(0),h=n(9),f=n(443),d=n(444),p=n(242),v=n(445),g=n(446),y=(n.n(g),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}()),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},b=new WeakMap,w=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.sourceData=null,n.trimRowsPlugin=null,n.bindRowsWithHeadersPlugin=null,n.dataManager=null,n.headersUI=null,b.set(n,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),n}return a(e,t),y(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var t=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new f.a(this,this.hot,this.sourceData),this.collapsingUI=new d.a(this,this.hot,this.trimRowsPlugin),this.headersUI=new p.a(this,this.hot),this.contextMenuUI=new v.a(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeRender",function(){return t.onBeforeRender.apply(t,arguments)}),this.addHook("modifyRowData",function(){return t.onModifyRowData.apply(t,arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength.apply(t,arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice.apply(t,arguments)}),this.addHook("beforeDataFilter",function(){return t.onBeforeDataFilter.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)}),this.addHook("afterGetRowHeader",function(){return t.onAfterGetRowHeader.apply(t,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("modifyRemovedAmount",function(){return t.onModifyRemovedAmount.apply(t,arguments)}),this.addHook("beforeAddChild",function(){return t.onBeforeAddChild.apply(t,arguments)}),this.addHook("afterAddChild",function(){return t.onAfterAddChild.apply(t,arguments)}),this.addHook("beforeDetachChild",function(){return t.onBeforeDetachChild.apply(t,arguments)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild.apply(t,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return t.onModifyRowHeaderWidth.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)}),this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e){var n=b.get(this),o=t.length,r=[],i=this.dataManager.translateTrimmedRow(e),a=!0,s=void 0,l=null,u=null,c=null;for(s=0;s<o;s++)r.push(this.dataManager.translateTrimmedRow(t[s])),this.dataManager.isParent(r[s])&&(a=!1);if(r.indexOf(i)>-1||!a)return!1;if(l=this.dataManager.getRowParent(r[0]),u=this.dataManager.getRowParent(i),null==u&&(u=this.dataManager.getRowParent(i-1)),null==u&&(u=this.dataManager.getDataObject(i-1),n.movedToFirstChild=!0),!u)return!1;for(c=l===u,n.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),c||(Math.max.apply(Math,r)<=i?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(i,t.length)),n.changeSelection=!0,(r[o-1]<=i&&c||!0===n.movedToFirstChild)&&(t.reverse(),r.reverse(),!0!==n.movedToFirstChild&&i--),s=0;s<o;s++)this.dataManager.moveRow(r[s],i);if(r[r.length-1]<i)for(s=o-1;s>=0;s--)this.dataManager.moveCellMeta(r[s],i);else for(s=0;s<o;s++)this.dataManager.moveCellMeta(r[s],i);return(r[o-1]<=i&&c||this.dataManager.isParent(i))&&t.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(t,e){var n=b.get(this);if(n.changeSelection){var r=t.length,i=0,a=0,s=null,l=null,u=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),s=this.dataManager.translateTrimmedRow(e),n.movedToFirstChild)n.movedToFirstChild=!1,i=e,a=e+r-1,e>=Math.max.apply(Math,o(t))&&(i-=r,a-=r);else if(n.movedToCollapsed){var c=this.dataManager.getRowParent(s-1);null==c&&(c=this.dataManager.getDataObject(s-1));var f=this.dataManager.getRowIndex(c);i=f,a=i}else t[r-1]<e?(a=e-1,i=a-r+1):(i=e,a=i+r-1);l=this.hot.selection,u=this.hot.countCols()-1,l.setRangeStart(new h.a(i,0)),l.setRangeEnd(new h.a(a,u),!0),n.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){return this.dataManager.spliceData(t,e,n),!1}},{key:"onBeforeDataFilter",value:function(t,e,n){var o=[],r=this.dataManager.translateTrimmedRow(t),i=b.get(this);return Object(u.rangeEach)(r,r+e-1,function(t){o.push(t)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r,e),this.collapsingUI.collapsedRowsStash.shiftStash(r,-1*e),this.dataManager.filterData(t,e,o),i.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,o){var r=this;if(o!==this.pluginName){var i=b.get(this);setTimeout(function(){i.skipRender=null,r.headersUI.updateRowHeaderWidth(),r.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onModifyRemovedAmount",value:function(t,e){var n=this,o=[],r=0;return Object(u.rangeEach)(e,e+t-1,function(t){var e=!1,i=n.collapsingUI.translateTrimmedRow(t),a=n.dataManager.getDataObject(i);n.dataManager.hasChildren(a)&&(o.push(a),Object(c.arrayEach)(o,function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1}),e||(r+=n.dataManager.countChildren(a))),e=!1,Object(c.arrayEach)(o,function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1}),e&&r--}),t+r}},{key:"onBeforeAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(t,e,n){n!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var t=Math.max.apply(Math,o(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeRender",value:function(t,e){b.get(this).skipRender&&(e.skipRender=!0)}}]),e}(s.a);Object(l.d)("nestedRows",w)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(4),i=n(1),a=n(0),s=n(53),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(){function t(e,n,r){o(this,t),this.hot=n,this.data=r,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=Object(s.a)(this.hot)}return u(t,[{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(r.rangeEach)(0,this.data.length-1,function(e){t.cacheNode(t.data[e],0,null)})}},{key:"cacheNode",value:function(t,e,n){var o=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount++),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Object(a.arrayEach)(t.__children,function(n,r){o.cacheNode(n,e+1,t)})}},{key:"getDataObject",value:function(t){return null==t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,o){var r=this,i=!1;return isNaN(e)&&e.end?e:(t||(t={__children:this.data},i=!0,e--),null!=n&&e===n?{result:t,end:!0}:null!=o&&t===o?{result:e,end:!0}:(e++,t.__children&&Object(a.arrayEach)(t.__children,function(a,s){if(r.parentReference.set(a,i?null:t),e=r.readTreeNodes(a,e,n,o),isNaN(e)&&e.end)return!1}),e))}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return Object(i.objectEach)(this.data[0],function(e,n){t[n]=null}),t}},{key:"getRowIndex",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){return this.countChildren({__children:this.data})}},{key:"countChildren",value:function(t){var e=this,n=0;return isNaN(t)||(t=this.getDataObject(t)),t&&t.__children?(Object(a.arrayEach)(t.__children,function(t,o){n++,t.__children&&(n+=e.countChildren(t))}),n):0}},{key:"getRowParent",value:function(t){var e=void 0;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return"object"!==(void 0===t?"undefined":l(t))?null:this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function(t){var e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isParent",value:function(t){return isNaN(t)||(t=this.getDataObject(t)),!!Object(i.hasOwnProperty)(t,"__children")}},{key:"addChild",value:function(t,e){this.hot.runHooks("beforeAddChild",t,e);var n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),e||(e=this.mockNode()),o.__children.push(e),this.rewriteCache(),this.hot.runHooks("afterCreateRow",this.getRowIndex(e),1),this.hot.runHooks("afterAddChild",t,e)}},{key:"addChildAtIndex",value:function(t,e,n,o){this.hot.runHooks("beforeAddChild",t,n,e),this.hot.runHooks("beforeCreateRow",o+1,1);var r=t;t||(r=this.mockParent()),r.__children||(r.__children=[]),n||(n=this.mockNode()),r.__children.splice(e,null,n),this.rewriteCache(),this.hot.runHooks("afterCreateRow",o+1,1),this.hot.runHooks("afterAddChild",t,n,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),o=this.getRowParent(n),r=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(o,r+1,null,t);break;case"above":this.addChildAtIndex(o,r,null,t)}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null,i=[];Array.isArray(t)?(Object(r.rangeEach)(t[0],t[2],function(t){var n=e.translateTrimmedRow(t);i.push(e.getDataObject(n))}),Object(r.rangeEach)(0,i.length-2,function(t){e.detachFromParent(i[t],!1)}),o=i[i.length-1]):o=t;var a=this.getRowIndex(o),s=this.getRowIndexWithinParent(o),l=this.getRowParent(o),u=this.getRowParent(l),c=this.getRowIndex(u),h=null;this.hot.runHooks("beforeDetachChild",l,o),null!=s&&(this.hot.runHooks("beforeRemoveRow",a,1,[a],this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,1,[a],this.plugin.pluginName),u?(h=c+this.countChildren(u),this.hot.runHooks("beforeCreateRow",h,1,this.plugin.pluginName),u.__children.push(o)):(h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h,1,this.plugin.pluginName),this.data.push(o))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",h,1,this.plugin.pluginName),n&&this.hot.render(),this.hot.runHooks("afterDetachChild",l,o)}},{key:"filterData",value:function(t,e,n){var o=this,r=[];Object(a.arrayEach)(n,function(t,e){r.push(o.getDataObject(t))}),Object(a.arrayEach)(r,function(t,e){var n=o.getRowIndexWithinParent(t),r=o.getRowParent(t);null===r?o.data.splice(n,1):r.__children.splice(n,1)}),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){if(null!=(t=this.translateTrimmedRow(t))){var o=this.getDataObject(t-1),r=null,i=null;o&&o.__children&&0===o.__children.length?(r=o,i=0):(r=this.getRowParent(t),i=this.getRowIndexWithinParent(t)),r?n?r.__children.splice(i,e,n):r.__children.splice(i,e):n?this.data.splice(i,e,n):this.data.splice(i,e),this.rewriteCache()}}},{key:"moveRow",value:function(t,e){var n=this.isParent(e),o=this.getRowParent(t),r=this.getRowIndexWithinParent(t),i=this.getRowParent(e);null==i&&(i=this.getRowParent(e-1)),null==i&&(i=this.getDataObject(e-1)),i?i.__children||(i.__children=[]):(i=this.getDataObject(e),i.__children=[]);var a=this.getRowParent(e-1),s=n?this.countChildren(a):this.getRowIndexWithinParent(e),l=o.__children.slice(r,r+1);o.__children.splice(r,1),i.__children.splice(s,0,l[0])}},{key:"moveCellMeta",value:function(t,e){this.hot.spliceCellsMeta(e,0,this.hot.getCellMetaAtRow(t)),this.hot.spliceCellsMeta(t+(t<e?0:1),1)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(11),s=n(0),l=n(4),u=n(2),c=n(160),h=n(242),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.trimRowsPlugin=t.trimRowsPlugin,i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,!1)},shiftStash:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=i.translateTrimmedRow(t),Object(s.arrayEach)(i.lastCollapsedRows,function(n,o){n>t-1&&(i.lastCollapsedRows[o]=n+e)})},applyStash:function(){i.hot.runHooks("skipLengthCache",100),i.collapseMultipleChildren(i.lastCollapsedRows,!0),i.lastCollapsedRows=void 0},trimStash:function(t,e){Object(l.rangeEach)(t,t+e-1,function(t){var e=i.lastCollapsedRows.indexOf(t);e>-1&&i.lastCollapsedRows.splice(e,1)})}},i}return i(e,t),f(e,[{key:"collapseChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),a=t),this.dataManager.hasChildren(i)&&Object(s.arrayEach)(i.__children,function(t,n){r.push(e.dataManager.getRowIndex(t))}),l=this.collapseRows(r,!0,!1),o&&this.trimRowsPlugin.trimRows(l),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),l}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];Object(s.arrayEach)(t,function(t,n){r=r.concat(e.collapseChildren(t,!1,!1))}),o&&this.trimRowsPlugin.trimRows(r),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){this.collapseRows([t],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return Object(s.arrayEach)(t,function(t,o){r.push(t),n&&e.collapseChildRows(t,r)}),o&&this.trimRowsPlugin.trimRows(r),r}},{key:"collapseChildRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var r=this.dataManager.getDataObject(t);Object(s.arrayEach)(r.__children,function(t,o){var r=n.dataManager.getRowIndex(t);e.push(r),n.collapseChildRows(r,e)})}o&&this.trimRowsPlugin.trimRows(e)}},{key:"expandRow",value:function(t){this.expandRows([t],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return Object(s.arrayEach)(t,function(t,o){r.push(t),n&&e.expandChildRows(t,r)}),o&&this.trimRowsPlugin.untrimRows(r),r}},{key:"expandChildRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var r=this.dataManager.getDataObject(t);Object(s.arrayEach)(r.__children,function(t,o){if(!n.isAnyParentCollapsed(t)){var r=n.dataManager.getRowIndex(t);e.push(r),n.expandChildRows(r,e)}})}o&&this.trimRowsPlugin.untrimRows(e)}},{key:"expandChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),a=t),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&Object(s.arrayEach)(i.__children,function(t,n){var o=e.dataManager.getRowIndex(t);r.push(o)}),l=this.expandRows(r,!0,!1),o&&this.trimRowsPlugin.untrimRows(l),n&&this.renderAndAdjust(),l}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];Object(s.arrayEach)(t,function(t,n){r=r.concat(e.expandChildren(t,!1,!1))}),o&&this.trimRowsPlugin.untrimRows(r),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(s.arrayEach)(e,function(e,o){t.dataManager.hasChildren(e)&&n.push(e)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(s.arrayEach)(e,function(e,o){t.dataManager.hasChildren(e)&&n.push(e)}),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=null,o=!0;return n=isNaN(t)?t:this.dataManager.getDataObject(t),this.dataManager.hasChildren(n)&&Object(s.arrayEach)(n.__children,function(t,n){var r=e.dataManager.getRowIndex(t);if(!e.trimRowsPlugin.isTrimmed(r))return o=!1,!1}),o}},{key:"isAnyParentCollapsed",value:function(t){for(var e=t;null!==e;)if(e=this.dataManager.getRowParent(e),this.collapsedRows.indexOf(this.dataManager.getRowIndex(e))>-1)return!0;return!1}},{key:"toggleState",value:function(t,e,n){if(!(e.col>=0)){var o=this.translateTrimmedRow(e.row);Object(u.hasClass)(t.target,h.a.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),Object(a.stopImmediatePropagation)(t))}}},{key:"translateTrimmedRow",value:function(t){return this.trimRowsPlugin.rowsMapper.getValueByIndex(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),e}(c.a)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(4),s=n(0),l=n(3),u=n(160),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),h=new WeakMap;e.a=function(t){function e(t,n){o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return h.set(i,{row_above:function(t,e){i.dataManager.addSibling(e.start.row,"above")},row_below:function(t,e){i.dataManager.addSibling(e.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return i(e,t),c(e,[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.selectedHeader.cols||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]);e.dataManager.getDataObject(t),e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]);return!e.dataManager.getRowParent(n)||!t||t[0]<0||e.hot.selection.selectedHeader.cols||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Object(a.rangeEach)(0,t.items.length-1,function(e){if(0===e)return Object(s.arrayEach)(n,function(n,o){t.items.splice(e+o,0,n)}),!1}),t=this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=h.get(this);return Object(a.rangeEach)(0,t.items.length-1,function(n){null!=e[t.items[n].key]&&(t.items[n].callback=e[t.items[n].key])}),t}}]),e}(u.a)},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){e.textContent=""}var s=n(7),l=n(2),u=n(4),c=n(0),h=n(6),f=n(43),d=n(448),p=n(449),v=n(450),g=(n.n(v),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),m=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},b=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings={},n.hiddenColumns=[],n.lastSelectedColumn=-1,n}return i(e,t),y(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)}):this.addHook("afterRenderer",function(e,n,o){return t.onAfterGetColHeader(o,e)}),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterGetCellMeta",function(e,n,o){return t.onAfterGetCellMeta(e,n,o)}),this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.addHook("beforeSetRangeStartOnly",function(e){return t.onBeforeSetRangeStart(e)}),this.addHook("beforeSetRangeEnd",function(e){return t.onBeforeSetRangeEnd(e)}),this.addHook("hiddenColumn",function(e){return t.isHidden(e)}),this.addHook("beforeStretchingColumnWidth",function(e,n){return t.onBeforeStretchingColumnWidth(e,n)}),this.addHook("afterCreateCol",function(e,n){return t.onAfterCreateCol(e,n)}),this.addHook("afterRemoveCol",function(e,n){return t.onAfterRemoveCol(e,n)}),this.hot.view&&this.onAfterPluginsInitialized(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this;Object(c.arrayEach)(t,function(t){t=parseInt(t,10),t=e.getLogicalColumnIndex(t),e.isHidden(t,!0)&&e.hiddenColumns.splice(e.hiddenColumns.indexOf(t),1)})}},{key:"showColumn",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this;Object(c.arrayEach)(t,function(t){t=parseInt(t,10),t=e.getLogicalColumnIndex(t),e.isHidden(t,!0)||e.hiddenColumns.push(t)})}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"isHidden",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(t=this.getLogicalColumnIndex(t)),this.hiddenColumns.indexOf(t)>-1}},{key:"resetCellsMeta",value:function(){Object(c.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipColumnOnPaste=!1,null!==t.baseRenderer&&(t.renderer=t.baseRenderer,t.baseRenderer=null))})}},{key:"getLogicalColumnIndex",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){return this.isHidden(e)&&(t=0),t}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?.1:this.settings.indicators&&(this.isHidden(e+1)||this.isHidden(e-1))?t+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(e=this.hot.runHooks("unmodifyCol",e),!1===this.settings.copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e)?(n.renderer!==a&&(n.baseRenderer=n.renderer),n.renderer=a):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var o=!0,r=n.visualCol-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(r)){o=!1;break}r--}while(r>=0);o&&-1===n.className.indexOf("firstVisibleColumn")&&(n.className+=" firstVisibleColumn")}else if(n.className){var i=n.className.split(" ");if(i.length){var s=i.indexOf("afterHiddenColumn"),l=i.indexOf("firstVisibleColumn");s>-1&&i.splice(s,1),l>-1&&i.splice(l,1),n.className=i.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],o=function(t,e,o,r){n.push({startRow:t,endRow:e,startCol:o,endCol:r})};return Object(c.arrayEach)(t,function(t){var n=!0,r=0;Object(u.rangeEach)(t.startCol,t.endCol,function(i){e.isHidden(i)?(n||o(t.startRow,t.endRow,r,i-1),n=!0):(n&&(r=i),i===t.endCol&&o(t.startRow,t.endRow,r,i),n=!1)})}),n}},{key:"onAfterGetColHeader",value:function(t,e){if(!this.isHidden(t)){var n=!0,o=t-1;do{if(!this.isHidden(o)){n=!1;break}o--}while(o>=0);n&&Object(l.addClass)(e,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(t-1)&&Object(l.addClass)(e,"afterHiddenColumn"),this.isHidden(t+1)&&t>-1&&Object(l.addClass)(e,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(t){var e=this;t.col>0||(t.col=0,t.col=function t(n){var o=e.getLogicalColumnIndex(n);return e.isHidden(o,!0)&&(n=t(++n)),n}(t.col))}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countCols();t.col=function o(r){var i=e.getLogicalColumnIndex(r);return e.isHidden(i,!0)&&(e.lastSelectedColumn>r||t.col===n-1?r>0?r=o(--r):Object(u.rangeEach)(0,e.lastSelectedColumn,function(t){if(!e.isHidden(t))return r=t,!1}):r=o(++r)),r}(t.col),this.lastSelectedColumn=t.col}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:f.l},Object(d.a)(this),Object(p.a)(this))}},{key:"onAfterCreateCol",value:function(t,e){var n=[];Object(c.arrayEach)(this.hiddenColumns,function(o){o>=t&&(o+=e),n.push(o)}),this.hiddenColumns=n}},{key:"onAfterRemoveCol",value:function(t,e){var n=[];Object(c.arrayEach)(this.hiddenColumns,function(o){o>=t&&(o-=e),n.push(o)}),this.hiddenColumns=n}},{key:"onAfterPluginsInitialized",value:function(){var t=this,e=this.hot.getSettings().hiddenColumns;"object"===(void 0===e?"undefined":g(e))&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.columns)&&this.hideColumns(e.columns),e.copyPasteEnabled||this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)}))}},{key:"destroy",value:function(){m(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(s.a);Object(h.d)("hiddenColumns",b)},function(t,e,n){"use strict";function o(t){return{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=a(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback:function(){var e=this.getSelectedRangeLast(),n=e.from,o=e.to,i=Math.min(n.col,o.col),a=Math.max(n.col,o.col);Object(r.rangeEach)(i,a,function(e){return t.hideColumn(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}e.a=o;var r=n(4),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){"use strict";function o(t){var e=[],n=[];return{key:"hidden_columns_show",name:function(){var o=this.getSelectedLast(),s=0;if(Array.isArray(o)){var l=a(o,4),u=l[1],c=l[3];if(u>c){var h=[c,u];u=h[0],c=h[1]}var f=0;u===c?f=e.length+n.length:Object(r.rangeEach)(u,c,function(e){t.isHidden(e)&&(f+=1)}),s=f<=1?0:1}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_SHOW_COLUMN,s)},callback:function(){var o=this.getSelectedRangeLast(),i=o.from,a=o.to,s=Math.min(i.col,a.col),l=Math.max(i.col,a.col);s===l?(e.length===s&&(t.showColumns(e),e.length=0),n.length===this.countSourceCols()-(s+1)&&(t.showColumns(n),n.length=0)):Object(r.rangeEach)(s,l,function(e){return t.showColumn(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;e.length=0,n.length=0;var o=this.getSelectedRangeLast(),i=o.from,a=o.to,s=Math.min(i.col,a.col),l=Math.max(i.col,a.col),u=!1;if(s===l){var c=this.countSourceCols();Object(r.rangeEach)(0,c,function(o){if(e.length+n.length===t.hiddenColumns.length)return!1;o<s&&t.isHidden(o)?e.push(o):t.isHidden(o)&&n.push(o)}),c-=1,(e.length===s&&s>0||n.length===c-s&&s<c)&&(u=!0)}else Object(r.rangeEach)(s,l,function(e){if(t.isHidden(e))return u=!0,!1});return!u}}}e.a=o;var r=n(4),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(2),l=n(4),u=n(0),c=n(6),h=n(452),f=n(453),d=n(454),p=(n.n(d),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),v=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),g=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},y=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.settings={},n.hiddenRows=[],n.lastSelectedRow=-1,n}return i(e,t),v(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(e,n){return t.onAfterGetRowHeader(e,n)}):this.addHook("afterRenderer",function(e,n){return t.onAfterGetRowHeader(n,e)}),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterGetCellMeta",function(e,n,o){return t.onAfterGetCellMeta(e,n,o)}),this.addHook("modifyRowHeight",function(e,n){return t.onModifyRowHeight(e,n)}),this.addHook("beforeSetRangeStartOnly",function(e){return t.onBeforeSetRangeStartOnly(e)}),this.addHook("beforeSetRangeStart",function(e){return t.onBeforeSetRangeStart(e)}),this.addHook("beforeSetRangeEnd",function(e){return t.onBeforeSetRangeEnd(e)}),this.addHook("hiddenRow",function(e){return t.isHidden(e)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterRemoveRow",function(e,n){return t.onAfterRemoveRow(e,n)}),this.hot.view&&this.onAfterPluginsInitialized(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this;Object(u.arrayEach)(t,function(t){t=parseInt(t,10),t=e.getLogicalRowIndex(t),e.isHidden(t,!0)&&e.hiddenRows.splice(e.hiddenRows.indexOf(t),1)})}},{key:"showRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this;Object(u.arrayEach)(t,function(t){t=parseInt(t,10),t=e.getLogicalRowIndex(t),e.isHidden(t,!0)||e.hiddenRows.push(t)})}},{key:"hideRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"isHidden",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(t=this.getLogicalRowIndex(t)),this.hiddenRows.indexOf(t)>-1}},{key:"resetCellsMeta",value:function(){Object(u.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipRowOnPaste=!1)})}},{key:"getLogicalRowIndex",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(t=this.hot.runHooks("unmodifyRow",t),n.skipRowOnPaste=!(!1!==this.settings.copyPasteEnabled||!this.isHidden(t)),this.isHidden(t-1)){var o=!0,r=t-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(r)){o=!1;break}r--}while(r>=0);o&&-1===n.className.indexOf("firstVisibleRow")&&(n.className+=" firstVisibleRow")}else if(n.className){var i=n.className.split(" ");if(i.length){var a=i.indexOf("afterHiddenRow"),s=i.indexOf("firstVisibleRow");a>-1&&i.splice(a,1),s>-1&&i.splice(s,1),n.className=i.join(" ")}}}},{key:"onAfterGetRowHeader",value:function(t,e){var n=e.parentNode;n&&(this.isHidden(t)?Object(s.addClass)(n,"hide"):Object(s.removeClass)(n,"hide"));var o=!0,r=t-1;do{if(!this.isHidden(r)){o=!1;break}r--}while(r>=0);o&&Object(s.addClass)(e,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(t-1)&&Object(s.addClass)(e,"afterHiddenRow"),this.isHidden(t+1)&&Object(s.addClass)(e,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?.1:t}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],o=function(t,e,o,r){n.push({startRow:t,endRow:e,startCol:o,endCol:r})};return Object(u.arrayEach)(t,function(t){var n=!0,r=0;Object(l.rangeEach)(t.startRow,t.endRow,function(i){e.isHidden(i)?(n||o(r,i-1,t.startCol,t.endCol),n=!0):(n&&(r=i),i===t.endRow&&o(r,i,t.startCol,t.endCol),n=!1)})}),n}},{key:"onBeforeSetRangeStart",value:function(t){var e=this,n=this.hot.getSelectedLast()||!1,o=this.hot.countRows()-1;t.row=function t(r){var i=0;return n&&(i=r>n[0]?1:-1,e.lastSelectedRow=n[0]),o<r||r<0?e.lastSelectedRow:(e.isHidden(r)&&(r=t(r+i)),r)}(t.row)}},{key:"onBeforeSetRangeStartOnly",value:function(t){var e=this;t.row>0||(t.row=0,t.row=function t(n){return e.isHidden(n)&&(n=t(++n)),n}(t.row))}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countRows();t.row=function o(r){return e.isHidden(r)&&(e.lastSelectedRow>r||t.row===n-1?r>0?r=o(--r):Object(l.rangeEach)(0,e.lastSelectedRow,function(t){if(!e.isHidden(t))return r=t,!1}):r=o(++r)),r}(t.row),this.lastSelectedRow=t.row}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},Object(h.a)(this),Object(f.a)(this))}},{key:"onAfterCreateRow",value:function(t,e){var n=[];Object(u.arrayEach)(this.hiddenRows,function(o){o>=t&&(o+=e),n.push(o)}),this.hiddenRows=n}},{key:"onAfterRemoveRow",value:function(t,e){var n=[];Object(u.arrayEach)(this.hiddenRows,function(o){o>=t&&(o-=e),n.push(o)}),this.hiddenRows=n}},{key:"onAfterPluginsInitialized",value:function(){var t=this,e=this.hot.getSettings().hiddenRows;"object"===(void 0===e?"undefined":p(e))&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.rows)&&this.hideRows(e.rows),e.copyPasteEnabled||this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)}))}},{key:"destroy",value:function(){g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(c.d)("hiddenRows",y)},function(t,e,n){"use strict";function o(t){return{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=a(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback:function(){var e=this.getSelectedRangeLast(),n=e.from,o=e.to,i=Math.min(n.row,o.row),a=Math.max(n.row,o.row);Object(r.rangeEach)(i,a,function(e){return t.hideRow(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}e.a=o;var r=n(4),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){"use strict";function o(t){var e=[],n=[];return{key:"hidden_rows_show",name:function(){var o=this.getSelectedLast(),s=0;if(Array.isArray(o)){var l=a(o,3),u=l[0],c=l[2];if(u>c){var h=[c,u];u=h[0],c=h[1]}var f=0;u===c?f=e.length+n.length:Object(r.rangeEach)(u,c,function(e){t.isHidden(e)&&(f+=1)}),s=f<=1?0:1}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_SHOW_ROW,s)},callback:function(){var o=this.getSelectedRangeLast(),i=o.from,a=o.to,s=Math.min(i.row,a.row),l=Math.max(i.row,a.row);s===l?(e.length===s&&(t.showRows(e),e.length=0),n.length===this.countSourceRows()-(s+1)&&(t.showRows(n),n.length=0)):Object(r.rangeEach)(s,l,function(e){return t.showRow(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;e.length=0,n.length=0;var o=this.getSelectedRangeLast(),i=o.from,a=o.to,s=Math.min(i.row,a.row),l=Math.max(i.row,a.row),u=!1;if(s===l){var c=this.countSourceRows();Object(r.rangeEach)(0,c,function(o){if(e.length+n.length===t.hiddenRows.length)return!1;o<s?t.isHidden(o)&&e.push(o):t.isHidden(o)&&n.push(o)}),c-=1,(e.length===s&&s>0||n.length===c-s&&s<c)&&(u=!0)}else Object(r.rangeEach)(s,l,function(e){if(t.isHidden(e))return u=!0,!1});return!u}}}e.a=o;var r=n(4),i=n(3),a=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e){},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(7),s=n(0),l=n(4),u=n(6),c=n(456),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},d=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.trimmedRows=[],n.removedRows=[],n.rowsMapper=new c.a(n),n}return i(e,t),h(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.trimmedRows=n),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("unmodifyRow",function(e,n){return t.onUnmodifyRow(e,n)}),this.addHook("beforeCreateRow",function(e,n,o){return t.onBeforeCreateRow(e,n,o)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(e,n){return t.onAfterRemoveRow(e,n)}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.disablePlugin(),this.enablePlugin()),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(t){var e=this;Object(s.arrayEach)(t,function(t){t=parseInt(t,10),e.isTrimmed(t)||e.trimmedRows.push(t)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterTrimRow",t)}},{key:"trimRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this;Object(s.arrayEach)(t,function(t){t=parseInt(t,10),e.isTrimmed(t)&&e.trimmedRows.splice(e.trimmedRows.indexOf(t),1)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterUntrimRow",t)}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRows.indexOf(t)>-1}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"onModifyRow",value:function(t,e){return e!==this.pluginName&&(t=this.rowsMapper.getValueByIndex(t)),t}},{key:"onUnmodifyRow",value:function(t,e){return e!==this.pluginName&&(t=this.rowsMapper.getIndexByValue(t)),t}},{key:"onBeforeCreateRow",value:function(t,e,n){return!(this.isEnabled()&&this.trimmedRows.length>0&&"auto"===n)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(l.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(t,e){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(a.a);Object(u.d)("trimRows",d)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(54),i=n(1),a=n(4),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(){function t(e){o(this,t),this.trimRows=e}return s(t,[{key:"createMap",value:function(t){var e=this,n=0,o=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(a.rangeEach)(o-1,function(t){e.trimRows.isTrimmed(t)?n++:e._arrayMap[t-n]=t})}},{key:"destroy",value:function(){this._arrayMap=null}}]),t}();Object(i.mixin)(l,r.a),e.a=l},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(29),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(s.a.CLONE_BOTTOM),n}return i(e,t),l(e,[{key:"repositionOverlay",value:function(){var t=Object(a.getScrollbarWidth)(),e=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(t=0),e.style.top="",e.style.bottom=t+"px"}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0;if(t.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var n=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(n.bottom),r=void 0,i=void 0,s=document.body.offsetHeight;r=this.wot.wtTable.hider.style.left,r=""===r?0:r,i=o>s?o-s:0,e=i,i+="px",t.style.top="",t.style.left=r,t.style.bottom=i}else e=this.getScrollPosition(),Object(a.resetCssTransform)(t),this.repositionOverlay();this.adjustHeaderBordersPosition(e)}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo(Object(a.getWindowScrollLeft)(),t):this.mainTableScrollableElement.scrollTop=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=0,o=this.wot.wtSettings.settings.defaultRowHeight;t<e;){var r=this.wot.wtTable.getRowHeight(t);n+=void 0===r?o:r,t++}return n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientWidth===t.offsetWidth?0:Object(a.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,o=n.style,r=void 0;o.width=this.trimmingContainer===window?"":this.wot.wtViewport.getWorkspaceWidth()-e+"px",this.clone.wtTable.holder.style.width=o.width,r=Object(a.outerHeight)(this.clone.wtTable.TABLE),o.height=r+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=Object(a.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=o.wtTable.holder,i=0;e&&r.offsetHeight!==r.clientHeight&&(i=Object(a.getScrollbarWidth)()),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(a.getScrollTop)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(t){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var e=this.wot.wtTable.holder.parentNode,n=Object(a.hasClass)(e,"innerBorderTop");t?Object(a.addClass)(e,"innerBorderTop"):Object(a.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var o=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");o&&(o.style["border-left-width"]=0)}}}]),e}(s.a);s.a.registerOverlay(s.a.CLONE_BOTTOM,u)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(2),s=n(29),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(s.a.CLONE_BOTTOM_LEFT_CORNER),n}return i(e,t),l(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsBottom")||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"repositionOverlay",value:function(){var t=Object(a.getScrollbarWidth)(),e=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(t=0),e.style.top="",e.style.bottom=t+"px"}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=Object(a.outerHeight)(this.clone.wtTable.TABLE),n=Object(a.outerWidth)(this.clone.wtTable.TABLE);if(t.style.top="",this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(o.bottom),i=Math.ceil(o.left),s=void 0,l=void 0,u=document.body.offsetHeight;s=i<0?-i:0,l=r>u?r-u:0,l+="px",s+="px",t.style.top="",t.style.left=s,t.style.bottom=l}else Object(a.resetCssTransform)(t),this.repositionOverlay();t.style.height=e+"px",t.style.width=n+"px"}}}]),e}(s.a);s.a.registerOverlay(s.a.CLONE_BOTTOM_LEFT_CORNER,u)}]).default});